/*!
 * MIT License
 * 
 * Copyright (c) Peculiar Ventures. All rights reserved.
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 * 
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 * 
 */
var x509=function(e){"use strict";var t,r="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function n(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function i(e){if(e.__esModule)return e;var t=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(e).forEach((function(r){var n=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(t,r,n.get?n:{enumerable:!0,get:function(){return e[r]}})})),t}function o(e){var t={exports:{}};return e(t,t.exports),t.exports
/*! *****************************************************************************
	Copyright (C) Microsoft. All rights reserved.
	Licensed under the Apache License, Version 2.0 (the "License"); you may not use
	this file except in compliance with the License. You may obtain a copy of the
	License at http://www.apache.org/licenses/LICENSE-2.0

	THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
	KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
	WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
	MERCHANTABLITY OR NON-INFRINGEMENT.

	See the Apache Version 2.0 License for specific language governing permissions
	and limitations under the License.
	***************************************************************************** */}function s(e,t){let r=0;if(1===e.length)return e[0];for(let n=e.length-1;n>=0;n--)r+=e[e.length-1-n]*Math.pow(2,t*n);return r}function a(e,t,r=-1){const n=r;let i=e,o=0,s=Math.pow(2,t);for(let r=1;r<8;r++){if(e<s){let e;if(n<0)e=new ArrayBuffer(r),o=r;else{if(n<r)return new ArrayBuffer(0);e=new ArrayBuffer(n),o=n}const s=new Uint8Array(e);for(let e=r-1;e>=0;e--){const r=Math.pow(2,e*t);s[o-e-1]=Math.floor(i/r),i-=s[o-e-1]*r}return e}s*=Math.pow(2,t)}return new ArrayBuffer(0)}!function(e){!function(t){var n="object"==typeof r?r:"object"==typeof self?self:"object"==typeof this?this:Function("return this;")(),i=o(e);function o(e,t){return function(r,n){"function"!=typeof e[r]&&Object.defineProperty(e,r,{configurable:!0,writable:!0,value:n}),t&&t(r,n)}}void 0===n.Reflect?n.Reflect=e:i=o(n.Reflect,i),function(e){var t=Object.prototype.hasOwnProperty,r="function"==typeof Symbol,n=r&&void 0!==Symbol.toPrimitive?Symbol.toPrimitive:"@@toPrimitive",i=r&&void 0!==Symbol.iterator?Symbol.iterator:"@@iterator",o="function"==typeof Object.create,s={__proto__:[]}instanceof Array,a=!o&&!s,c={create:o?function(){return ne(Object.create(null))}:s?function(){return ne({__proto__:null})}:function(){return ne({})},has:a?function(e,r){return t.call(e,r)}:function(e,t){return t in e},get:a?function(e,r){return t.call(e,r)?e[r]:void 0}:function(e,t){return e[t]}},l=Object.getPrototypeOf(Function),u="object"==typeof process&&process.env&&"true"===process.env.REFLECT_METADATA_USE_MAP_POLYFILL,h=u||"function"!=typeof Map||"function"!=typeof Map.prototype.entries?ee():Map,p=u||"function"!=typeof Set||"function"!=typeof Set.prototype.entries?te():Set,f=new(u||"function"!=typeof WeakMap?re():WeakMap);function y(e,t,r,n){if(U(r)){if(!M(e))throw new TypeError;if(!K(t))throw new TypeError;return S(e,t)}if(!M(e))throw new TypeError;if(!D(t))throw new TypeError;if(!D(n)&&!U(n)&&!R(n))throw new TypeError;return R(n)&&(n=void 0),x(e,t,r=z(r),n)}function d(e,t){function r(r,n){if(!D(r))throw new TypeError;if(!U(n)&&!J(n))throw new TypeError;T(e,t,r,n)}return r}function g(e,t,r,n){if(!D(r))throw new TypeError;return U(n)||(n=z(n)),T(e,t,r,n)}function v(e,t,r){if(!D(t))throw new TypeError;return U(r)||(r=z(r)),I(e,t,r)}function m(e,t,r){if(!D(t))throw new TypeError;return U(r)||(r=z(r)),O(e,t,r)}function b(e,t,r){if(!D(t))throw new TypeError;return U(r)||(r=z(r)),N(e,t,r)}function w(e,t,r){if(!D(t))throw new TypeError;return U(r)||(r=z(r)),E(e,t,r)}function B(e,t){if(!D(e))throw new TypeError;return U(t)||(t=z(t)),P(e,t)}function k(e,t){if(!D(e))throw new TypeError;return U(t)||(t=z(t)),j(e,t)}function A(e,t,r){if(!D(t))throw new TypeError;U(r)||(r=z(r));var n=C(t,r,!1);if(U(n))return!1;if(!n.delete(e))return!1;if(n.size>0)return!0;var i=f.get(t);return i.delete(r),i.size>0||f.delete(t),!0}function S(e,t){for(var r=e.length-1;r>=0;--r){var n=(0,e[r])(t);if(!U(n)&&!R(n)){if(!K(n))throw new TypeError;t=n}}return t}function x(e,t,r,n){for(var i=e.length-1;i>=0;--i){var o=(0,e[i])(t,r,n);if(!U(o)&&!R(o)){if(!D(o))throw new TypeError;n=o}}return n}function C(e,t,r){var n=f.get(e);if(U(n)){if(!r)return;n=new h,f.set(e,n)}var i=n.get(t);if(U(i)){if(!r)return;i=new h,n.set(t,i)}return i}function I(e,t,r){if(O(e,t,r))return!0;var n=Q(t);return!R(n)&&I(e,n,r)}function O(e,t,r){var n=C(t,r,!1);return!U(n)&&F(n.has(e))}function N(e,t,r){if(O(e,t,r))return E(e,t,r);var n=Q(t);return R(n)?void 0:N(e,n,r)}function E(e,t,r){var n=C(t,r,!1);if(!U(n))return n.get(e)}function T(e,t,r,n){C(r,n,!0).set(e,t)}function P(e,t){var r=j(e,t),n=Q(e);if(null===n)return r;var i=P(n,t);if(i.length<=0)return r;if(r.length<=0)return i;for(var o=new p,s=[],a=0,c=r;a<c.length;a++){var l=c[a];o.has(l)||(o.add(l),s.push(l))}for(var u=0,h=i;u<h.length;u++){l=h[u];o.has(l)||(o.add(l),s.push(l))}return s}function j(e,t){var r=[],n=C(e,t,!1);if(U(n))return r;for(var i=G(n.keys()),o=0;;){var s=X(i);if(!s)return r.length=o,r;var a=Z(s);try{r[o]=a}catch(e){try{Y(i)}finally{throw e}}o++}}function H(e){if(null===e)return 1;switch(typeof e){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return null===e?1:6;default:return 6}}function U(e){return void 0===e}function R(e){return null===e}function L(e){return"symbol"==typeof e}function D(e){return"object"==typeof e?null!==e:"function"==typeof e}function _(e,t){switch(H(e)){case 0:case 1:case 2:case 3:case 4:case 5:return e}var r=3===t?"string":5===t?"number":"default",i=W(e,n);if(void 0!==i){var o=i.call(e,r);if(D(o))throw new TypeError;return o}return V(e,"default"===r?"number":r)}function V(e,t){if("string"===t){var r=e.toString;if(q(r))if(!D(i=r.call(e)))return i;if(q(n=e.valueOf))if(!D(i=n.call(e)))return i}else{var n;if(q(n=e.valueOf))if(!D(i=n.call(e)))return i;var i,o=e.toString;if(q(o))if(!D(i=o.call(e)))return i}throw new TypeError}function F(e){return!!e}function $(e){return""+e}function z(e){var t=_(e,3);return L(t)?t:$(t)}function M(e){return Array.isArray?Array.isArray(e):e instanceof Object?e instanceof Array:"[object Array]"===Object.prototype.toString.call(e)}function q(e){return"function"==typeof e}function K(e){return"function"==typeof e}function J(e){switch(H(e)){case 3:case 4:return!0;default:return!1}}function W(e,t){var r=e[t];if(null!=r){if(!q(r))throw new TypeError;return r}}function G(e){var t=W(e,i);if(!q(t))throw new TypeError;var r=t.call(e);if(!D(r))throw new TypeError;return r}function Z(e){return e.value}function X(e){var t=e.next();return!t.done&&t}function Y(e){var t=e.return;t&&t.call(e)}function Q(e){var t=Object.getPrototypeOf(e);if("function"!=typeof e||e===l)return t;if(t!==l)return t;var r=e.prototype,n=r&&Object.getPrototypeOf(r);if(null==n||n===Object.prototype)return t;var i=n.constructor;return"function"!=typeof i||i===e?t:i}function ee(){var e={},t=[],r=function(){function e(e,t,r){this._index=0,this._keys=e,this._values=t,this._selector=r}return e.prototype["@@iterator"]=function(){return this},e.prototype[i]=function(){return this},e.prototype.next=function(){var e=this._index;if(e>=0&&e<this._keys.length){var r=this._selector(this._keys[e],this._values[e]);return e+1>=this._keys.length?(this._index=-1,this._keys=t,this._values=t):this._index++,{value:r,done:!1}}return{value:void 0,done:!0}},e.prototype.throw=function(e){throw this._index>=0&&(this._index=-1,this._keys=t,this._values=t),e},e.prototype.return=function(e){return this._index>=0&&(this._index=-1,this._keys=t,this._values=t),{value:e,done:!0}},e}();return function(){function t(){this._keys=[],this._values=[],this._cacheKey=e,this._cacheIndex=-2}return Object.defineProperty(t.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),t.prototype.has=function(e){return this._find(e,!1)>=0},t.prototype.get=function(e){var t=this._find(e,!1);return t>=0?this._values[t]:void 0},t.prototype.set=function(e,t){var r=this._find(e,!0);return this._values[r]=t,this},t.prototype.delete=function(t){var r=this._find(t,!1);if(r>=0){for(var n=this._keys.length,i=r+1;i<n;i++)this._keys[i-1]=this._keys[i],this._values[i-1]=this._values[i];return this._keys.length--,this._values.length--,t===this._cacheKey&&(this._cacheKey=e,this._cacheIndex=-2),!0}return!1},t.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=e,this._cacheIndex=-2},t.prototype.keys=function(){return new r(this._keys,this._values,n)},t.prototype.values=function(){return new r(this._keys,this._values,o)},t.prototype.entries=function(){return new r(this._keys,this._values,s)},t.prototype["@@iterator"]=function(){return this.entries()},t.prototype[i]=function(){return this.entries()},t.prototype._find=function(e,t){return this._cacheKey!==e&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=e)),this._cacheIndex<0&&t&&(this._cacheIndex=this._keys.length,this._keys.push(e),this._values.push(void 0)),this._cacheIndex},t}();function n(e,t){return e}function o(e,t){return t}function s(e,t){return[e,t]}}function te(){return function(){function e(){this._map=new h}return Object.defineProperty(e.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),e.prototype.has=function(e){return this._map.has(e)},e.prototype.add=function(e){return this._map.set(e,e),this},e.prototype.delete=function(e){return this._map.delete(e)},e.prototype.clear=function(){this._map.clear()},e.prototype.keys=function(){return this._map.keys()},e.prototype.values=function(){return this._map.values()},e.prototype.entries=function(){return this._map.entries()},e.prototype["@@iterator"]=function(){return this.keys()},e.prototype[i]=function(){return this.keys()},e}()}function re(){var e=16,r=c.create(),n=i();return function(){function e(){this._key=i()}return e.prototype.has=function(e){var t=o(e,!1);return void 0!==t&&c.has(t,this._key)},e.prototype.get=function(e){var t=o(e,!1);return void 0!==t?c.get(t,this._key):void 0},e.prototype.set=function(e,t){return o(e,!0)[this._key]=t,this},e.prototype.delete=function(e){var t=o(e,!1);return void 0!==t&&delete t[this._key]},e.prototype.clear=function(){this._key=i()},e}();function i(){var e;do{e="@@WeakMap@@"+l()}while(c.has(r,e));return r[e]=!0,e}function o(e,r){if(!t.call(e,n)){if(!r)return;Object.defineProperty(e,n,{value:c.create()})}return e[n]}function s(e,t){for(var r=0;r<t;++r)e[r]=255*Math.random()|0;return e}function a(e){return"function"==typeof Uint8Array?"undefined"!=typeof crypto?crypto.getRandomValues(new Uint8Array(e)):"undefined"!=typeof msCrypto?msCrypto.getRandomValues(new Uint8Array(e)):s(new Uint8Array(e),e):s(new Array(e),e)}function l(){var t=a(e);t[6]=79&t[6]|64,t[8]=191&t[8]|128;for(var r="",n=0;n<e;++n){var i=t[n];4!==n&&6!==n&&8!==n||(r+="-"),i<16&&(r+="0"),r+=i.toString(16).toLowerCase()}return r}}function ne(e){return e.__=void 0,delete e.__,e}e("decorate",y),e("metadata",d),e("defineMetadata",g),e("hasMetadata",v),e("hasOwnMetadata",m),e("getMetadata",b),e("getOwnMetadata",w),e("getMetadataKeys",B),e("getOwnMetadataKeys",k),e("deleteMetadata",A)}(i)}()}(t||(t={}));const c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=";const u=Math.log(2);var h,p,f=i(Object.freeze({__proto__:null,getUTCDate:function(e){return new Date(e.getTime()+6e4*e.getTimezoneOffset())},getParametersValue:function(e,t,r){return e instanceof Object==!1?r:t in e?e[t]:r},bufferToHexCodes:function(e,t=0,r=e.byteLength-t,n=!1){let i="";for(const o of new Uint8Array(e,t,r)){const e=o.toString(16).toUpperCase();1===e.length&&(i+="0"),i+=e,n&&(i+=" ")}return i.trim()},checkBufferParams:function(e,t,r,n){return t instanceof ArrayBuffer==!1?(e.error='Wrong parameter: inputBuffer must be "ArrayBuffer"',!1):0===t.byteLength?(e.error="Wrong parameter: inputBuffer has zero length",!1):r<0?(e.error="Wrong parameter: inputOffset less than zero",!1):n<0?(e.error="Wrong parameter: inputLength less than zero",!1):!(t.byteLength-r-n<0)||(e.error="End of input reached before message was fully decoded (inconsistent offset and length values)",!1)},utilFromBase:s,utilToBase:a,utilConcatBuf:function(...e){let t=0,r=0;for(const r of e)t+=r.byteLength;const n=new ArrayBuffer(t),i=new Uint8Array(n);for(const t of e)i.set(new Uint8Array(t),r),r+=t.byteLength;return n},utilConcatView:function(...e){let t=0,r=0;for(const r of e)t+=r.length;const n=new ArrayBuffer(t),i=new Uint8Array(n);for(const t of e)i.set(t,r),r+=t.length;return i},utilDecodeTC:function(){const e=new Uint8Array(this.valueHex);if(this.valueHex.byteLength>=2){const t=255===e[0]&&128&e[1],r=0===e[0]&&0==(128&e[1]);(t||r)&&this.warnings.push("Needlessly long format")}const t=new ArrayBuffer(this.valueHex.byteLength),r=new Uint8Array(t);for(let e=0;e<this.valueHex.byteLength;e++)r[e]=0;r[0]=128&e[0];const n=s(r,8),i=new ArrayBuffer(this.valueHex.byteLength),o=new Uint8Array(i);for(let t=0;t<this.valueHex.byteLength;t++)o[t]=e[t];return o[0]&=127,s(o,8)-n},utilEncodeTC:function(e){const t=e<0?-1*e:e;let r=128;for(let n=1;n<8;n++){if(t<=r){if(e<0){const e=a(r-t,8,n);return new Uint8Array(e)[0]|=128,e}let i=a(t,8,n),o=new Uint8Array(i);if(128&o[0]){const e=i.slice(0),t=new Uint8Array(e);i=new ArrayBuffer(i.byteLength+1),o=new Uint8Array(i);for(let r=0;r<e.byteLength;r++)o[r+1]=t[r];o[0]=0}return i}r*=Math.pow(2,8)}return new ArrayBuffer(0)},isEqualBuffer:function(e,t){if(e.byteLength!==t.byteLength)return!1;const r=new Uint8Array(e),n=new Uint8Array(t);for(let e=0;e<r.length;e++)if(r[e]!==n[e])return!1;return!0},padNumber:function(e,t){const r=e.toString(10);if(t<r.length)return"";const n=t-r.length,i=new Array(n);for(let e=0;e<n;e++)i[e]="0";return i.join("").concat(r)},toBase64:function(e,t=!1,r=!1,n=!1){let i=0,o=0,s=0,a="";const u=t?l:c;if(n){let t=0;for(let r=0;r<e.length;r++)if(0!==e.charCodeAt(r)){t=r;break}e=e.slice(t)}for(;i<e.length;){const t=e.charCodeAt(i++);i>=e.length&&(o=1);const n=e.charCodeAt(i++);i>=e.length&&(s=1);const c=e.charCodeAt(i++),l=t>>2,h=(3&t)<<4|n>>4;let p=(15&n)<<2|c>>6,f=63&c;1===o?p=f=64:1===s&&(f=64),a+=r?64===p?`${u.charAt(l)}${u.charAt(h)}`:64===f?`${u.charAt(l)}${u.charAt(h)}${u.charAt(p)}`:`${u.charAt(l)}${u.charAt(h)}${u.charAt(p)}${u.charAt(f)}`:`${u.charAt(l)}${u.charAt(h)}${u.charAt(p)}${u.charAt(f)}`}return a},fromBase64:function(e,t=!1,r=!1){const n=t?l:c;function i(e){for(let t=0;t<64;t++)if(n.charAt(t)===e)return t;return 64}function o(e){return 64===e?0:e}let s=0,a="";for(;s<e.length;){const t=i(e.charAt(s++)),r=s>=e.length?0:i(e.charAt(s++)),n=s>=e.length?0:i(e.charAt(s++)),c=s>=e.length?0:i(e.charAt(s++)),l=o(t)<<2|o(r)>>4,u=(15&o(r))<<4|o(n)>>2,h=(3&o(n))<<6|o(c);a+=String.fromCharCode(l),64!==n&&(a+=String.fromCharCode(u)),64!==c&&(a+=String.fromCharCode(h))}if(r){let e=-1;for(let t=a.length-1;t>=0;t--)if(0!==a.charCodeAt(t)){e=t;break}a=-1!==e?a.slice(0,e+1):""}return a},arrayBufferToString:function(e){let t="";const r=new Uint8Array(e);for(const e of r)t+=String.fromCharCode(e);return t},stringToArrayBuffer:function(e){const t=e.length,r=new ArrayBuffer(t),n=new Uint8Array(r);for(let r=0;r<t;r++)n[r]=e.charCodeAt(r);return r},nearestPowerOf2:function(e){const t=Math.log(e)/u,r=Math.floor(t),n=Math.round(t);return r===n?r:n},clearProps:function(e,t){for(const r of t)delete e[r]}})),y=o((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.fromBER=le,t.compareSchema=ue,t.verifySchema=function(e,t){if(t instanceof Object==!1)return{verified:!1,result:{error:"Wrong ASN.1 schema type"}};const r=le(e);if(-1===r.offset)return{verified:!1,result:r.result};return ue(r.result,r.result,t)},t.fromJSON=function(e){},t.RawData=t.Repeated=t.Any=t.Choice=t.TIME=t.Duration=t.DateTime=t.TimeOfDay=t.DATE=t.GeneralizedTime=t.UTCTime=t.CharacterString=t.GeneralString=t.VisibleString=t.GraphicString=t.IA5String=t.VideotexString=t.TeletexString=t.PrintableString=t.NumericString=t.UniversalString=t.BmpString=t.RelativeObjectIdentifier=t.Utf8String=t.ObjectIdentifier=t.Enumerated=t.Integer=t.BitString=t.OctetString=t.Null=t.Set=t.Sequence=t.Boolean=t.EndOfContent=t.Constructed=t.Primitive=t.BaseBlock=t.ValueBlock=t.HexBlock=void 0;const r=[new Uint8Array([1])],n="0123456789";class i{constructor(e={}){this.blockLength=(0,f.getParametersValue)(e,"blockLength",0),this.error=(0,f.getParametersValue)(e,"error",""),this.warnings=(0,f.getParametersValue)(e,"warnings",[]),this.valueBeforeDecode="valueBeforeDecode"in e?e.valueBeforeDecode.slice(0):new ArrayBuffer(0)}static blockName(){return"baseBlock"}toJSON(){return{blockName:this.constructor.blockName(),blockLength:this.blockLength,error:this.error,warnings:this.warnings,valueBeforeDecode:(0,f.bufferToHexCodes)(this.valueBeforeDecode,0,this.valueBeforeDecode.byteLength)}}}const o=e=>class extends e{constructor(e={}){super(e),this.isHexOnly=(0,f.getParametersValue)(e,"isHexOnly",!1),this.valueHex="valueHex"in e?e.valueHex.slice(0):new ArrayBuffer(0)}static blockName(){return"hexBlock"}fromBER(e,t,r){if(!1===(0,f.checkBufferParams)(this,e,t,r))return-1;return 0===new Uint8Array(e,t,r).length?(this.warnings.push("Zero buffer length"),t):(this.valueHex=e.slice(t,t+r),this.blockLength=r,t+r)}toBER(e=!1){return!0!==this.isHexOnly?(this.error='Flag "isHexOnly" is not set, abort',new ArrayBuffer(0)):!0===e?new ArrayBuffer(this.valueHex.byteLength):this.valueHex.slice(0)}toJSON(){let e={};try{e=super.toJSON()}catch(e){}return e.blockName=this.constructor.blockName(),e.isHexOnly=this.isHexOnly,e.valueHex=(0,f.bufferToHexCodes)(this.valueHex,0,this.valueHex.byteLength),e}};t.HexBlock=o;class s extends(o(i)){constructor(e={}){super(),"idBlock"in e?(this.isHexOnly=(0,f.getParametersValue)(e.idBlock,"isHexOnly",!1),this.valueHex=(0,f.getParametersValue)(e.idBlock,"valueHex",new ArrayBuffer(0)),this.tagClass=(0,f.getParametersValue)(e.idBlock,"tagClass",-1),this.tagNumber=(0,f.getParametersValue)(e.idBlock,"tagNumber",-1),this.isConstructed=(0,f.getParametersValue)(e.idBlock,"isConstructed",!1)):(this.tagClass=-1,this.tagNumber=-1,this.isConstructed=!1)}static blockName(){return"identificationBlock"}toBER(e=!1){let t,r,n=0;switch(this.tagClass){case 1:n|=0;break;case 2:n|=64;break;case 3:n|=128;break;case 4:n|=192;break;default:return this.error="Unknown tag class",new ArrayBuffer(0)}if(this.isConstructed&&(n|=32),this.tagNumber<31&&!this.isHexOnly){if(t=new ArrayBuffer(1),r=new Uint8Array(t),!e){let e=this.tagNumber;e&=31,n|=e,r[0]=n}return t}if(!1===this.isHexOnly){const i=(0,f.utilToBase)(this.tagNumber,7),o=new Uint8Array(i),s=i.byteLength;if(t=new ArrayBuffer(s+1),r=new Uint8Array(t),r[0]=31|n,!e){for(let e=0;e<s-1;e++)r[e+1]=128|o[e];r[s]=o[s-1]}return t}if(t=new ArrayBuffer(this.valueHex.byteLength+1),r=new Uint8Array(t),r[0]=31|n,!1===e){const e=new Uint8Array(this.valueHex);for(let t=0;t<e.length-1;t++)r[t+1]=128|e[t];r[this.valueHex.byteLength]=e[e.length-1]}return t}fromBER(e,t,r){if(!1===(0,f.checkBufferParams)(this,e,t,r))return-1;const n=new Uint8Array(e,t,r);if(0===n.length)return this.error="Zero buffer length",-1;switch(192&n[0]){case 0:this.tagClass=1;break;case 64:this.tagClass=2;break;case 128:this.tagClass=3;break;case 192:this.tagClass=4;break;default:return this.error="Unknown tag class",-1}this.isConstructed=32==(32&n[0]),this.isHexOnly=!1;const i=31&n[0];if(31!==i)this.tagNumber=i,this.blockLength=1;else{let e=1;this.valueHex=new ArrayBuffer(255);let t=255,r=new Uint8Array(this.valueHex);for(;128&n[e];){if(r[e-1]=127&n[e],e++,e>=n.length)return this.error="End of input reached before message was fully decoded",-1;if(e===t){t+=255;const e=new ArrayBuffer(t),n=new Uint8Array(e);for(let e=0;e<r.length;e++)n[e]=r[e];this.valueHex=new ArrayBuffer(t),r=new Uint8Array(this.valueHex)}}this.blockLength=e+1,r[e-1]=127&n[e];const i=new ArrayBuffer(e),o=new Uint8Array(i);for(let t=0;t<e;t++)o[t]=r[t];this.valueHex=new ArrayBuffer(e),r=new Uint8Array(this.valueHex),r.set(o),this.blockLength<=9?this.tagNumber=(0,f.utilFromBase)(r,7):(this.isHexOnly=!0,this.warnings.push("Tag too long, represented as hex-coded"))}if(1===this.tagClass&&this.isConstructed)switch(this.tagNumber){case 1:case 2:case 5:case 6:case 9:case 13:case 14:case 23:case 24:case 31:case 32:case 33:case 34:return this.error="Constructed encoding used for primitive type",-1}return t+this.blockLength}toJSON(){let e={};try{e=super.toJSON()}catch(e){}return e.blockName=this.constructor.blockName(),e.tagClass=this.tagClass,e.tagNumber=this.tagNumber,e.isConstructed=this.isConstructed,e}}class a extends i{constructor(e={}){super(),"lenBlock"in e?(this.isIndefiniteForm=(0,f.getParametersValue)(e.lenBlock,"isIndefiniteForm",!1),this.longFormUsed=(0,f.getParametersValue)(e.lenBlock,"longFormUsed",!1),this.length=(0,f.getParametersValue)(e.lenBlock,"length",0)):(this.isIndefiniteForm=!1,this.longFormUsed=!1,this.length=0)}static blockName(){return"lengthBlock"}fromBER(e,t,r){if(!1===(0,f.checkBufferParams)(this,e,t,r))return-1;const n=new Uint8Array(e,t,r);if(0===n.length)return this.error="Zero buffer length",-1;if(255===n[0])return this.error="Length block 0xFF is reserved by standard",-1;if(this.isIndefiniteForm=128===n[0],!0===this.isIndefiniteForm)return this.blockLength=1,t+this.blockLength;if(this.longFormUsed=!!(128&n[0]),!1===this.longFormUsed)return this.length=n[0],this.blockLength=1,t+this.blockLength;const i=127&n[0];if(i>8)return this.error="Too big integer",-1;if(i+1>n.length)return this.error="End of input reached before message was fully decoded",-1;const o=new Uint8Array(i);for(let e=0;e<i;e++)o[e]=n[e+1];return 0===o[i-1]&&this.warnings.push("Needlessly long encoded length"),this.length=(0,f.utilFromBase)(o,8),this.longFormUsed&&this.length<=127&&this.warnings.push("Unneccesary usage of long length form"),this.blockLength=i+1,t+this.blockLength}toBER(e=!1){let t,r;if(this.length>127&&(this.longFormUsed=!0),this.isIndefiniteForm)return t=new ArrayBuffer(1),!1===e&&(r=new Uint8Array(t),r[0]=128),t;if(!0===this.longFormUsed){const n=(0,f.utilToBase)(this.length,8);if(n.byteLength>127)return this.error="Too big length",new ArrayBuffer(0);if(t=new ArrayBuffer(n.byteLength+1),!0===e)return t;const i=new Uint8Array(n);r=new Uint8Array(t),r[0]=128|n.byteLength;for(let e=0;e<n.byteLength;e++)r[e+1]=i[e];return t}return t=new ArrayBuffer(1),!1===e&&(r=new Uint8Array(t),r[0]=this.length),t}toJSON(){let e={};try{e=super.toJSON()}catch(e){}return e.blockName=this.constructor.blockName(),e.isIndefiniteForm=this.isIndefiniteForm,e.longFormUsed=this.longFormUsed,e.length=this.length,e}}class c extends i{constructor(e={}){super(e)}static blockName(){return"valueBlock"}fromBER(e,t,r){throw TypeError('User need to make a specific function in a class which extends "ValueBlock"')}toBER(e=!1){throw TypeError('User need to make a specific function in a class which extends "ValueBlock"')}}t.ValueBlock=c;class l extends i{constructor(e={},t=c){super(e),"name"in e&&(this.name=e.name),"optional"in e&&(this.optional=e.optional),"primitiveSchema"in e&&(this.primitiveSchema=e.primitiveSchema),this.idBlock=new s(e),this.lenBlock=new a(e),this.valueBlock=new t(e)}static blockName(){return"BaseBlock"}fromBER(e,t,r){const n=this.valueBlock.fromBER(e,t,!0===this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return-1===n?(this.error=this.valueBlock.error,n):(0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),0===this.valueBlock.error.length&&(this.blockLength+=this.valueBlock.blockLength),n)}toBER(e=!1){let t;const r=this.idBlock.toBER(e),n=this.valueBlock.toBER(!0);this.lenBlock.length=n.byteLength;const i=this.lenBlock.toBER(e);let o;if(t=(0,f.utilConcatBuf)(r,i),o=!1===e?this.valueBlock.toBER(e):new ArrayBuffer(this.lenBlock.length),t=(0,f.utilConcatBuf)(t,o),!0===this.lenBlock.isIndefiniteForm){const r=new ArrayBuffer(2);if(!1===e){const e=new Uint8Array(r);e[0]=0,e[1]=0}t=(0,f.utilConcatBuf)(t,r)}return t}toJSON(){let e={};try{e=super.toJSON()}catch(e){}return e.idBlock=this.idBlock.toJSON(),e.lenBlock=this.lenBlock.toJSON(),e.valueBlock=this.valueBlock.toJSON(),"name"in this&&(e.name=this.name),"optional"in this&&(e.optional=this.optional),"primitiveSchema"in this&&(e.primitiveSchema=this.primitiveSchema.toJSON()),e}}t.BaseBlock=l;class u extends c{constructor(e={}){super(e),this.valueHex="valueHex"in e?e.valueHex.slice(0):new ArrayBuffer(0),this.isHexOnly=(0,f.getParametersValue)(e,"isHexOnly",!0)}fromBER(e,t,r){if(!1===(0,f.checkBufferParams)(this,e,t,r))return-1;const n=new Uint8Array(e,t,r);if(0===n.length)return this.warnings.push("Zero buffer length"),t;this.valueHex=new ArrayBuffer(n.length);const i=new Uint8Array(this.valueHex);for(let e=0;e<n.length;e++)i[e]=n[e];return this.blockLength=r,t+r}toBER(e=!1){return this.valueHex.slice(0)}static blockName(){return"PrimitiveValueBlock"}toJSON(){let e={};try{e=super.toJSON()}catch(e){}return e.valueHex=(0,f.bufferToHexCodes)(this.valueHex,0,this.valueHex.byteLength),e.isHexOnly=this.isHexOnly,e}}class h extends l{constructor(e={}){super(e,u),this.idBlock.isConstructed=!1}static blockName(){return"PRIMITIVE"}}t.Primitive=h;class p extends c{constructor(e={}){super(e),this.value=(0,f.getParametersValue)(e,"value",[]),this.isIndefiniteForm=(0,f.getParametersValue)(e,"isIndefiniteForm",!1)}fromBER(e,t,r){const n=t,i=r;if(!1===(0,f.checkBufferParams)(this,e,t,r))return-1;if(0===new Uint8Array(e,t,r).length)return this.warnings.push("Zero buffer length"),t;let o=t;for(;s=this.isIndefiniteForm,a=r,(!0===s?1:a)>0;){const t=ce(e,o,r);if(-1===t.offset)return this.error=t.result.error,this.warnings.concat(t.result.warnings),-1;if(o=t.offset,this.blockLength+=t.result.blockLength,r-=t.result.blockLength,this.value.push(t.result),!0===this.isIndefiniteForm&&t.result.constructor.blockName()===g.blockName())break}var s,a;return!0===this.isIndefiniteForm&&(this.value[this.value.length-1].constructor.blockName()===g.blockName()?this.value.pop():this.warnings.push("No EndOfContent block encoded")),this.valueBeforeDecode=e.slice(n,n+i),o}toBER(e=!1){let t=new ArrayBuffer(0);for(let r=0;r<this.value.length;r++){const n=this.value[r].toBER(e);t=(0,f.utilConcatBuf)(t,n)}return t}static blockName(){return"ConstructedValueBlock"}toJSON(){let e={};try{e=super.toJSON()}catch(e){}e.isIndefiniteForm=this.isIndefiniteForm,e.value=[];for(let t=0;t<this.value.length;t++)e.value.push(this.value[t].toJSON());return e}}class y extends l{constructor(e={}){super(e,p),this.idBlock.isConstructed=!0}static blockName(){return"CONSTRUCTED"}fromBER(e,t,r){this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm;const n=this.valueBlock.fromBER(e,t,!0===this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return-1===n?(this.error=this.valueBlock.error,n):(0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),0===this.valueBlock.error.length&&(this.blockLength+=this.valueBlock.blockLength),n)}}t.Constructed=y;class d extends c{constructor(e={}){super(e)}fromBER(e,t,r){return t}toBER(e=!1){return new ArrayBuffer(0)}static blockName(){return"EndOfContentValueBlock"}}class g extends l{constructor(e={}){super(e,d),this.idBlock.tagClass=1,this.idBlock.tagNumber=0}static blockName(){return"EndOfContent"}}t.EndOfContent=g;class v extends c{constructor(e={}){if(super(e),this.value=(0,f.getParametersValue)(e,"value",!1),this.isHexOnly=(0,f.getParametersValue)(e,"isHexOnly",!1),"valueHex"in e)this.valueHex=e.valueHex.slice(0);else if(this.valueHex=new ArrayBuffer(1),!0===this.value){new Uint8Array(this.valueHex)[0]=255}}fromBER(e,t,r){if(!1===(0,f.checkBufferParams)(this,e,t,r))return-1;const n=new Uint8Array(e,t,r);r>1&&this.warnings.push("Boolean value encoded in more then 1 octet"),this.isHexOnly=!0,this.valueHex=new ArrayBuffer(n.length);const i=new Uint8Array(this.valueHex);for(let e=0;e<n.length;e++)i[e]=n[e];return 0!==f.utilDecodeTC.call(this)?this.value=!0:this.value=!1,this.blockLength=r,t+r}toBER(e=!1){return this.valueHex}static blockName(){return"BooleanValueBlock"}toJSON(){let e={};try{e=super.toJSON()}catch(e){}return e.value=this.value,e.isHexOnly=this.isHexOnly,e.valueHex=(0,f.bufferToHexCodes)(this.valueHex,0,this.valueHex.byteLength),e}}class m extends l{constructor(e={}){super(e,v),this.idBlock.tagClass=1,this.idBlock.tagNumber=1}static blockName(){return"Boolean"}}t.Boolean=m;class b extends y{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=16}static blockName(){return"Sequence"}}t.Sequence=b;class w extends y{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=17}static blockName(){return"Set"}}t.Set=w;class B extends l{constructor(e={}){super(e,i),this.idBlock.tagClass=1,this.idBlock.tagNumber=5}static blockName(){return"Null"}fromBER(e,t,r){return this.lenBlock.length>0&&this.warnings.push("Non-zero length of value block for Null type"),0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),this.blockLength+=r,t+r>e.byteLength?(this.error="End of input reached before message was fully decoded (inconsistent offset and length values)",-1):t+r}toBER(e=!1){const t=new ArrayBuffer(2);if(!0===e)return t;const r=new Uint8Array(t);return r[0]=5,r[1]=0,t}}t.Null=B;class k extends(o(p)){constructor(e={}){super(e),this.isConstructed=(0,f.getParametersValue)(e,"isConstructed",!1)}fromBER(e,t,r){let n=0;if(!0===this.isConstructed){if(this.isHexOnly=!1,n=p.prototype.fromBER.call(this,e,t,r),-1===n)return n;for(let e=0;e<this.value.length;e++){const t=this.value[e].constructor.blockName();if(t===g.blockName()){if(!0===this.isIndefiniteForm)break;return this.error="EndOfContent is unexpected, OCTET STRING may consists of OCTET STRINGs only",-1}if(t!==A.blockName())return this.error="OCTET STRING may consists of OCTET STRINGs only",-1}}else this.isHexOnly=!0,n=super.fromBER(e,t,r),this.blockLength=r;return n}toBER(e=!1){if(!0===this.isConstructed)return p.prototype.toBER.call(this,e);let t=new ArrayBuffer(this.valueHex.byteLength);return!0===e||0===this.valueHex.byteLength||(t=this.valueHex.slice(0)),t}static blockName(){return"OctetStringValueBlock"}toJSON(){let e={};try{e=super.toJSON()}catch(e){}return e.isConstructed=this.isConstructed,e.isHexOnly=this.isHexOnly,e.valueHex=(0,f.bufferToHexCodes)(this.valueHex,0,this.valueHex.byteLength),e}}class A extends l{constructor(e={}){super(e,k),this.idBlock.tagClass=1,this.idBlock.tagNumber=4}fromBER(e,t,r){return this.valueBlock.isConstructed=this.idBlock.isConstructed,this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm,0===r?(0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),t):super.fromBER(e,t,r)}static blockName(){return"OctetString"}isEqual(e){return e instanceof A!=!1&&JSON.stringify(this)===JSON.stringify(e)}}t.OctetString=A;class S extends(o(p)){constructor(e={}){super(e),this.unusedBits=(0,f.getParametersValue)(e,"unusedBits",0),this.isConstructed=(0,f.getParametersValue)(e,"isConstructed",!1),this.blockLength=this.valueHex.byteLength}fromBER(e,t,r){if(0===r)return t;let n=-1;if(!0===this.isConstructed){if(n=p.prototype.fromBER.call(this,e,t,r),-1===n)return n;for(let e=0;e<this.value.length;e++){const t=this.value[e].constructor.blockName();if(t===g.blockName()){if(!0===this.isIndefiniteForm)break;return this.error="EndOfContent is unexpected, BIT STRING may consists of BIT STRINGs only",-1}if(t!==x.blockName())return this.error="BIT STRING may consists of BIT STRINGs only",-1;if(this.unusedBits>0&&this.value[e].valueBlock.unusedBits>0)return this.error='Usign of "unused bits" inside constructive BIT STRING allowed for least one only',-1;if(this.unusedBits=this.value[e].valueBlock.unusedBits,this.unusedBits>7)return this.error="Unused bits for BitString must be in range 0-7",-1}return n}if(!1===(0,f.checkBufferParams)(this,e,t,r))return-1;const i=new Uint8Array(e,t,r);if(this.unusedBits=i[0],this.unusedBits>7)return this.error="Unused bits for BitString must be in range 0-7",-1;this.valueHex=new ArrayBuffer(i.length-1);const o=new Uint8Array(this.valueHex);for(let e=0;e<r-1;e++)o[e]=i[e+1];return this.blockLength=i.length,t+r}toBER(e=!1){if(!0===this.isConstructed)return p.prototype.toBER.call(this,e);if(!0===e)return new ArrayBuffer(this.valueHex.byteLength+1);if(0===this.valueHex.byteLength)return new ArrayBuffer(0);const t=new Uint8Array(this.valueHex),r=new ArrayBuffer(this.valueHex.byteLength+1),n=new Uint8Array(r);n[0]=this.unusedBits;for(let e=0;e<this.valueHex.byteLength;e++)n[e+1]=t[e];return r}static blockName(){return"BitStringValueBlock"}toJSON(){let e={};try{e=super.toJSON()}catch(e){}return e.unusedBits=this.unusedBits,e.isConstructed=this.isConstructed,e.isHexOnly=this.isHexOnly,e.valueHex=(0,f.bufferToHexCodes)(this.valueHex,0,this.valueHex.byteLength),e}}class x extends l{constructor(e={}){super(e,S),this.idBlock.tagClass=1,this.idBlock.tagNumber=3}static blockName(){return"BitString"}fromBER(e,t,r){return 0===r?t:(this.valueBlock.isConstructed=this.idBlock.isConstructed,this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm,super.fromBER(e,t,r))}isEqual(e){return e instanceof x!=!1&&JSON.stringify(this)===JSON.stringify(e)}}t.BitString=x;class C extends(o(c)){constructor(e={}){super(e),"value"in e&&(this.valueDec=e.value)}set valueHex(e){this._valueHex=e.slice(0),e.byteLength>=4?(this.warnings.push("Too big Integer for decoding, hex only"),this.isHexOnly=!0,this._valueDec=0):(this.isHexOnly=!1,e.byteLength>0&&(this._valueDec=f.utilDecodeTC.call(this)))}get valueHex(){return this._valueHex}set valueDec(e){this._valueDec=e,this.isHexOnly=!1,this._valueHex=(0,f.utilEncodeTC)(e)}get valueDec(){return this._valueDec}fromDER(e,t,r,n=0){const i=this.fromBER(e,t,r);if(-1===i)return i;const o=new Uint8Array(this._valueHex);if(0===o[0]&&0!=(128&o[1])){const e=new ArrayBuffer(this._valueHex.byteLength-1);new Uint8Array(e).set(new Uint8Array(this._valueHex,1,this._valueHex.byteLength-1)),this._valueHex=e.slice(0)}else if(0!==n&&this._valueHex.byteLength<n){n-this._valueHex.byteLength>1&&(n=this._valueHex.byteLength+1);const e=new ArrayBuffer(n);new Uint8Array(e).set(o,n-this._valueHex.byteLength),this._valueHex=e.slice(0)}return i}toDER(e=!1){const t=new Uint8Array(this._valueHex);switch(!0){case 0!=(128&t[0]):{const e=new ArrayBuffer(this._valueHex.byteLength+1),r=new Uint8Array(e);r[0]=0,r.set(t,1),this._valueHex=e.slice(0)}break;case 0===t[0]&&0==(128&t[1]):{const e=new ArrayBuffer(this._valueHex.byteLength-1);new Uint8Array(e).set(new Uint8Array(this._valueHex,1,this._valueHex.byteLength-1)),this._valueHex=e.slice(0)}}return this.toBER(e)}fromBER(e,t,r){const n=super.fromBER(e,t,r);return-1===n?n:(this.blockLength=r,t+r)}toBER(e=!1){return this.valueHex.slice(0)}static blockName(){return"IntegerValueBlock"}toJSON(){let e={};try{e=super.toJSON()}catch(e){}return e.valueDec=this.valueDec,e}toString(){function e(e,t){const r=new Uint8Array([0]);let n=new Uint8Array(e),i=new Uint8Array(t),o=n.slice(0);const s=o.length-1;let a=i.slice(0);const c=a.length-1;let l=0;let u=0;for(let e=c<s?s:c;e>=0;e--,u++){switch(!0){case u<a.length:l=o[s-u]+a[c-u]+r[0];break;default:l=o[s-u]+r[0]}switch(r[0]=l/10,!0){case u>=o.length:o=(0,f.utilConcatView)(new Uint8Array([l%10]),o);break;default:o[s-u]=l%10}}return r[0]>0&&(o=(0,f.utilConcatView)(r,o)),o.slice(0)}function t(e){if(e>=r.length)for(let t=r.length;t<=e;t++){const e=new Uint8Array([0]);let n=r[t-1].slice(0);for(let t=n.length-1;t>=0;t--){const r=new Uint8Array([(n[t]<<1)+e[0]]);e[0]=r[0]/10,n[t]=r[0]%10}e[0]>0&&(n=(0,f.utilConcatView)(e,n)),r.push(n)}return r[e]}function i(e,t){let r=0,n=new Uint8Array(e),i=new Uint8Array(t),o=n.slice(0);const s=o.length-1;let a=i.slice(0);const c=a.length-1;let l,u=0;for(let e=c;e>=0;e--,u++)switch(l=o[s-u]-a[c-u]-r,!0){case l<0:r=1,o[s-u]=l+10;break;default:r=0,o[s-u]=l}if(r>0)for(let e=s-c+1;e>=0;e--,u++){if(l=o[s-u]-r,!(l<0)){r=0,o[s-u]=l;break}r=1,o[s-u]=l+10}return o.slice()}const o=8*this._valueHex.byteLength-1;let s,a=new Uint8Array(8*this._valueHex.byteLength/3),c=0;const l=new Uint8Array(this._valueHex);let u="",h=!1;for(let r=this._valueHex.byteLength-1;r>=0;r--){s=l[r];for(let r=0;r<8;r++){if(1==(1&s))switch(c){case o:a=i(t(c),a),u="-";break;default:a=e(a,t(c))}c++,s>>=1}}for(let e=0;e<a.length;e++)a[e]&&(h=!0),h&&(u+=n.charAt(a[e]));return!1===h&&(u+=n.charAt(0)),u}}class I extends l{constructor(e={}){super(e,C),this.idBlock.tagClass=1,this.idBlock.tagNumber=2}static blockName(){return"Integer"}isEqual(e){return e instanceof I?this.valueBlock.isHexOnly&&e.valueBlock.isHexOnly?(0,f.isEqualBuffer)(this.valueBlock.valueHex,e.valueBlock.valueHex):this.valueBlock.isHexOnly===e.valueBlock.isHexOnly&&this.valueBlock.valueDec===e.valueBlock.valueDec:e instanceof ArrayBuffer&&(0,f.isEqualBuffer)(this.valueBlock.valueHex,e)}convertToDER(){const e=new I({valueHex:this.valueBlock.valueHex});return e.valueBlock.toDER(),e}convertFromDER(){const e=this.valueBlock.valueHex.byteLength%2?this.valueBlock.valueHex.byteLength+1:this.valueBlock.valueHex.byteLength,t=new I({valueHex:this.valueBlock.valueHex});return t.valueBlock.fromDER(t.valueBlock.valueHex,0,t.valueBlock.valueHex.byteLength,e),t}}t.Integer=I;class O extends I{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=10}static blockName(){return"Enumerated"}}t.Enumerated=O;class N extends(o(i)){constructor(e={}){super(e),this.valueDec=(0,f.getParametersValue)(e,"valueDec",-1),this.isFirstSid=(0,f.getParametersValue)(e,"isFirstSid",!1)}static blockName(){return"sidBlock"}fromBER(e,t,r){if(0===r)return t;if(!1===(0,f.checkBufferParams)(this,e,t,r))return-1;const n=new Uint8Array(e,t,r);this.valueHex=new ArrayBuffer(r);let i=new Uint8Array(this.valueHex);for(let e=0;e<r&&(i[e]=127&n[e],this.blockLength++,0!=(128&n[e]));e++);const o=new ArrayBuffer(this.blockLength),s=new Uint8Array(o);for(let e=0;e<this.blockLength;e++)s[e]=i[e];return this.valueHex=o.slice(0),i=new Uint8Array(this.valueHex),0!=(128&n[this.blockLength-1])?(this.error="End of input reached before message was fully decoded",-1):(0===i[0]&&this.warnings.push("Needlessly long format of SID encoding"),this.blockLength<=8?this.valueDec=(0,f.utilFromBase)(i,7):(this.isHexOnly=!0,this.warnings.push("Too big SID for decoding, hex only")),t+this.blockLength)}toBER(e=!1){let t,r;if(this.isHexOnly){if(!0===e)return new ArrayBuffer(this.valueHex.byteLength);const n=new Uint8Array(this.valueHex);t=new ArrayBuffer(this.blockLength),r=new Uint8Array(t);for(let e=0;e<this.blockLength-1;e++)r[e]=128|n[e];return r[this.blockLength-1]=n[this.blockLength-1],t}const n=(0,f.utilToBase)(this.valueDec,7);if(0===n.byteLength)return this.error="Error during encoding SID value",new ArrayBuffer(0);if(t=new ArrayBuffer(n.byteLength),!1===e){const e=new Uint8Array(n);r=new Uint8Array(t);for(let t=0;t<n.byteLength-1;t++)r[t]=128|e[t];r[n.byteLength-1]=e[n.byteLength-1]}return t}toString(){let e="";if(!0===this.isHexOnly)e=(0,f.bufferToHexCodes)(this.valueHex,0,this.valueHex.byteLength);else if(this.isFirstSid){let t=this.valueDec;this.valueDec<=39?e="0.":this.valueDec<=79?(e="1.",t-=40):(e="2.",t-=80),e+=t.toString()}else e=this.valueDec.toString();return e}toJSON(){let e={};try{e=super.toJSON()}catch(e){}return e.valueDec=this.valueDec,e.isFirstSid=this.isFirstSid,e}}class E extends c{constructor(e={}){super(e),this.fromString((0,f.getParametersValue)(e,"value",""))}fromBER(e,t,r){let n=t;for(;r>0;){const t=new N;if(n=t.fromBER(e,n,r),-1===n)return this.blockLength=0,this.error=t.error,n;0===this.value.length&&(t.isFirstSid=!0),this.blockLength+=t.blockLength,r-=t.blockLength,this.value.push(t)}return n}toBER(e=!1){let t=new ArrayBuffer(0);for(let r=0;r<this.value.length;r++){const n=this.value[r].toBER(e);if(0===n.byteLength)return this.error=this.value[r].error,new ArrayBuffer(0);t=(0,f.utilConcatBuf)(t,n)}return t}fromString(e){this.value=[];let t=0,r=0,n="",i=!1;do{if(r=e.indexOf(".",t),n=-1===r?e.substr(t):e.substr(t,r-t),t=r+1,i){const e=this.value[0];let t=0;switch(e.valueDec){case 0:break;case 1:t=40;break;case 2:t=80;break;default:return this.value=[],!1}const r=parseInt(n,10);if(isNaN(r))return!0;e.valueDec=r+t,i=!1}else{const e=new N;if(e.valueDec=parseInt(n,10),isNaN(e.valueDec))return!0;0===this.value.length&&(e.isFirstSid=!0,i=!0),this.value.push(e)}}while(-1!==r);return!0}toString(){let e="",t=!1;for(let r=0;r<this.value.length;r++){t=this.value[r].isHexOnly;let n=this.value[r].toString();0!==r&&(e=`${e}.`),t?(n=`{${n}}`,this.value[r].isFirstSid?e=`2.{${n} - 80}`:e+=n):e+=n}return e}static blockName(){return"ObjectIdentifierValueBlock"}toJSON(){let e={};try{e=super.toJSON()}catch(e){}e.value=this.toString(),e.sidArray=[];for(let t=0;t<this.value.length;t++)e.sidArray.push(this.value[t].toJSON());return e}}class T extends l{constructor(e={}){super(e,E),this.idBlock.tagClass=1,this.idBlock.tagNumber=6}static blockName(){return"ObjectIdentifier"}}t.ObjectIdentifier=T;class P extends(o(i)){constructor(e={}){super(e),this.isHexOnly=!0,this.value=""}static blockName(){return"Utf8StringValueBlock"}toJSON(){let e={};try{e=super.toJSON()}catch(e){}return e.value=this.value,e}}class j extends l{constructor(e={}){super(e,P),"value"in e&&this.fromString(e.value),this.idBlock.tagClass=1,this.idBlock.tagNumber=12}static blockName(){return"Utf8String"}fromBER(e,t,r){const n=this.valueBlock.fromBER(e,t,!0===this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return-1===n?(this.error=this.valueBlock.error,n):(this.fromBuffer(this.valueBlock.valueHex),0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),0===this.valueBlock.error.length&&(this.blockLength+=this.valueBlock.blockLength),n)}fromBuffer(e){this.valueBlock.value=String.fromCharCode.apply(null,new Uint8Array(e));try{this.valueBlock.value=decodeURIComponent(escape(this.valueBlock.value))}catch(e){this.warnings.push(`Error during "decodeURIComponent": ${e}, using raw string`)}}fromString(e){const t=unescape(encodeURIComponent(e)),r=t.length;this.valueBlock.valueHex=new ArrayBuffer(r);const n=new Uint8Array(this.valueBlock.valueHex);for(let e=0;e<r;e++)n[e]=t.charCodeAt(e);this.valueBlock.value=e}}t.Utf8String=j;class H extends(o(i)){constructor(e={}){super(e),this.valueDec=(0,f.getParametersValue)(e,"valueDec",-1)}static blockName(){return"relativeSidBlock"}fromBER(e,t,r){if(0===r)return t;if(!1===(0,f.checkBufferParams)(this,e,t,r))return-1;const n=new Uint8Array(e,t,r);this.valueHex=new ArrayBuffer(r);let i=new Uint8Array(this.valueHex);for(let e=0;e<r&&(i[e]=127&n[e],this.blockLength++,0!=(128&n[e]));e++);const o=new ArrayBuffer(this.blockLength),s=new Uint8Array(o);for(let e=0;e<this.blockLength;e++)s[e]=i[e];return this.valueHex=o.slice(0),i=new Uint8Array(this.valueHex),0!=(128&n[this.blockLength-1])?(this.error="End of input reached before message was fully decoded",-1):(0===i[0]&&this.warnings.push("Needlessly long format of SID encoding"),this.blockLength<=8?this.valueDec=(0,f.utilFromBase)(i,7):(this.isHexOnly=!0,this.warnings.push("Too big SID for decoding, hex only")),t+this.blockLength)}toBER(e=!1){let t,r;if(this.isHexOnly){if(!0===e)return new ArrayBuffer(this.valueHex.byteLength);const n=new Uint8Array(this.valueHex);t=new ArrayBuffer(this.blockLength),r=new Uint8Array(t);for(let e=0;e<this.blockLength-1;e++)r[e]=128|n[e];return r[this.blockLength-1]=n[this.blockLength-1],t}const n=(0,f.utilToBase)(this.valueDec,7);if(0===n.byteLength)return this.error="Error during encoding SID value",new ArrayBuffer(0);if(t=new ArrayBuffer(n.byteLength),!1===e){const e=new Uint8Array(n);r=new Uint8Array(t);for(let t=0;t<n.byteLength-1;t++)r[t]=128|e[t];r[n.byteLength-1]=e[n.byteLength-1]}return t}toString(){let e="";return e=!0===this.isHexOnly?(0,f.bufferToHexCodes)(this.valueHex,0,this.valueHex.byteLength):this.valueDec.toString(),e}toJSON(){let e={};try{e=super.toJSON()}catch(e){}return e.valueDec=this.valueDec,e}}class U extends c{constructor(e={}){super(e),this.fromString((0,f.getParametersValue)(e,"value",""))}fromBER(e,t,r){let n=t;for(;r>0;){const t=new H;if(n=t.fromBER(e,n,r),-1===n)return this.blockLength=0,this.error=t.error,n;this.blockLength+=t.blockLength,r-=t.blockLength,this.value.push(t)}return n}toBER(e=!1){let t=new ArrayBuffer(0);for(let r=0;r<this.value.length;r++){const n=this.value[r].toBER(e);if(0===n.byteLength)return this.error=this.value[r].error,new ArrayBuffer(0);t=(0,f.utilConcatBuf)(t,n)}return t}fromString(e){this.value=[];let t=0,r=0,n="";do{r=e.indexOf(".",t),n=-1===r?e.substr(t):e.substr(t,r-t),t=r+1;const i=new H;if(i.valueDec=parseInt(n,10),isNaN(i.valueDec))return!0;this.value.push(i)}while(-1!==r);return!0}toString(){let e="",t=!1;for(let r=0;r<this.value.length;r++){t=this.value[r].isHexOnly;let n=this.value[r].toString();0!==r&&(e=`${e}.`),t?(n=`{${n}}`,e+=n):e+=n}return e}static blockName(){return"RelativeObjectIdentifierValueBlock"}toJSON(){let e={};try{e=super.toJSON()}catch(e){}e.value=this.toString(),e.sidArray=[];for(let t=0;t<this.value.length;t++)e.sidArray.push(this.value[t].toJSON());return e}}class R extends l{constructor(e={}){super(e,U),this.idBlock.tagClass=1,this.idBlock.tagNumber=13}static blockName(){return"RelativeObjectIdentifier"}}t.RelativeObjectIdentifier=R;class L extends(o(i)){constructor(e={}){super(e),this.isHexOnly=!0,this.value=""}static blockName(){return"BmpStringValueBlock"}toJSON(){let e={};try{e=super.toJSON()}catch(e){}return e.value=this.value,e}}class D extends l{constructor(e={}){super(e,L),"value"in e&&this.fromString(e.value),this.idBlock.tagClass=1,this.idBlock.tagNumber=30}static blockName(){return"BmpString"}fromBER(e,t,r){const n=this.valueBlock.fromBER(e,t,!0===this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return-1===n?(this.error=this.valueBlock.error,n):(this.fromBuffer(this.valueBlock.valueHex),0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),0===this.valueBlock.error.length&&(this.blockLength+=this.valueBlock.blockLength),n)}fromBuffer(e){const t=e.slice(0),r=new Uint8Array(t);for(let e=0;e<r.length;e+=2){const t=r[e];r[e]=r[e+1],r[e+1]=t}this.valueBlock.value=String.fromCharCode.apply(null,new Uint16Array(t))}fromString(e){const t=e.length;this.valueBlock.valueHex=new ArrayBuffer(2*t);const r=new Uint8Array(this.valueBlock.valueHex);for(let n=0;n<t;n++){const t=(0,f.utilToBase)(e.charCodeAt(n),8),i=new Uint8Array(t);if(i.length>2)continue;const o=2-i.length;for(let e=i.length-1;e>=0;e--)r[2*n+e+o]=i[e]}this.valueBlock.value=e}}t.BmpString=D;class _ extends(o(i)){constructor(e={}){super(e),this.isHexOnly=!0,this.value=""}static blockName(){return"UniversalStringValueBlock"}toJSON(){let e={};try{e=super.toJSON()}catch(e){}return e.value=this.value,e}}class V extends l{constructor(e={}){super(e,_),"value"in e&&this.fromString(e.value),this.idBlock.tagClass=1,this.idBlock.tagNumber=28}static blockName(){return"UniversalString"}fromBER(e,t,r){const n=this.valueBlock.fromBER(e,t,!0===this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return-1===n?(this.error=this.valueBlock.error,n):(this.fromBuffer(this.valueBlock.valueHex),0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),0===this.valueBlock.error.length&&(this.blockLength+=this.valueBlock.blockLength),n)}fromBuffer(e){const t=e.slice(0),r=new Uint8Array(t);for(let e=0;e<r.length;e+=4)r[e]=r[e+3],r[e+1]=r[e+2],r[e+2]=0,r[e+3]=0;this.valueBlock.value=String.fromCharCode.apply(null,new Uint32Array(t))}fromString(e){const t=e.length;this.valueBlock.valueHex=new ArrayBuffer(4*t);const r=new Uint8Array(this.valueBlock.valueHex);for(let n=0;n<t;n++){const t=(0,f.utilToBase)(e.charCodeAt(n),8),i=new Uint8Array(t);if(i.length>4)continue;const o=4-i.length;for(let e=i.length-1;e>=0;e--)r[4*n+e+o]=i[e]}this.valueBlock.value=e}}t.UniversalString=V;class F extends(o(i)){constructor(e={}){super(e),this.value="",this.isHexOnly=!0}static blockName(){return"SimpleStringValueBlock"}toJSON(){let e={};try{e=super.toJSON()}catch(e){}return e.value=this.value,e}}class $ extends l{constructor(e={}){super(e,F),"value"in e&&this.fromString(e.value)}static blockName(){return"SIMPLESTRING"}fromBER(e,t,r){const n=this.valueBlock.fromBER(e,t,!0===this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return-1===n?(this.error=this.valueBlock.error,n):(this.fromBuffer(this.valueBlock.valueHex),0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),0===this.valueBlock.error.length&&(this.blockLength+=this.valueBlock.blockLength),n)}fromBuffer(e){this.valueBlock.value=String.fromCharCode.apply(null,new Uint8Array(e))}fromString(e){const t=e.length;this.valueBlock.valueHex=new ArrayBuffer(t);const r=new Uint8Array(this.valueBlock.valueHex);for(let n=0;n<t;n++)r[n]=e.charCodeAt(n);this.valueBlock.value=e}}class z extends ${constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=18}static blockName(){return"NumericString"}}t.NumericString=z;class M extends ${constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=19}static blockName(){return"PrintableString"}}t.PrintableString=M;class q extends ${constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=20}static blockName(){return"TeletexString"}}t.TeletexString=q;class K extends ${constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=21}static blockName(){return"VideotexString"}}t.VideotexString=K;class J extends ${constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=22}static blockName(){return"IA5String"}}t.IA5String=J;class W extends ${constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=25}static blockName(){return"GraphicString"}}t.GraphicString=W;class G extends ${constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=26}static blockName(){return"VisibleString"}}t.VisibleString=G;class Z extends ${constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=27}static blockName(){return"GeneralString"}}t.GeneralString=Z;class X extends ${constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=29}static blockName(){return"CharacterString"}}t.CharacterString=X;class Y extends G{constructor(e={}){if(super(e),this.year=0,this.month=0,this.day=0,this.hour=0,this.minute=0,this.second=0,"value"in e){this.fromString(e.value),this.valueBlock.valueHex=new ArrayBuffer(e.value.length);const t=new Uint8Array(this.valueBlock.valueHex);for(let r=0;r<e.value.length;r++)t[r]=e.value.charCodeAt(r)}"valueDate"in e&&(this.fromDate(e.valueDate),this.valueBlock.valueHex=this.toBuffer()),this.idBlock.tagClass=1,this.idBlock.tagNumber=23}fromBER(e,t,r){const n=this.valueBlock.fromBER(e,t,!0===this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return-1===n?(this.error=this.valueBlock.error,n):(this.fromBuffer(this.valueBlock.valueHex),0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),0===this.valueBlock.error.length&&(this.blockLength+=this.valueBlock.blockLength),n)}fromBuffer(e){this.fromString(String.fromCharCode.apply(null,new Uint8Array(e)))}toBuffer(){const e=this.toString(),t=new ArrayBuffer(e.length),r=new Uint8Array(t);for(let t=0;t<e.length;t++)r[t]=e.charCodeAt(t);return t}fromDate(e){this.year=e.getUTCFullYear(),this.month=e.getUTCMonth()+1,this.day=e.getUTCDate(),this.hour=e.getUTCHours(),this.minute=e.getUTCMinutes(),this.second=e.getUTCSeconds()}toDate(){return new Date(Date.UTC(this.year,this.month-1,this.day,this.hour,this.minute,this.second))}fromString(e){const t=/(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})Z/gi.exec(e);if(null===t)return void(this.error="Wrong input string for convertion");const r=parseInt(t[1],10);this.year=r>=50?1900+r:2e3+r,this.month=parseInt(t[2],10),this.day=parseInt(t[3],10),this.hour=parseInt(t[4],10),this.minute=parseInt(t[5],10),this.second=parseInt(t[6],10)}toString(){const e=new Array(7);return e[0]=(0,f.padNumber)(this.year<2e3?this.year-1900:this.year-2e3,2),e[1]=(0,f.padNumber)(this.month,2),e[2]=(0,f.padNumber)(this.day,2),e[3]=(0,f.padNumber)(this.hour,2),e[4]=(0,f.padNumber)(this.minute,2),e[5]=(0,f.padNumber)(this.second,2),e[6]="Z",e.join("")}static blockName(){return"UTCTime"}toJSON(){let e={};try{e=super.toJSON()}catch(e){}return e.year=this.year,e.month=this.month,e.day=this.day,e.hour=this.hour,e.minute=this.minute,e.second=this.second,e}}t.UTCTime=Y;class Q extends G{constructor(e={}){if(super(e),this.year=0,this.month=0,this.day=0,this.hour=0,this.minute=0,this.second=0,this.millisecond=0,"value"in e){this.fromString(e.value),this.valueBlock.valueHex=new ArrayBuffer(e.value.length);const t=new Uint8Array(this.valueBlock.valueHex);for(let r=0;r<e.value.length;r++)t[r]=e.value.charCodeAt(r)}"valueDate"in e&&(this.fromDate(e.valueDate),this.valueBlock.valueHex=this.toBuffer()),this.idBlock.tagClass=1,this.idBlock.tagNumber=24}fromBER(e,t,r){const n=this.valueBlock.fromBER(e,t,!0===this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return-1===n?(this.error=this.valueBlock.error,n):(this.fromBuffer(this.valueBlock.valueHex),0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),0===this.valueBlock.error.length&&(this.blockLength+=this.valueBlock.blockLength),n)}fromBuffer(e){this.fromString(String.fromCharCode.apply(null,new Uint8Array(e)))}toBuffer(){const e=this.toString(),t=new ArrayBuffer(e.length),r=new Uint8Array(t);for(let t=0;t<e.length;t++)r[t]=e.charCodeAt(t);return t}fromDate(e){this.year=e.getUTCFullYear(),this.month=e.getUTCMonth()+1,this.day=e.getUTCDate(),this.hour=e.getUTCHours(),this.minute=e.getUTCMinutes(),this.second=e.getUTCSeconds(),this.millisecond=e.getUTCMilliseconds()}toDate(){return new Date(Date.UTC(this.year,this.month-1,this.day,this.hour,this.minute,this.second,this.millisecond))}fromString(e){let t,r=!1,n="",i="",o=0,s=0,a=0;if("Z"===e[e.length-1])n=e.substr(0,e.length-1),r=!0;else{const t=new Number(e[e.length-1]);if(isNaN(t.valueOf()))throw new Error("Wrong input string for convertion");n=e}if(r){if(-1!==n.indexOf("+"))throw new Error("Wrong input string for convertion");if(-1!==n.indexOf("-"))throw new Error("Wrong input string for convertion")}else{let e=1,t=n.indexOf("+"),r="";if(-1===t&&(t=n.indexOf("-"),e=-1),-1!==t){if(r=n.substr(t+1),n=n.substr(0,t),2!==r.length&&4!==r.length)throw new Error("Wrong input string for convertion");let i=new Number(r.substr(0,2));if(isNaN(i.valueOf()))throw new Error("Wrong input string for convertion");if(s=e*i,4===r.length){if(i=new Number(r.substr(2,2)),isNaN(i.valueOf()))throw new Error("Wrong input string for convertion");a=e*i}}}let c=n.indexOf(".");if(-1===c&&(c=n.indexOf(",")),-1!==c){const e=new Number(`0${n.substr(c)}`);if(isNaN(e.valueOf()))throw new Error("Wrong input string for convertion");o=e.valueOf(),i=n.substr(0,c)}else i=n;switch(!0){case 8===i.length:if(t=/(\d{4})(\d{2})(\d{2})/gi,-1!==c)throw new Error("Wrong input string for convertion");break;case 10===i.length:if(t=/(\d{4})(\d{2})(\d{2})(\d{2})/gi,-1!==c){let e=60*o;this.minute=Math.floor(e),e=60*(e-this.minute),this.second=Math.floor(e),e=1e3*(e-this.second),this.millisecond=Math.floor(e)}break;case 12===i.length:if(t=/(\d{4})(\d{2})(\d{2})(\d{2})(\d{2})/gi,-1!==c){let e=60*o;this.second=Math.floor(e),e=1e3*(e-this.second),this.millisecond=Math.floor(e)}break;case 14===i.length:if(t=/(\d{4})(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})/gi,-1!==c){const e=1e3*o;this.millisecond=Math.floor(e)}break;default:throw new Error("Wrong input string for convertion")}const l=t.exec(i);if(null===l)throw new Error("Wrong input string for convertion");for(let e=1;e<l.length;e++)switch(e){case 1:this.year=parseInt(l[e],10);break;case 2:this.month=parseInt(l[e],10);break;case 3:this.day=parseInt(l[e],10);break;case 4:this.hour=parseInt(l[e],10)+s;break;case 5:this.minute=parseInt(l[e],10)+a;break;case 6:this.second=parseInt(l[e],10);break;default:throw new Error("Wrong input string for convertion")}if(!1===r){const e=new Date(this.year,this.month,this.day,this.hour,this.minute,this.second,this.millisecond);this.year=e.getUTCFullYear(),this.month=e.getUTCMonth(),this.day=e.getUTCDay(),this.hour=e.getUTCHours(),this.minute=e.getUTCMinutes(),this.second=e.getUTCSeconds(),this.millisecond=e.getUTCMilliseconds()}}toString(){const e=[];return e.push((0,f.padNumber)(this.year,4)),e.push((0,f.padNumber)(this.month,2)),e.push((0,f.padNumber)(this.day,2)),e.push((0,f.padNumber)(this.hour,2)),e.push((0,f.padNumber)(this.minute,2)),e.push((0,f.padNumber)(this.second,2)),0!==this.millisecond&&(e.push("."),e.push((0,f.padNumber)(this.millisecond,3))),e.push("Z"),e.join("")}static blockName(){return"GeneralizedTime"}toJSON(){let e={};try{e=super.toJSON()}catch(e){}return e.year=this.year,e.month=this.month,e.day=this.day,e.hour=this.hour,e.minute=this.minute,e.second=this.second,e.millisecond=this.millisecond,e}}t.GeneralizedTime=Q;class ee extends j{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=31}static blockName(){return"DATE"}}t.DATE=ee;class te extends j{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=32}static blockName(){return"TimeOfDay"}}t.TimeOfDay=te;class re extends j{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=33}static blockName(){return"DateTime"}}t.DateTime=re;class ne extends j{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=34}static blockName(){return"Duration"}}t.Duration=ne;class ie extends j{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=14}static blockName(){return"TIME"}}t.TIME=ie;class oe{constructor(e={}){this.value=(0,f.getParametersValue)(e,"value",[]),this.optional=(0,f.getParametersValue)(e,"optional",!1)}}t.Choice=oe;class se{constructor(e={}){this.name=(0,f.getParametersValue)(e,"name",""),this.optional=(0,f.getParametersValue)(e,"optional",!1)}}t.Any=se;class ae{constructor(e={}){this.name=(0,f.getParametersValue)(e,"name",""),this.optional=(0,f.getParametersValue)(e,"optional",!1),this.value=(0,f.getParametersValue)(e,"value",new se),this.local=(0,f.getParametersValue)(e,"local",!1)}}t.Repeated=ae;function ce(e,t,r){const n=t;let o=new l({},Object);const s=new i;if(!1===(0,f.checkBufferParams)(s,e,t,r))return o.error=s.error,{offset:-1,result:o};if(0===new Uint8Array(e,t,r).length)return this.error="Zero buffer length",{offset:-1,result:o};let a=o.idBlock.fromBER(e,t,r);if(o.warnings.concat(o.idBlock.warnings),-1===a)return o.error=o.idBlock.error,{offset:-1,result:o};if(t=a,r-=o.idBlock.blockLength,a=o.lenBlock.fromBER(e,t,r),o.warnings.concat(o.lenBlock.warnings),-1===a)return o.error=o.lenBlock.error,{offset:-1,result:o};if(t=a,r-=o.lenBlock.blockLength,!1===o.idBlock.isConstructed&&!0===o.lenBlock.isIndefiniteForm)return o.error="Indefinite length form used for primitive encoding form",{offset:-1,result:o};let c=l;switch(o.idBlock.tagClass){case 1:if(o.idBlock.tagNumber>=37&&!1===o.idBlock.isHexOnly)return o.error="UNIVERSAL 37 and upper tags are reserved by ASN.1 standard",{offset:-1,result:o};switch(o.idBlock.tagNumber){case 0:if(!0===o.idBlock.isConstructed&&o.lenBlock.length>0)return o.error="Type [UNIVERSAL 0] is reserved",{offset:-1,result:o};c=g;break;case 1:c=m;break;case 2:c=I;break;case 3:c=x;break;case 4:c=A;break;case 5:c=B;break;case 6:c=T;break;case 10:c=O;break;case 12:c=j;break;case 13:c=R;break;case 14:c=ie;break;case 15:return o.error="[UNIVERSAL 15] is reserved by ASN.1 standard",{offset:-1,result:o};case 16:c=b;break;case 17:c=w;break;case 18:c=z;break;case 19:c=M;break;case 20:c=q;break;case 21:c=K;break;case 22:c=J;break;case 23:c=Y;break;case 24:c=Q;break;case 25:c=W;break;case 26:c=G;break;case 27:c=Z;break;case 28:c=V;break;case 29:c=X;break;case 30:c=D;break;case 31:c=ee;break;case 32:c=te;break;case 33:c=re;break;case 34:c=ne;break;default:{let n;n=!0===o.idBlock.isConstructed?new y:new h,n.idBlock=o.idBlock,n.lenBlock=o.lenBlock,n.warnings=o.warnings,o=n,a=o.fromBER(e,t,r)}}break;case 2:case 3:case 4:default:c=!0===o.idBlock.isConstructed?y:h}return o=function(e,t){if(e instanceof t)return e;const r=new t;return r.idBlock=e.idBlock,r.lenBlock=e.lenBlock,r.warnings=e.warnings,r.valueBeforeDecode=e.valueBeforeDecode.slice(0),r}(o,c),a=o.fromBER(e,t,!0===o.lenBlock.isIndefiniteForm?r:o.lenBlock.length),o.valueBeforeDecode=e.slice(n,n+o.blockLength),{offset:a,result:o}}function le(e){if(0===e.byteLength){const e=new l({},Object);return e.error="Input buffer has zero length",{offset:-1,result:e}}return ce(e,0,e.byteLength)}function ue(e,t,r){if(r instanceof oe){for(let n=0;n<r.value.length;n++){if(!0===ue(e,t,r.value[n]).verified)return{verified:!0,result:e}}{const e={verified:!1,result:{error:"Wrong values for Choice type"}};return r.hasOwnProperty("name")&&(e.name=r.name),e}}if(r instanceof se)return r.hasOwnProperty("name")&&(e[r.name]=t),{verified:!0,result:e};if(e instanceof Object==!1)return{verified:!1,result:{error:"Wrong root object"}};if(t instanceof Object==!1)return{verified:!1,result:{error:"Wrong ASN.1 data"}};if(r instanceof Object==!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if("idBlock"in r==!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if("fromBER"in r.idBlock==!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if("toBER"in r.idBlock==!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};const n=r.idBlock.toBER(!1);if(0===n.byteLength)return{verified:!1,result:{error:"Error encoding idBlock for ASN.1 schema"}};if(-1===r.idBlock.fromBER(n,0,n.byteLength))return{verified:!1,result:{error:"Error decoding idBlock for ASN.1 schema"}};if(!1===r.idBlock.hasOwnProperty("tagClass"))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(r.idBlock.tagClass!==t.idBlock.tagClass)return{verified:!1,result:e};if(!1===r.idBlock.hasOwnProperty("tagNumber"))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(r.idBlock.tagNumber!==t.idBlock.tagNumber)return{verified:!1,result:e};if(!1===r.idBlock.hasOwnProperty("isConstructed"))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(r.idBlock.isConstructed!==t.idBlock.isConstructed)return{verified:!1,result:e};if("isHexOnly"in r.idBlock==!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(r.idBlock.isHexOnly!==t.idBlock.isHexOnly)return{verified:!1,result:e};if(!0===r.idBlock.isHexOnly){if("valueHex"in r.idBlock==!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};const n=new Uint8Array(r.idBlock.valueHex),i=new Uint8Array(t.idBlock.valueHex);if(n.length!==i.length)return{verified:!1,result:e};for(let t=0;t<n.length;t++)if(n[t]!==i[1])return{verified:!1,result:e}}if(r.hasOwnProperty("name")&&(r.name=r.name.replace(/^\s+|\s+$/g,""),""!==r.name&&(e[r.name]=t)),!0===r.idBlock.isConstructed){let n=0,i={verified:!1},o=r.valueBlock.value.length;if(o>0&&r.valueBlock.value[0]instanceof ae&&(o=t.valueBlock.value.length),0===o)return{verified:!0,result:e};if(0===t.valueBlock.value.length&&0!==r.valueBlock.value.length){let t=!0;for(let e=0;e<r.valueBlock.value.length;e++)t=t&&(r.valueBlock.value[e].optional||!1);return!0===t?{verified:!0,result:e}:(r.hasOwnProperty("name")&&(r.name=r.name.replace(/^\s+|\s+$/g,""),""!==r.name&&delete e[r.name]),e.error="Inconsistent object length",{verified:!1,result:e})}for(let s=0;s<o;s++)if(s-n>=t.valueBlock.value.length){if(!1===r.valueBlock.value[s].optional){const t={verified:!1,result:e};return e.error="Inconsistent length between ASN.1 data and schema",r.hasOwnProperty("name")&&(r.name=r.name.replace(/^\s+|\s+$/g,""),""!==r.name&&(delete e[r.name],t.name=r.name)),t}}else if(r.valueBlock.value[0]instanceof ae){if(i=ue(e,t.valueBlock.value[s],r.valueBlock.value[0].value),!1===i.verified){if(!0!==r.valueBlock.value[0].optional)return r.hasOwnProperty("name")&&(r.name=r.name.replace(/^\s+|\s+$/g,""),""!==r.name&&delete e[r.name]),i;n++}if("name"in r.valueBlock.value[0]&&r.valueBlock.value[0].name.length>0){let n={};n="local"in r.valueBlock.value[0]&&!0===r.valueBlock.value[0].local?t:e,void 0===n[r.valueBlock.value[0].name]&&(n[r.valueBlock.value[0].name]=[]),n[r.valueBlock.value[0].name].push(t.valueBlock.value[s])}}else if(i=ue(e,t.valueBlock.value[s-n],r.valueBlock.value[s]),!1===i.verified){if(!0!==r.valueBlock.value[s].optional)return r.hasOwnProperty("name")&&(r.name=r.name.replace(/^\s+|\s+$/g,""),""!==r.name&&delete e[r.name]),i;n++}if(!1===i.verified){const t={verified:!1,result:e};return r.hasOwnProperty("name")&&(r.name=r.name.replace(/^\s+|\s+$/g,""),""!==r.name&&(delete e[r.name],t.name=r.name)),t}return{verified:!0,result:e}}if("primitiveSchema"in r&&"valueHex"in t.valueBlock){const n=le(t.valueBlock.valueHex);if(-1===n.offset){const t={verified:!1,result:n.result};return r.hasOwnProperty("name")&&(r.name=r.name.replace(/^\s+|\s+$/g,""),""!==r.name&&(delete e[r.name],t.name=r.name)),t}return ue(e,n.result,r.primitiveSchema)}return{verified:!0,result:e}}t.RawData=class{constructor(e={}){this.data=(0,f.getParametersValue)(e,"data",new ArrayBuffer(0))}fromBER(e,t,r){return this.data=e.slice(t,r),t+r}toBER(e=!1){return this.data}}})),d=n(y),g=Object.freeze(Object.assign(Object.create(null),y,{default:d}));!function(e){e[e.Sequence=0]="Sequence",e[e.Set=1]="Set",e[e.Choice=2]="Choice"}(h||(h={})),function(e){e[e.Any=1]="Any",e[e.Boolean=2]="Boolean",e[e.OctetString=3]="OctetString",e[e.BitString=4]="BitString",e[e.Integer=5]="Integer",e[e.Enumerated=6]="Enumerated",e[e.ObjectIdentifier=7]="ObjectIdentifier",e[e.Utf8String=8]="Utf8String",e[e.BmpString=9]="BmpString",e[e.UniversalString=10]="UniversalString",e[e.NumericString=11]="NumericString",e[e.PrintableString=12]="PrintableString",e[e.TeletexString=13]="TeletexString",e[e.VideotexString=14]="VideotexString",e[e.IA5String=15]="IA5String",e[e.GraphicString=16]="GraphicString",e[e.VisibleString=17]="VisibleString",e[e.GeneralString=18]="GeneralString",e[e.CharacterString=19]="CharacterString",e[e.UTCTime=20]="UTCTime",e[e.GeneralizedTime=21]="GeneralizedTime",e[e.DATE=22]="DATE",e[e.TimeOfDay=23]="TimeOfDay",e[e.DateTime=24]="DateTime",e[e.Duration=25]="Duration",e[e.TIME=26]="TIME",e[e.Null=27]="Null"}(p||(p={}));const v={fromASN:e=>e instanceof y.Null?null:e.valueBeforeDecode,toASN:e=>{if(null===e)return new y.Null;const t=y.fromBER(e);if(t.result.error)throw new Error(t.result.error);return t.result}},m={fromASN:e=>e.valueBlock.valueHex.byteLength>4?e.valueBlock.toString():e.valueBlock.valueDec,toASN:e=>new y.Integer({value:e})},b={fromASN:e=>e.valueBlock.valueDec,toASN:e=>new y.Enumerated({value:e})},w={fromASN:e=>e.valueBlock.valueHex,toASN:e=>new y.Integer({valueHex:e})},B={fromASN:e=>e.valueBlock.valueHex,toASN:e=>new y.BitString({valueHex:e})},k={fromASN:e=>e.valueBlock.toString(),toASN:e=>new y.ObjectIdentifier({value:e})},A={fromASN:e=>e.valueBlock.value,toASN:e=>new y.Boolean({value:e})},S={fromASN:e=>e.valueBlock.valueHex,toASN:e=>new y.OctetString({valueHex:e})};function x(e){return{fromASN:e=>e.valueBlock.value,toASN:t=>new e({value:t})}}const C=x(y.Utf8String),I=x(y.BmpString),O=x(y.UniversalString),N=x(y.NumericString),E=x(y.PrintableString),T=x(y.TeletexString),P=x(y.VideotexString),j=x(y.IA5String),H=x(y.GraphicString),U=x(y.VisibleString),R=x(y.GeneralString),L=x(y.CharacterString),D={fromASN:e=>e.toDate(),toASN:e=>new y.UTCTime({valueDate:e})},_={fromASN:e=>e.toDate(),toASN:e=>new y.GeneralizedTime({valueDate:e})},V={fromASN:e=>null,toASN:e=>new y.Null};function F(e){switch(e){case p.Any:return v;case p.BitString:return B;case p.BmpString:return I;case p.Boolean:return A;case p.CharacterString:return L;case p.Enumerated:return b;case p.GeneralString:return R;case p.GeneralizedTime:return _;case p.GraphicString:return H;case p.IA5String:return j;case p.Integer:return m;case p.Null:return V;case p.NumericString:return N;case p.ObjectIdentifier:return k;case p.OctetString:return S;case p.PrintableString:return E;case p.TeletexString:return T;case p.UTCTime:return D;case p.UniversalString:return O;case p.Utf8String:return C;case p.VideotexString:return P;case p.VisibleString:return U;default:return null}}class ${static isArrayBuffer(e){return"[object ArrayBuffer]"===Object.prototype.toString.call(e)}static toArrayBuffer(e){const t=this.toUint8Array(e);return t.byteOffset||t.length?t.buffer.slice(t.byteOffset,t.byteOffset+t.length):t.buffer}static toUint8Array(e){if("undefined"!=typeof Buffer&&Buffer.isBuffer(e))return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);if(this.isArrayBuffer(e))return new Uint8Array(e);throw new TypeError("The provided value is not of type '(ArrayBuffer or ArrayBufferView)'")}static isBufferSource(e){return this.isArrayBufferView(e)||this.isArrayBuffer(e)}static isArrayBufferView(e){return ArrayBuffer.isView(e)||e&&this.isArrayBuffer(e.buffer)}}function z(e){return"undefined"!=typeof Buffer&&Buffer.isBuffer(e)?new Uint8Array(e):$.isArrayBufferView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e)}class M{static isHex(e){return"string"==typeof e&&/^[a-z0-9]+$/i.test(e)}static isBase64(e){return"string"==typeof e&&/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}static isBase64Url(e){return"string"==typeof e&&/^[a-zA-Z0-9-_]+$/i.test(e)}static ToString(e,t="utf8"){const r=z(e);switch(t.toLowerCase()){case"utf8":return this.ToUtf8String(r);case"binary":return this.ToBinary(r);case"hex":return this.ToHex(r);case"base64":return this.ToBase64(r);case"base64url":return this.ToBase64Url(r);default:throw new Error(`Unknown type of encoding '${t}'`)}}static FromString(e,t="utf8"){if(!e)return new ArrayBuffer(0);switch(t.toLowerCase()){case"utf8":return this.FromUtf8String(e);case"binary":return this.FromBinary(e);case"hex":return this.FromHex(e);case"base64":return this.FromBase64(e);case"base64url":return this.FromBase64Url(e);default:throw new Error(`Unknown type of encoding '${t}'`)}}static ToBase64(e){const t=z(e);if("undefined"!=typeof btoa){const e=this.ToString(t,"binary");return btoa(e)}return Buffer.from(t).toString("base64")}static FromBase64(e){const t=this.formatString(e);if(!t)return new ArrayBuffer(0);if(!M.isBase64(t))throw new TypeError("Argument 'base64Text' is not Base64 encoded");return"undefined"!=typeof atob?this.FromBinary(atob(t)):new Uint8Array(Buffer.from(t,"base64")).buffer}static FromBase64Url(e){const t=this.formatString(e);if(!t)return new ArrayBuffer(0);if(!M.isBase64Url(t))throw new TypeError("Argument 'base64url' is not Base64Url encoded");return this.FromBase64(this.Base64Padding(t.replace(/\-/g,"+").replace(/\_/g,"/")))}static ToBase64Url(e){return this.ToBase64(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/\=/g,"")}static FromUtf8String(e){const t=unescape(encodeURIComponent(e)),r=new Uint8Array(t.length);for(let e=0;e<t.length;e++)r[e]=t.charCodeAt(e);return r.buffer}static ToUtf8String(e){const t=z(e),r=String.fromCharCode.apply(null,t);return decodeURIComponent(escape(r))}static FromBinary(e){const t=e.length,r=new Uint8Array(t);for(let n=0;n<t;n++)r[n]=e.charCodeAt(n);return r.buffer}static ToBinary(e){const t=z(e);let r="";const n=t.length;for(let e=0;e<n;e++)r+=String.fromCharCode(t[e]);return r}static ToHex(e){const t=z(e),r=[],n=t.length;for(let e=0;e<n;e++){const n=t[e].toString(16);r.push(1===n.length?"0"+n:n)}return r.join("")}static FromHex(e){let t=this.formatString(e);if(!t)return new ArrayBuffer(0);if(!M.isHex(t))throw new TypeError("Argument 'hexString' is not HEX encoded");t.length%2&&(t=`0${t}`);const r=new Uint8Array(t.length/2);for(let e=0;e<t.length;e+=2){const n=t.slice(e,e+2);r[e/2]=parseInt(n,16)}return r.buffer}static Base64Padding(e){const t=4-e.length%4;if(t<4)for(let r=0;r<t;r++)e+="=";return e}static formatString(e){return(null==e?void 0:e.replace(/[\n\r\t ]/g,""))||""}}function q(e,t){if(!e||!t)return!1;if(e.byteLength!==t.byteLength)return!1;const r=new Uint8Array(e),n=new Uint8Array(t);for(let t=0;t<e.byteLength;t++)if(r[t]!==n[t])return!1;return!0}class K{constructor(e,t=0){if(this.unusedBits=0,this.value=new ArrayBuffer(0),e)if("number"==typeof e)this.fromNumber(e);else{if(!$.isBufferSource(e))throw TypeError("Unsupported type of 'params' argument for BitString");this.unusedBits=t,this.value=$.toArrayBuffer(e)}}fromASN(e){if(!(e instanceof y.BitString))throw new TypeError("Argument 'asn' is not instance of ASN.1 BitString");return this.unusedBits=e.valueBlock.unusedBits,this.value=e.valueBlock.valueHex,this}toASN(){return new y.BitString({unusedBits:this.unusedBits,valueHex:this.value})}toSchema(e){return new y.BitString({name:e})}toNumber(){let e="";const t=new Uint8Array(this.value);for(const r of t)e+=r.toString(2).padStart(8,"0");return e=e.split("").reverse().join(""),this.unusedBits&&(e=e.slice(this.unusedBits).padStart(this.unusedBits,"0")),parseInt(e,2)}fromNumber(e){let t=e.toString(2);const r=t.length+7>>3;this.unusedBits=(r<<3)-t.length;const n=new Uint8Array(r);t=t.padStart(r<<3,"0").split("").reverse().join("");let i=0;for(;i<r;)n[i]=parseInt(t.slice(i<<3,8+(i<<3)),2),i++;this.value=n.buffer}}class J{constructor(e){"number"==typeof e?this.buffer=new ArrayBuffer(e):$.isBufferSource(e)?this.buffer=$.toArrayBuffer(e):Array.isArray(e)?this.buffer=new Uint8Array(e):this.buffer=new ArrayBuffer(0)}get byteLength(){return this.buffer.byteLength}get byteOffset(){return 0}fromASN(e){if(!(e instanceof y.OctetString))throw new TypeError("Argument 'asn' is not instance of ASN.1 OctetString");return this.buffer=e.valueBlock.valueHex,this}toASN(){return new y.OctetString({valueHex:this.buffer})}toSchema(e){return new y.OctetString({name:e})}}function W(e){return e&&e.prototype?!(!e.prototype.toASN||!e.prototype.fromASN)||W(e.prototype):!!(e&&e.toASN&&e.fromASN)}function G(e){var t;if(e){const r=Object.getPrototypeOf(e);return(null===(t=null==r?void 0:r.prototype)||void 0===t?void 0:t.constructor)===Array||G(r)}return!1}function Z(e,t){if(!e||!t)return!1;if(e.byteLength!==t.byteLength)return!1;const r=new Uint8Array(e),n=new Uint8Array(t);for(let t=0;t<e.byteLength;t++)if(r[t]!==n[t])return!1;return!0}const X=new class{constructor(){this.items=new WeakMap}has(e){return this.items.has(e)}get(e){var t,r,n,i;const o=this.items.get(e);if(!o)throw new Error(`Cannot get schema for '${null!==(i=null===(n=null===(r=null===(t=e)||void 0===t?void 0:t.prototype)||void 0===r?void 0:r.constructor)||void 0===n?void 0:n.name)&&void 0!==i?i:e}' target`);return o}cache(e){const t=this.get(e);t.schema||(t.schema=this.create(e,!0))}createDefault(e){const t={type:h.Sequence,items:{}},r=this.findParentSchema(e);return r&&(Object.assign(t,r),t.items=Object.assign({},t.items,r.items)),t}create(e,t){const r=this.items.get(e)||this.createDefault(e),n=[];for(const e in r.items){const i=r.items[e],o=t?e:"";let s;if("number"==typeof i.type){const e=p[i.type],t=g[e];if(!t)throw new Error(`Cannot get ASN1 class by name '${e}'`);s=new t({name:o})}else if(W(i.type)){s=(new i.type).toSchema(o)}else if(i.optional){this.get(i.type).type===h.Choice?s=new y.Any({name:o}):(s=this.create(i.type,!1),s.name=o)}else s=new y.Any({name:o});const a=!!i.optional||void 0!==i.defaultValue;if(i.repeated){s.name="";s=new("set"===i.repeated?y.Set:y.Sequence)({name:"",value:[new y.Repeated({name:o,value:s})]})}if(null!==i.context&&void 0!==i.context)if(i.implicit)if("number"==typeof i.type||W(i.type)){const e=i.repeated?y.Constructed:y.Primitive;n.push(new e({name:o,optional:a,idBlock:{tagClass:3,tagNumber:i.context}}))}else{this.cache(i.type);const e=!!i.repeated;let t=e?s:this.get(i.type).schema;t=t.valueBlock?t.valueBlock.value:t.value,n.push(new y.Constructed({name:e?"":o,optional:a,idBlock:{tagClass:3,tagNumber:i.context},value:t}))}else n.push(new y.Constructed({optional:a,idBlock:{tagClass:3,tagNumber:i.context},value:[s]}));else s.optional=a,n.push(s)}switch(r.type){case h.Sequence:return new y.Sequence({value:n,name:""});case h.Set:return new y.Set({value:n,name:""});case h.Choice:return new y.Choice({value:n,name:""});default:throw new Error("Unsupported ASN1 type in use")}}set(e,t){return this.items.set(e,t),this}findParentSchema(e){const t=e.__proto__;if(t){return this.items.get(t)||this.findParentSchema(t)}return null}},Y=e=>t=>{let r;X.has(t)?r=X.get(t):(r=X.createDefault(t),X.set(t,r)),Object.assign(r,e)},Q=e=>(t,r)=>{let n;X.has(t.constructor)?n=X.get(t.constructor):(n=X.createDefault(t.constructor),X.set(t.constructor,n));const i=Object.assign({},e);if("number"==typeof i.type&&!i.converter){const n=F(e.type);if(!n)throw new Error(`Cannot get default converter for property '${r}' of ${t.constructor.name}`);i.converter=n}n.items[r]=i};class ee extends Error{constructor(){super(...arguments),this.schemas=[]}}class te{static serialize(e){return e instanceof y.BaseBlock?e.toBER(!1):this.toASN(e).toBER(!1)}static toASN(e){if(e&&W(e.constructor))return e.toASN();const t=e.constructor,r=X.get(t);X.cache(t);let n,i=[];if(r.itemType)if("number"==typeof r.itemType){const n=F(r.itemType);if(!n)throw new Error(`Cannot get default converter for array item of ${t.name} ASN1 schema`);i=e.map((e=>n.toASN(e)))}else i=e.map((e=>this.toAsnItem({type:r.itemType},"[]",t,e)));else for(const n in r.items){const o=r.items[n],s=e[n];if(void 0===s||o.defaultValue===s||"object"==typeof o.defaultValue&&"object"==typeof s&&Z(this.serialize(o.defaultValue),this.serialize(s)))continue;let a=te.toAsnItem(o,n,t,s);if("number"==typeof o.context)if(o.implicit)if(o.repeated||"number"!=typeof o.type&&!W(o.type))i.push(new y.Constructed({optional:o.optional,idBlock:{tagClass:3,tagNumber:o.context},value:a.valueBlock.value}));else{const e={};e.valueHex=a.valueBlock.toBER(),i.push(new y.Primitive(Object.assign({optional:o.optional,idBlock:{tagClass:3,tagNumber:o.context}},e)))}else i.push(new y.Constructed({optional:o.optional,idBlock:{tagClass:3,tagNumber:o.context},value:[a]}));else o.repeated?i=i.concat(a):i.push(a)}switch(r.type){case h.Sequence:n=new y.Sequence({value:i});break;case h.Set:n=new y.Set({value:i});break;case h.Choice:if(!i[0])throw new Error(`Schema '${t.name}' has wrong data. Choice cannot be empty.`);n=i[0]}return n}static toAsnItem(e,t,r,n){let i;if("number"==typeof e.type){const o=e.converter;if(!o)throw new Error(`Property '${t}' doesn't have converter for type ${p[e.type]} in schema '${r.name}'`);if(e.repeated){const t=Array.from(n,(e=>o.toASN(e)));i=new("sequence"===e.repeated?y.Sequence:y.Set)({value:t})}else i=o.toASN(n)}else if(e.repeated){const t=Array.from(n,(e=>this.toASN(e)));i=new("sequence"===e.repeated?y.Sequence:y.Set)({value:t})}else i=this.toASN(n);return i}}class re extends Array{constructor(e=[]){if("number"==typeof e)super(e);else{super();for(const t of e)this.push(t)}}}class ne{static serialize(e){return te.serialize(e)}static parse(e,t){return class{static parse(e,t){let r;if(e instanceof ArrayBuffer)r=e;else if("undefined"!=typeof Buffer&&Buffer.isBuffer(e))r=new Uint8Array(e).buffer;else{if(!(ArrayBuffer.isView(e)||e.buffer instanceof ArrayBuffer))throw new TypeError("Wrong type of 'data' argument");r=e.buffer}const n=y.fromBER(r);if(n.result.error)throw new Error(n.result.error);return this.fromASN(n.result,t)}static fromASN(e,t){var r;try{if(W(t))return(new t).fromASN(e);const n=X.get(t);X.cache(t);let i=n.schema;if(e.constructor===y.Constructed&&n.type!==h.Choice){i=new y.Constructed({idBlock:{tagClass:3,tagNumber:e.idBlock.tagNumber},value:n.schema.valueBlock.value});for(const t in n.items)delete e[t]}const o=y.compareSchema(e,e,i);if(!o.verified)throw new ee(`Data does not match to ${t.name} ASN1 schema. ${o.result.error}`);const s=new t;if(G(t)){if("number"==typeof n.itemType){const r=F(n.itemType);if(!r)throw new Error(`Cannot get default converter for array item of ${t.name} ASN1 schema`);return t.from(e.valueBlock.value,(e=>r.fromASN(e)))}return t.from(e.valueBlock.value,(e=>this.fromASN(e,n.itemType)))}for(const t in n.items){if(!e[t])continue;const i=n.items[t];if("number"==typeof i.type||W(i.type)){const n=null!==(r=i.converter)&&void 0!==r?r:W(i.type)?new i.type:null;if(!n)throw new Error("Converter is empty");if(i.repeated)if(i.implicit){const r=new("sequence"===i.repeated?y.Sequence:y.Set);r.valueBlock=e[t].valueBlock;const o=y.fromBER(r.toBER(!1)).result.valueBlock.value;s[t]=Array.from(o,(e=>n.fromASN(e)))}else s[t]=Array.from(e[t],(e=>n.fromASN(e)));else{let r=e[t];if(i.implicit){let e;if(W(i.type))e=(new i.type).toSchema("");else{const t=p[i.type],r=g[t];if(!r)throw new Error(`Cannot get '${t}' class from asn1js module`);e=new r}e.valueBlock=r.valueBlock,r=y.fromBER(e.toBER(!1)).result}s[t]=n.fromASN(r)}}else i.repeated?s[t]=Array.from(e[t],(e=>this.fromASN(e,i.type))):s[t]=this.fromASN(e[t],i.type)}return s}catch(e){throw e instanceof ee&&e.schemas.push(t.name),e}}}.parse(e,t)}}
/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */function ie(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s}var oe,se,ae,ce=o((function(e){!function(t){const r="(0?\\d+|0x[a-f0-9]+)",n={fourOctet:new RegExp(`^${r}\\.${r}\\.${r}\\.${r}$`,"i"),threeOctet:new RegExp(`^${r}\\.${r}\\.${r}$`,"i"),twoOctet:new RegExp(`^${r}\\.${r}$`,"i"),longValue:new RegExp(`^${r}$`,"i")},i=new RegExp("^0[0-7]+$","i"),o=new RegExp("^0x[a-f0-9]+$","i"),s="%[0-9a-z]{1,}",a="(?:[0-9a-f]+::?)+",c={zoneIndex:new RegExp(s,"i"),native:new RegExp(`^(::)?(${a})?([0-9a-f]+)?(::)?(${s})?$`,"i"),deprecatedTransitional:new RegExp(`^(?:::)(${r}\\.${r}\\.${r}\\.${r}(${s})?)$`,"i"),transitional:new RegExp(`^((?:${a})|(?:::)(?:${a})?)${r}\\.${r}\\.${r}\\.${r}(${s})?$`,"i")};function l(e,t){if(e.indexOf("::")!==e.lastIndexOf("::"))return null;let r,n,i=0,o=-1,s=(e.match(c.zoneIndex)||[])[0];for(s&&(s=s.substring(1),e=e.replace(/%.+$/,""));(o=e.indexOf(":",o+1))>=0;)i++;if("::"===e.substr(0,2)&&i--,"::"===e.substr(-2,2)&&i--,i>t)return null;for(n=t-i,r=":";n--;)r+="0:";return":"===(e=e.replace("::",r))[0]&&(e=e.slice(1)),":"===e[e.length-1]&&(e=e.slice(0,-1)),{parts:t=function(){const t=e.split(":"),r=[];for(let e=0;e<t.length;e++)r.push(parseInt(t[e],16));return r}(),zoneId:s}}function u(e,t,r,n){if(e.length!==t.length)throw new Error("ipaddr: cannot match CIDR for objects with different lengths");let i,o=0;for(;n>0;){if(i=r-n,i<0&&(i=0),e[o]>>i!=t[o]>>i)return!1;n-=r,o+=1}return!0}function h(e){if(o.test(e))return parseInt(e,16);if("0"===e[0]&&!isNaN(parseInt(e[1],10))){if(i.test(e))return parseInt(e,8);throw new Error(`ipaddr: cannot parse ${e} as octal`)}return parseInt(e,10)}function p(e,t){for(;e.length<t;)e=`0${e}`;return e}const f={};f.IPv4=function(){function e(e){if(4!==e.length)throw new Error("ipaddr: ipv4 octet count should be 4");let t,r;for(t=0;t<e.length;t++)if(r=e[t],!(0<=r&&r<=255))throw new Error("ipaddr: ipv4 octet should fit in 8 bits");this.octets=e}return e.prototype.SpecialRanges={unspecified:[[new e([0,0,0,0]),8]],broadcast:[[new e([255,255,255,255]),32]],multicast:[[new e([224,0,0,0]),4]],linkLocal:[[new e([169,254,0,0]),16]],loopback:[[new e([127,0,0,0]),8]],carrierGradeNat:[[new e([100,64,0,0]),10]],private:[[new e([10,0,0,0]),8],[new e([172,16,0,0]),12],[new e([192,168,0,0]),16]],reserved:[[new e([192,0,0,0]),24],[new e([192,0,2,0]),24],[new e([192,88,99,0]),24],[new e([198,51,100,0]),24],[new e([203,0,113,0]),24],[new e([240,0,0,0]),4]]},e.prototype.kind=function(){return"ipv4"},e.prototype.match=function(e,t){let r;if(void 0===t&&(r=e,e=r[0],t=r[1]),"ipv4"!==e.kind())throw new Error("ipaddr: cannot match ipv4 address with non-ipv4 one");return u(this.octets,e.octets,8,t)},e.prototype.prefixLengthFromSubnetMask=function(){let e=0,t=!1;const r={0:8,128:7,192:6,224:5,240:4,248:3,252:2,254:1,255:0};let n,i,o;for(n=3;n>=0;n-=1){if(i=this.octets[n],!(i in r))return null;if(o=r[i],t&&0!==o)return null;8!==o&&(t=!0),e+=o}return 32-e},e.prototype.range=function(){return f.subnetMatch(this,this.SpecialRanges)},e.prototype.toByteArray=function(){return this.octets.slice(0)},e.prototype.toIPv4MappedAddress=function(){return f.IPv6.parse(`::ffff:${this.toString()}`)},e.prototype.toNormalizedString=function(){return this.toString()},e.prototype.toString=function(){return this.octets.join(".")},e}(),f.IPv4.broadcastAddressFromCIDR=function(e){try{const t=this.parseCIDR(e),r=t[0].toByteArray(),n=this.subnetMaskFromPrefixLength(t[1]).toByteArray(),i=[];let o=0;for(;o<4;)i.push(parseInt(r[o],10)|255^parseInt(n[o],10)),o++;return new this(i)}catch(e){throw new Error("ipaddr: the address does not have IPv4 CIDR format")}},f.IPv4.isIPv4=function(e){return null!==this.parser(e)},f.IPv4.isValid=function(e){try{return new this(this.parser(e)),!0}catch(e){return!1}},f.IPv4.isValidFourPartDecimal=function(e){return!(!f.IPv4.isValid(e)||!e.match(/^(0|[1-9]\d*)(\.(0|[1-9]\d*)){3}$/))},f.IPv4.networkAddressFromCIDR=function(e){let t,r,n,i,o;try{for(t=this.parseCIDR(e),n=t[0].toByteArray(),o=this.subnetMaskFromPrefixLength(t[1]).toByteArray(),i=[],r=0;r<4;)i.push(parseInt(n[r],10)&parseInt(o[r],10)),r++;return new this(i)}catch(e){throw new Error("ipaddr: the address does not have IPv4 CIDR format")}},f.IPv4.parse=function(e){const t=this.parser(e);if(null===t)throw new Error("ipaddr: string is not formatted like an IPv4 Address");return new this(t)},f.IPv4.parseCIDR=function(e){let t;if(t=e.match(/^(.+)\/(\d+)$/)){const e=parseInt(t[2]);if(e>=0&&e<=32){const r=[this.parse(t[1]),e];return Object.defineProperty(r,"toString",{value:function(){return this.join("/")}}),r}}throw new Error("ipaddr: string is not formatted like an IPv4 CIDR range")},f.IPv4.parser=function(e){let t,r,i;if(t=e.match(n.fourOctet))return function(){const e=t.slice(1,6),n=[];for(let t=0;t<e.length;t++)r=e[t],n.push(h(r));return n}();if(t=e.match(n.longValue)){if(i=h(t[1]),i>4294967295||i<0)throw new Error("ipaddr: address outside defined range");return function(){const e=[];let t;for(t=0;t<=24;t+=8)e.push(i>>t&255);return e}().reverse()}return(t=e.match(n.twoOctet))?function(){const e=t.slice(1,4),r=[];if(i=h(e[1]),i>16777215||i<0)throw new Error("ipaddr: address outside defined range");return r.push(h(e[0])),r.push(i>>16&255),r.push(i>>8&255),r.push(255&i),r}():(t=e.match(n.threeOctet))?function(){const e=t.slice(1,5),r=[];if(i=h(e[2]),i>65535||i<0)throw new Error("ipaddr: address outside defined range");return r.push(h(e[0])),r.push(h(e[1])),r.push(i>>8&255),r.push(255&i),r}():null},f.IPv4.subnetMaskFromPrefixLength=function(e){if((e=parseInt(e))<0||e>32)throw new Error("ipaddr: invalid IPv4 prefix length");const t=[0,0,0,0];let r=0;const n=Math.floor(e/8);for(;r<n;)t[r]=255,r++;return n<4&&(t[n]=Math.pow(2,e%8)-1<<8-e%8),new this(t)},f.IPv6=function(){function e(e,t){let r,n;if(16===e.length)for(this.parts=[],r=0;r<=14;r+=2)this.parts.push(e[r]<<8|e[r+1]);else{if(8!==e.length)throw new Error("ipaddr: ipv6 part count should be 8 or 16");this.parts=e}for(r=0;r<this.parts.length;r++)if(n=this.parts[r],!(0<=n&&n<=65535))throw new Error("ipaddr: ipv6 part should fit in 16 bits");t&&(this.zoneId=t)}return e.prototype.SpecialRanges={unspecified:[new e([0,0,0,0,0,0,0,0]),128],linkLocal:[new e([65152,0,0,0,0,0,0,0]),10],multicast:[new e([65280,0,0,0,0,0,0,0]),8],loopback:[new e([0,0,0,0,0,0,0,1]),128],uniqueLocal:[new e([64512,0,0,0,0,0,0,0]),7],ipv4Mapped:[new e([0,0,0,0,0,65535,0,0]),96],rfc6145:[new e([0,0,0,0,65535,0,0,0]),96],rfc6052:[new e([100,65435,0,0,0,0,0,0]),96],"6to4":[new e([8194,0,0,0,0,0,0,0]),16],teredo:[new e([8193,0,0,0,0,0,0,0]),32],reserved:[[new e([8193,3512,0,0,0,0,0,0]),32]]},e.prototype.isIPv4MappedAddress=function(){return"ipv4Mapped"===this.range()},e.prototype.kind=function(){return"ipv6"},e.prototype.match=function(e,t){let r;if(void 0===t&&(r=e,e=r[0],t=r[1]),"ipv6"!==e.kind())throw new Error("ipaddr: cannot match ipv6 address with non-ipv6 one");return u(this.parts,e.parts,16,t)},e.prototype.prefixLengthFromSubnetMask=function(){let e=0,t=!1;const r={0:16,32768:15,49152:14,57344:13,61440:12,63488:11,64512:10,65024:9,65280:8,65408:7,65472:6,65504:5,65520:4,65528:3,65532:2,65534:1,65535:0};let n,i;for(let o=7;o>=0;o-=1){if(n=this.parts[o],!(n in r))return null;if(i=r[n],t&&0!==i)return null;16!==i&&(t=!0),e+=i}return 128-e},e.prototype.range=function(){return f.subnetMatch(this,this.SpecialRanges)},e.prototype.toByteArray=function(){let e;const t=[],r=this.parts;for(let n=0;n<r.length;n++)e=r[n],t.push(e>>8),t.push(255&e);return t},e.prototype.toFixedLengthString=function(){const e=function(){const e=[];for(let t=0;t<this.parts.length;t++)e.push(p(this.parts[t].toString(16),4));return e}.call(this).join(":");let t="";return this.zoneId&&(t=`%${this.zoneId}`),e+t},e.prototype.toIPv4Address=function(){if(!this.isIPv4MappedAddress())throw new Error("ipaddr: trying to convert a generic ipv6 address to ipv4");const e=this.parts.slice(-2),t=e[0],r=e[1];return new f.IPv4([t>>8,255&t,r>>8,255&r])},e.prototype.toNormalizedString=function(){const e=function(){const e=[];for(let t=0;t<this.parts.length;t++)e.push(this.parts[t].toString(16));return e}.call(this).join(":");let t="";return this.zoneId&&(t=`%${this.zoneId}`),e+t},e.prototype.toRFC5952String=function(){const e=/((^|:)(0(:|$)){2,})/g,t=this.toNormalizedString();let r,n=0,i=-1;for(;r=e.exec(t);)r[0].length>i&&(n=r.index,i=r[0].length);return i<0?t:`${t.substring(0,n)}::${t.substring(n+i)}`},e.prototype.toString=function(){return this.toNormalizedString().replace(/((^|:)(0(:|$))+)/,"::")},e}(),f.IPv6.isIPv6=function(e){return null!==this.parser(e)},f.IPv6.isValid=function(e){if("string"==typeof e&&-1===e.indexOf(":"))return!1;try{const t=this.parser(e);return new this(t.parts,t.zoneId),!0}catch(e){return!1}},f.IPv6.parse=function(e){const t=this.parser(e);if(null===t.parts)throw new Error("ipaddr: string is not formatted like an IPv6 Address");return new this(t.parts,t.zoneId)},f.IPv6.parseCIDR=function(e){let t,r,n;if((r=e.match(/^(.+)\/(\d+)$/))&&(t=parseInt(r[2]),t>=0&&t<=128))return n=[this.parse(r[1]),t],Object.defineProperty(n,"toString",{value:function(){return this.join("/")}}),n;throw new Error("ipaddr: string is not formatted like an IPv6 CIDR range")},f.IPv6.parser=function(e){let t,r,n,i,o,s;if(n=e.match(c.deprecatedTransitional))return this.parser(`::ffff:${n[1]}`);if(c.native.test(e))return l(e,8);if((n=e.match(c.transitional))&&(s=n[6]||"",t=l(n[1].slice(0,-1)+s,6),t.parts)){for(o=[parseInt(n[2]),parseInt(n[3]),parseInt(n[4]),parseInt(n[5])],r=0;r<o.length;r++)if(i=o[r],!(0<=i&&i<=255))return null;return t.parts.push(o[0]<<8|o[1]),t.parts.push(o[2]<<8|o[3]),{parts:t.parts,zoneId:t.zoneId}}return null},f.fromByteArray=function(e){const t=e.length;if(4===t)return new f.IPv4(e);if(16===t)return new f.IPv6(e);throw new Error("ipaddr: the binary input is neither an IPv6 nor IPv4 address")},f.isValid=function(e){return f.IPv6.isValid(e)||f.IPv4.isValid(e)},f.parse=function(e){if(f.IPv6.isValid(e))return f.IPv6.parse(e);if(f.IPv4.isValid(e))return f.IPv4.parse(e);throw new Error("ipaddr: the address has neither IPv6 nor IPv4 format")},f.parseCIDR=function(e){try{return f.IPv6.parseCIDR(e)}catch(t){try{return f.IPv4.parseCIDR(e)}catch(e){throw new Error("ipaddr: the address has neither IPv6 nor IPv4 CIDR format")}}},f.process=function(e){const t=this.parse(e);return"ipv6"===t.kind()&&t.isIPv4MappedAddress()?t.toIPv4Address():t},f.subnetMatch=function(e,t,r){let n,i,o,s;for(i in null==r&&(r="unicast"),t)if(Object.prototype.hasOwnProperty.call(t,i))for(o=t[i],!o[0]||o[0]instanceof Array||(o=[o]),n=0;n<o.length;n++)if(s=o[n],e.kind()===s[0].kind()&&e.match.apply(e,s))return i;return r},e.exports?e.exports=f:t.ipaddr=f}(r)}));class le{static decodeIP(e){if(64===e.length&&0===parseInt(e,16))return"::/0";if(16!==e.length)return e;const t=parseInt(e.slice(8),16).toString(2).split("").reduce(((e,t)=>e+ +t),0);let r=e.slice(0,8).replace(/(.{2})/g,(e=>`${parseInt(e,16)}.`));return r=r.slice(0,-1),`${r}/${t}`}static toString(e){if(4===e.byteLength||16===e.byteLength){const t=new Uint8Array(e);return ce.fromByteArray(Array.from(t)).toString()}return this.decodeIP(M.ToHex(e))}static fromString(e){const t=ce.parse(e);return new Uint8Array(t.toByteArray()).buffer}}let ue=class{constructor(e={}){Object.assign(this,e)}toString(){return this.bmpString||this.printableString||this.teletexString||this.universalString||this.utf8String||""}};ie([Q({type:p.TeletexString})],ue.prototype,"teletexString",void 0),ie([Q({type:p.PrintableString})],ue.prototype,"printableString",void 0),ie([Q({type:p.UniversalString})],ue.prototype,"universalString",void 0),ie([Q({type:p.Utf8String})],ue.prototype,"utf8String",void 0),ie([Q({type:p.BmpString})],ue.prototype,"bmpString",void 0),ue=ie([Y({type:h.Choice})],ue);let he=class extends ue{constructor(e={}){super(e),Object.assign(this,e)}toString(){return this.ia5String||(this.anyValue?M.ToHex(this.anyValue):super.toString())}};ie([Q({type:p.IA5String})],he.prototype,"ia5String",void 0),ie([Q({type:p.Any})],he.prototype,"anyValue",void 0),he=ie([Y({type:h.Choice})],he);class pe{constructor(e={}){this.type="",this.value=new he,Object.assign(this,e)}}ie([Q({type:p.ObjectIdentifier})],pe.prototype,"type",void 0),ie([Q({type:he})],pe.prototype,"value",void 0);let fe=oe=class extends re{constructor(e){super(e),Object.setPrototypeOf(this,oe.prototype)}};fe=oe=ie([Y({type:h.Set,itemType:pe})],fe);let ye=se=class extends re{constructor(e){super(e),Object.setPrototypeOf(this,se.prototype)}};ye=se=ie([Y({type:h.Sequence,itemType:fe})],ye);let de=ae=class extends ye{constructor(e){super(e),Object.setPrototypeOf(this,ae.prototype)}};de=ae=ie([Y({type:h.Sequence})],de);const ge={fromASN:e=>le.toString(S.fromASN(e)),toASN:e=>S.toASN(le.fromString(e))};class ve{constructor(e={}){this.typeId="",this.value=new ArrayBuffer(0),Object.assign(this,e)}}ie([Q({type:p.ObjectIdentifier})],ve.prototype,"typeId",void 0),ie([Q({type:p.Any,context:0})],ve.prototype,"value",void 0);class me{constructor(e={}){this.partyName=new ArrayBuffer(0),Object.assign(this,e)}}ie([Q({type:ue,optional:!0,context:0,implicit:!0})],me.prototype,"nameAssigner",void 0),ie([Q({type:ue,context:1,implicit:!0})],me.prototype,"partyName",void 0);let be=class{constructor(e={}){Object.assign(this,e)}};ie([Q({type:ve,context:0,implicit:!0})],be.prototype,"otherName",void 0),ie([Q({type:p.IA5String,context:1,implicit:!0})],be.prototype,"rfc822Name",void 0),ie([Q({type:p.IA5String,context:2,implicit:!0})],be.prototype,"dNSName",void 0),ie([Q({type:p.Any,context:3,implicit:!0})],be.prototype,"x400Address",void 0),ie([Q({type:de,context:4,implicit:!1})],be.prototype,"directoryName",void 0),ie([Q({type:me,context:5})],be.prototype,"ediPartyName",void 0),ie([Q({type:p.IA5String,context:6,implicit:!0})],be.prototype,"uniformResourceIdentifier",void 0),ie([Q({type:p.OctetString,context:7,implicit:!0,converter:ge})],be.prototype,"iPAddress",void 0),ie([Q({type:p.ObjectIdentifier,context:8,implicit:!0})],be.prototype,"registeredID",void 0),be=ie([Y({type:h.Choice})],be);var we;class Be{constructor(e={}){this.accessMethod="",this.accessLocation=new be,Object.assign(this,e)}}ie([Q({type:p.ObjectIdentifier})],Be.prototype,"accessMethod",void 0),ie([Q({type:be})],Be.prototype,"accessLocation",void 0);let ke=we=class extends re{constructor(e){super(e),Object.setPrototypeOf(this,we.prototype)}};ke=we=ie([Y({type:h.Sequence,itemType:Be})],ke);const Ae="2.5.29.35";class Se extends J{}class xe{constructor(e={}){e&&Object.assign(this,e)}}ie([Q({type:Se,context:0,optional:!0,implicit:!0})],xe.prototype,"keyIdentifier",void 0),ie([Q({type:be,context:1,optional:!0,implicit:!0,repeated:"sequence"})],xe.prototype,"authorityCertIssuer",void 0),ie([Q({type:p.Integer,context:2,optional:!0,implicit:!0,converter:w})],xe.prototype,"authorityCertSerialNumber",void 0);const Ce="2.5.29.19";class Ie{constructor(e={}){this.cA=!1,Object.assign(this,e)}}var Oe;ie([Q({type:p.Boolean,defaultValue:!1})],Ie.prototype,"cA",void 0),ie([Q({type:p.Integer,optional:!0})],Ie.prototype,"pathLenConstraint",void 0);let Ne=Oe=class extends re{constructor(e){super(e),Object.setPrototypeOf(this,Oe.prototype)}};var Ee;Ne=Oe=ie([Y({type:h.Sequence,itemType:be})],Ne);let Te=Ee=class extends Ne{constructor(e){super(e),Object.setPrototypeOf(this,Ee.prototype)}};var Pe;Te=Ee=ie([Y({type:h.Sequence})],Te);let je=class{constructor(e={}){Object.assign(this,e)}toString(){return this.ia5String||this.visibleString||this.bmpString||this.utf8String}};ie([Q({type:p.IA5String})],je.prototype,"ia5String",void 0),ie([Q({type:p.VisibleString})],je.prototype,"visibleString",void 0),ie([Q({type:p.BmpString})],je.prototype,"bmpString",void 0),ie([Q({type:p.Utf8String})],je.prototype,"utf8String",void 0),je=ie([Y({type:h.Choice})],je);class He{constructor(e={}){this.organization=new je,this.noticeNumbers=[],Object.assign(this,e)}}ie([Q({type:je})],He.prototype,"organization",void 0),ie([Q({type:p.Integer,repeated:"sequence"})],He.prototype,"noticeNumbers",void 0);class Ue{constructor(e={}){Object.assign(this,e)}}ie([Q({type:He,optional:!0})],Ue.prototype,"noticeRef",void 0),ie([Q({type:je,optional:!0})],Ue.prototype,"explicitText",void 0);let Re=class{constructor(e={}){Object.assign(this,e)}};ie([Q({type:p.IA5String})],Re.prototype,"cPSuri",void 0),ie([Q({type:Ue})],Re.prototype,"userNotice",void 0),Re=ie([Y({type:h.Choice})],Re);class Le{constructor(e={}){this.policyQualifierId="",this.qualifier=new ArrayBuffer(0),Object.assign(this,e)}}ie([Q({type:p.ObjectIdentifier})],Le.prototype,"policyQualifierId",void 0),ie([Q({type:p.Any})],Le.prototype,"qualifier",void 0);class De{constructor(e={}){this.policyIdentifier="",Object.assign(this,e)}}ie([Q({type:p.ObjectIdentifier})],De.prototype,"policyIdentifier",void 0),ie([Q({type:Le,repeated:"sequence",optional:!0})],De.prototype,"policyQualifiers",void 0);let _e=Pe=class extends re{constructor(e){super(e),Object.setPrototypeOf(this,Pe.prototype)}};var Ve,Fe;_e=Pe=ie([Y({type:h.Sequence,itemType:De})],_e),function(e){e[e.unused=1]="unused",e[e.keyCompromise=2]="keyCompromise",e[e.cACompromise=4]="cACompromise",e[e.affiliationChanged=8]="affiliationChanged",e[e.superseded=16]="superseded",e[e.cessationOfOperation=32]="cessationOfOperation",e[e.certificateHold=64]="certificateHold",e[e.privilegeWithdrawn=128]="privilegeWithdrawn",e[e.aACompromise=256]="aACompromise"}(Fe||(Fe={}));let $e=class{constructor(e={}){Object.assign(this,e)}};ie([Q({type:be,context:0,repeated:"sequence",implicit:!0})],$e.prototype,"fullName",void 0),ie([Q({type:fe,context:1,implicit:!0})],$e.prototype,"nameRelativeToCRLIssuer",void 0),$e=ie([Y({type:h.Choice})],$e);class ze{constructor(e={}){Object.assign(this,e)}}ie([Q({type:$e,context:0,optional:!0})],ze.prototype,"distributionPoint",void 0),ie([Q({type:class extends K{toJSON(){const e=[],t=this.toNumber();return t&Fe.aACompromise&&e.push("aACompromise"),t&Fe.affiliationChanged&&e.push("affiliationChanged"),t&Fe.cACompromise&&e.push("cACompromise"),t&Fe.certificateHold&&e.push("certificateHold"),t&Fe.cessationOfOperation&&e.push("cessationOfOperation"),t&Fe.keyCompromise&&e.push("keyCompromise"),t&Fe.privilegeWithdrawn&&e.push("privilegeWithdrawn"),t&Fe.superseded&&e.push("superseded"),t&Fe.unused&&e.push("unused"),e}toString(){return`[${this.toJSON().join(", ")}]`}},context:1,optional:!0,implicit:!0})],ze.prototype,"reasons",void 0),ie([Q({type:be,context:2,optional:!0,repeated:"sequence",implicit:!0})],ze.prototype,"cRLIssuer",void 0);let Me=Ve=class extends re{constructor(e){super(e),Object.setPrototypeOf(this,Ve.prototype)}};var qe;Me=Ve=ie([Y({type:h.Sequence,itemType:ze})],Me),function(e){e[e.unspecified=0]="unspecified",e[e.keyCompromise=1]="keyCompromise",e[e.cACompromise=2]="cACompromise",e[e.affiliationChanged=3]="affiliationChanged",e[e.superseded=4]="superseded",e[e.cessationOfOperation=5]="cessationOfOperation",e[e.certificateHold=6]="certificateHold",e[e.removeFromCRL=8]="removeFromCRL",e[e.privilegeWithdrawn=9]="privilegeWithdrawn",e[e.aACompromise=10]="aACompromise"}(qe||(qe={}));let Ke=class{constructor(e=qe.unspecified){this.reason=qe.unspecified,this.reason=e}toJSON(){return qe[this.reason]}toString(){return this.toJSON()}};var Je;ie([Q({type:p.Enumerated})],Ke.prototype,"reason",void 0),Ke=ie([Y({type:h.Choice})],Ke);const We="2.5.29.37";let Ge=Je=class extends re{constructor(e){super(e),Object.setPrototypeOf(this,Je.prototype)}};Ge=Je=ie([Y({type:h.Sequence,itemType:p.ObjectIdentifier})],Ge);let Ze=class{constructor(e=new ArrayBuffer(0)){this.value=e}};ie([Q({type:p.Integer,converter:w})],Ze.prototype,"value",void 0),Ze=ie([Y({type:h.Choice})],Ze);let Xe=class{constructor(e){this.value=new Date,e&&(this.value=e)}};var Ye;ie([Q({type:p.GeneralizedTime})],Xe.prototype,"value",void 0),Xe=ie([Y({type:h.Choice})],Xe);let Qe=Ye=class extends Ne{constructor(e){super(e),Object.setPrototypeOf(this,Ye.prototype)}};Qe=Ye=ie([Y({type:h.Sequence})],Qe);const et="2.5.29.15";var tt,rt;!function(e){e[e.digitalSignature=1]="digitalSignature",e[e.nonRepudiation=2]="nonRepudiation",e[e.keyEncipherment=4]="keyEncipherment",e[e.dataEncipherment=8]="dataEncipherment",e[e.keyAgreement=16]="keyAgreement",e[e.keyCertSign=32]="keyCertSign",e[e.cRLSign=64]="cRLSign",e[e.encipherOnly=128]="encipherOnly",e[e.decipherOnly=256]="decipherOnly"}(tt||(tt={}));class nt extends K{toJSON(){const e=this.toNumber(),t=[];return e&tt.cRLSign&&t.push("crlSign"),e&tt.dataEncipherment&&t.push("dataEncipherment"),e&tt.decipherOnly&&t.push("decipherOnly"),e&tt.digitalSignature&&t.push("digitalSignature"),e&tt.encipherOnly&&t.push("encipherOnly"),e&tt.keyAgreement&&t.push("keyAgreement"),e&tt.keyCertSign&&t.push("keyCertSign"),e&tt.keyEncipherment&&t.push("keyEncipherment"),e&tt.nonRepudiation&&t.push("nonRepudiation"),t}toString(){return`[${this.toJSON().join(", ")}]`}}class it{constructor(e={}){this.base=new be,this.minimum=0,Object.assign(this,e)}}ie([Q({type:be})],it.prototype,"base",void 0),ie([Q({type:p.Integer,context:0,defaultValue:0,implicit:!0})],it.prototype,"minimum",void 0),ie([Q({type:p.Integer,context:1,optional:!0,implicit:!0})],it.prototype,"maximum",void 0);let ot=rt=class extends re{constructor(e){super(e),Object.setPrototypeOf(this,rt.prototype)}};ot=rt=ie([Y({type:h.Sequence,itemType:it})],ot);class st{constructor(e={}){Object.assign(this,e)}}ie([Q({type:ot,context:0,optional:!0,implicit:!0})],st.prototype,"permittedSubtrees",void 0),ie([Q({type:ot,context:1,optional:!0,implicit:!0})],st.prototype,"excludedSubtrees",void 0);class at{constructor(e={}){Object.assign(this,e)}}ie([Q({type:p.Integer,context:0,implicit:!0,optional:!0,converter:w})],at.prototype,"requireExplicitPolicy",void 0),ie([Q({type:p.Integer,context:1,implicit:!0,optional:!0,converter:w})],at.prototype,"inhibitPolicyMapping",void 0);class ct{constructor(e={}){this.issuerDomainPolicy="",this.subjectDomainPolicy="",Object.assign(this,e)}}var lt;ie([Q({type:p.ObjectIdentifier})],ct.prototype,"issuerDomainPolicy",void 0),ie([Q({type:p.ObjectIdentifier})],ct.prototype,"subjectDomainPolicy",void 0);const ut="2.5.29.17";let ht=lt=class extends Ne{constructor(e){super(e),Object.setPrototypeOf(this,lt.prototype)}};ht=lt=ie([Y({type:h.Sequence})],ht);class pt{constructor(e={}){this.type="",this.values=[],Object.assign(this,e)}}var ft;ie([Q({type:p.ObjectIdentifier})],pt.prototype,"type",void 0),ie([Q({type:p.Any,repeated:"set"})],pt.prototype,"values",void 0);let yt=ft=class extends re{constructor(e){super(e),Object.setPrototypeOf(this,ft.prototype)}};yt=ft=ie([Y({type:h.Sequence,itemType:pt})],yt);const dt="2.5.29.14";class gt extends Se{}class vt{constructor(e={}){Object.assign(this,e)}}var mt;ie([Q({type:p.GeneralizedTime,context:0,implicit:!0,optional:!0})],vt.prototype,"notBefore",void 0),ie([Q({type:p.GeneralizedTime,context:1,implicit:!0,optional:!0})],vt.prototype,"notAfter",void 0),function(e){e[e.keyUpdateAllowed=1]="keyUpdateAllowed",e[e.newExtensions=2]="newExtensions",e[e.pKIXCertificate=4]="pKIXCertificate"}(mt||(mt={}));class bt extends K{toJSON(){const e=[],t=this.toNumber();return t&mt.pKIXCertificate&&e.push("pKIXCertificate"),t&mt.newExtensions&&e.push("newExtensions"),t&mt.keyUpdateAllowed&&e.push("keyUpdateAllowed"),e}toString(){return`[${this.toJSON().join(", ")}]`}}class wt{constructor(e={}){this.entrustVers="",this.entrustInfoFlags=new bt,Object.assign(this,e)}}ie([Q({type:p.GeneralString})],wt.prototype,"entrustVers",void 0),ie([Q({type:bt})],wt.prototype,"entrustInfoFlags",void 0);class Bt{constructor(e={}){this.algorithm="",Object.assign(this,e)}}ie([Q({type:p.ObjectIdentifier})],Bt.prototype,"algorithm",void 0),ie([Q({type:p.Any,optional:!0})],Bt.prototype,"parameters",void 0);class kt{constructor(e={}){this.algorithm=new Bt,this.subjectPublicKey=new ArrayBuffer(0),Object.assign(this,e)}}ie([Q({type:Bt})],kt.prototype,"algorithm",void 0),ie([Q({type:p.BitString})],kt.prototype,"subjectPublicKey",void 0);let At=class{constructor(e){e&&("string"==typeof e||"number"==typeof e?this.utcTime=new Date(e):e instanceof Date?this.utcTime=e:Object.assign(this,e))}getTime(){const e=this.utcTime||this.generalTime;if(!e)throw new Error("Cannot get time from CHOICE object");return e}};ie([Q({type:p.UTCTime})],At.prototype,"utcTime",void 0),ie([Q({type:p.GeneralizedTime})],At.prototype,"generalTime",void 0),At=ie([Y({type:h.Choice})],At);class St{constructor(e){this.notBefore=new At(new Date),this.notAfter=new At(new Date),e&&(this.notBefore=new At(e.notBefore),this.notAfter=new At(e.notAfter))}}var xt;ie([Q({type:At})],St.prototype,"notBefore",void 0),ie([Q({type:At})],St.prototype,"notAfter",void 0);class Ct{constructor(e={}){this.extnID="",this.critical=Ct.CRITICAL,this.extnValue=new J,Object.assign(this,e)}}Ct.CRITICAL=!1,ie([Q({type:p.ObjectIdentifier})],Ct.prototype,"extnID",void 0),ie([Q({type:p.Boolean,defaultValue:Ct.CRITICAL})],Ct.prototype,"critical",void 0),ie([Q({type:J})],Ct.prototype,"extnValue",void 0);let It=xt=class extends re{constructor(e){super(e),Object.setPrototypeOf(this,xt.prototype)}};var Ot;It=xt=ie([Y({type:h.Sequence,itemType:Ct})],It),function(e){e[e.v1=0]="v1",e[e.v2=1]="v2",e[e.v3=2]="v3"}(Ot||(Ot={}));class Nt{constructor(e={}){this.version=Ot.v1,this.serialNumber=new ArrayBuffer(0),this.signature=new Bt,this.issuer=new de,this.validity=new St,this.subject=new de,this.subjectPublicKeyInfo=new kt,Object.assign(this,e)}}ie([Q({type:p.Integer,context:0,defaultValue:Ot.v1})],Nt.prototype,"version",void 0),ie([Q({type:p.Integer,converter:w})],Nt.prototype,"serialNumber",void 0),ie([Q({type:Bt})],Nt.prototype,"signature",void 0),ie([Q({type:de})],Nt.prototype,"issuer",void 0),ie([Q({type:St})],Nt.prototype,"validity",void 0),ie([Q({type:de})],Nt.prototype,"subject",void 0),ie([Q({type:kt})],Nt.prototype,"subjectPublicKeyInfo",void 0),ie([Q({type:p.BitString,context:1,implicit:!0,optional:!0})],Nt.prototype,"issuerUniqueID",void 0),ie([Q({type:p.BitString,context:2,implicit:!0,optional:!0})],Nt.prototype,"subjectUniqueID",void 0),ie([Q({type:It,context:3,optional:!0})],Nt.prototype,"extensions",void 0);class Et{constructor(e={}){this.tbsCertificate=new Nt,this.signatureAlgorithm=new Bt,this.signatureValue=new ArrayBuffer(0),Object.assign(this,e)}}ie([Q({type:Nt})],Et.prototype,"tbsCertificate",void 0),ie([Q({type:Bt})],Et.prototype,"signatureAlgorithm",void 0),ie([Q({type:p.BitString})],Et.prototype,"signatureValue",void 0);class Tt{constructor(e={}){this.userCertificate=new ArrayBuffer(0),this.revocationDate=new At,Object.assign(this,e)}}ie([Q({type:p.Integer,converter:w})],Tt.prototype,"userCertificate",void 0),ie([Q({type:At})],Tt.prototype,"revocationDate",void 0),ie([Q({type:Ct,optional:!0,repeated:"sequence"})],Tt.prototype,"crlEntryExtensions",void 0);class Pt{constructor(e={}){this.signature=new Bt,this.issuer=new de,this.thisUpdate=new At,Object.assign(this,e)}}ie([Q({type:p.Integer,optional:!0})],Pt.prototype,"version",void 0),ie([Q({type:Bt})],Pt.prototype,"signature",void 0),ie([Q({type:de})],Pt.prototype,"issuer",void 0),ie([Q({type:At})],Pt.prototype,"thisUpdate",void 0),ie([Q({type:At,optional:!0})],Pt.prototype,"nextUpdate",void 0),ie([Q({type:Tt,repeated:"sequence",optional:!0})],Pt.prototype,"revokedCertificates",void 0),ie([Q({type:Ct,optional:!0,context:0,repeated:"sequence"})],Pt.prototype,"crlExtensions",void 0);class jt{constructor(e={}){this.tbsCertList=new Pt,this.signatureAlgorithm=new Bt,this.signature=new ArrayBuffer(0),Object.assign(this,e)}}ie([Q({type:Pt})],jt.prototype,"tbsCertList",void 0),ie([Q({type:Bt})],jt.prototype,"signatureAlgorithm",void 0),ie([Q({type:p.BitString})],jt.prototype,"signature",void 0);class Ht{constructor(...e){if(1===e.length){const t=e[0];this.rawData=ne.serialize(t),this.onInit(t)}else{const t=ne.parse(e[0],e[1]);this.rawData=$.toArrayBuffer(e[0]),this.onInit(t)}}equal(e){return e instanceof Ht&&q(e.rawData,this.rawData)}}class Ut extends Ht{constructor(...e){let t;t=$.isBufferSource(e[0])?$.toArrayBuffer(e[0]):ne.serialize(new Ct({extnID:e[0],critical:e[1],extnValue:new J($.toArrayBuffer(e[2]))})),super(t,Ct)}onInit(e){this.type=e.extnID,this.critical=e.critical,this.value=e.extnValue.buffer}}class Rt extends Map{constructor(){super(),"undefined"!=typeof self&&"undefined"!=typeof crypto&&this.set(Rt.DEFAULT,crypto)}static isCryptoKeyPair(e){return e&&e.privateKey&&e.publicKey}static isCryptoKey(e){return e&&e.usages&&e.type&&e.algorithm&&void 0!==e.extractable}get(e=Rt.DEFAULT){const t=super.get(e.toLowerCase());if(!t)throw new Error(`Cannot get Crypto by name '${e}'`);return t}set(e,t){if("string"==typeof e){if(!t)throw new TypeError("Argument 'value' is required");super.set(e.toLowerCase(),t)}else super.set(Rt.DEFAULT,e);return this}}Rt.DEFAULT="default";const Lt=new Rt;var Dt;!function(e){e[e.Transient=0]="Transient",e[e.Singleton=1]="Singleton",e[e.ResolutionScoped=2]="ResolutionScoped",e[e.ContainerScoped=3]="ContainerScoped"}(Dt||(Dt={}));var _t=Dt,Vt=function(e,t){return(Vt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};
/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */function Ft(e,t){function r(){this.constructor=e}Vt(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}function $t(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function zt(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,o=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=o.next()).done;)s.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return s}function Mt(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(zt(arguments[t]));return e}function qt(e){return!!e.useClass}function Kt(e){return!!e.useFactory}var Jt=function(){function e(e){this.wrap=e,this.reflectMethods=["get","getPrototypeOf","setPrototypeOf","getOwnPropertyDescriptor","defineProperty","has","set","deleteProperty","apply","construct"]}return e.prototype.createProxy=function(e){var t,r=this,n=!1;return new Proxy({},this.createHandler((function(){return n||(t=e(r.wrap()),n=!0),t})))},e.prototype.createHandler=function(e){var t={};return this.reflectMethods.forEach((function(r){t[r]=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];t[0]=e();var i=Reflect[r];return i.apply(void 0,Mt(t))}})),t},e}();function Wt(e){return"string"==typeof e||"symbol"==typeof e}function Gt(e){return"object"==typeof e&&"token"in e&&"transform"in e}function Zt(e){return!!e.useToken}function Xt(e){return null!=e.useValue}var Yt=function(){function e(){this._registryMap=new Map}return e.prototype.entries=function(){return this._registryMap.entries()},e.prototype.getAll=function(e){return this.ensure(e),this._registryMap.get(e)},e.prototype.get=function(e){this.ensure(e);var t=this._registryMap.get(e);return t[t.length-1]||null},e.prototype.set=function(e,t){this.ensure(e),this._registryMap.get(e).push(t)},e.prototype.setAll=function(e,t){this._registryMap.set(e,t)},e.prototype.has=function(e){return this.ensure(e),this._registryMap.get(e).length>0},e.prototype.clear=function(){this._registryMap.clear()},e.prototype.ensure=function(e){this._registryMap.has(e)||this._registryMap.set(e,[])},e}(),Qt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Ft(t,e),t}(Yt),er=function(){this.scopedResolutions=new Map};function tr(e,t,r){var n,i,o=zt(e.toString().match(/constructor\(([\w, ]+)\)/)||[],2)[1],s=function(e,t){return null===e?"at position #"+t:'"'+e.split(",")[t].trim()+'" at position #'+t}(void 0===o?null:o,t);return n="Cannot inject the dependency "+s+' of "'+e.name+'" constructor. Reason:',void 0===i&&(i="    "),Mt([n],r.message.split("\n").map((function(e){return i+e}))).join("\n")}var rr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Ft(t,e),t}(Yt),nr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Ft(t,e),t}(Yt),ir=function(){this.preResolution=new rr,this.postResolution=new nr},or=new Map,sr=new(function(){function e(e){this.parent=e,this._registry=new Qt,this.interceptors=new ir}return e.prototype.register=function(e,t,r){var n;if(void 0===r&&(r={lifecycle:_t.Transient}),n=function(e){return qt(e)||Xt(e)||Zt(e)||Kt(e)}(t)?t:{useClass:t},Zt(n))for(var i=[e],o=n;null!=o;){var s=o.useToken;if(i.includes(s))throw new Error("Token registration cycle detected! "+Mt(i,[s]).join(" -> "));i.push(s);var a=this._registry.get(s);o=a&&Zt(a.provider)?a.provider:null}if((r.lifecycle===_t.Singleton||r.lifecycle==_t.ContainerScoped||r.lifecycle==_t.ResolutionScoped)&&(Xt(n)||Kt(n)))throw new Error('Cannot use lifecycle "'+_t[r.lifecycle]+'" with ValueProviders or FactoryProviders');return this._registry.set(e,{provider:n,options:r}),this},e.prototype.registerType=function(e,t){return Wt(t)?this.register(e,{useToken:t}):this.register(e,{useClass:t})},e.prototype.registerInstance=function(e,t){return this.register(e,{useValue:t})},e.prototype.registerSingleton=function(e,t){if(Wt(e)){if(Wt(t))return this.register(e,{useToken:t},{lifecycle:_t.Singleton});if(t)return this.register(e,{useClass:t},{lifecycle:_t.Singleton});throw new Error('Cannot register a type name as a singleton without a "to" token')}var r=e;return t&&!Wt(t)&&(r=t),this.register(e,{useClass:r},{lifecycle:_t.Singleton})},e.prototype.resolve=function(e,t){void 0===t&&(t=new er);var r=this.getRegistration(e);if(!r&&Wt(e))throw new Error('Attempted to resolve unregistered dependency token: "'+e.toString()+'"');if(this.executePreResolutionInterceptor(e,"Single"),r){var n=this.resolveRegistration(r,t);return this.executePostResolutionInterceptor(e,n,"Single"),n}if(function(e){return"function"==typeof e||e instanceof Jt}(e)){n=this.construct(e,t);return this.executePostResolutionInterceptor(e,n,"Single"),n}throw new Error("Attempted to construct an undefined constructor. Could mean a circular dependency problem. Try using `delay` function.")},e.prototype.executePreResolutionInterceptor=function(e,t){var r,n;if(this.interceptors.preResolution.has(e)){var i=[];try{for(var o=$t(this.interceptors.preResolution.getAll(e)),s=o.next();!s.done;s=o.next()){var a=s.value;"Once"!=a.options.frequency&&i.push(a),a.callback(e,t)}}catch(e){r={error:e}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}this.interceptors.preResolution.setAll(e,i)}},e.prototype.executePostResolutionInterceptor=function(e,t,r){var n,i;if(this.interceptors.postResolution.has(e)){var o=[];try{for(var s=$t(this.interceptors.postResolution.getAll(e)),a=s.next();!a.done;a=s.next()){var c=a.value;"Once"!=c.options.frequency&&o.push(c),c.callback(e,t,r)}}catch(e){n={error:e}}finally{try{a&&!a.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}this.interceptors.postResolution.setAll(e,o)}},e.prototype.resolveRegistration=function(e,t){if(e.options.lifecycle===_t.ResolutionScoped&&t.scopedResolutions.has(e))return t.scopedResolutions.get(e);var r,n=e.options.lifecycle===_t.Singleton,i=e.options.lifecycle===_t.ContainerScoped,o=n||i;return r=Xt(e.provider)?e.provider.useValue:Zt(e.provider)?o?e.instance||(e.instance=this.resolve(e.provider.useToken,t)):this.resolve(e.provider.useToken,t):qt(e.provider)?o?e.instance||(e.instance=this.construct(e.provider.useClass,t)):this.construct(e.provider.useClass,t):Kt(e.provider)?e.provider.useFactory(this):this.construct(e.provider,t),e.options.lifecycle===_t.ResolutionScoped&&t.scopedResolutions.set(e,r),r},e.prototype.resolveAll=function(e,t){var r=this;void 0===t&&(t=new er);var n=this.getAllRegistrations(e);if(!n&&Wt(e))throw new Error('Attempted to resolve unregistered dependency token: "'+e.toString()+'"');if(this.executePreResolutionInterceptor(e,"All"),n){var i=n.map((function(e){return r.resolveRegistration(e,t)}));return this.executePostResolutionInterceptor(e,i,"All"),i}var o=[this.construct(e,t)];return this.executePostResolutionInterceptor(e,o,"All"),o},e.prototype.isRegistered=function(e,t){return void 0===t&&(t=!1),this._registry.has(e)||t&&(this.parent||!1)&&this.parent.isRegistered(e,!0)},e.prototype.reset=function(){this._registry.clear(),this.interceptors.preResolution.clear(),this.interceptors.postResolution.clear()},e.prototype.clearInstances=function(){var e,t;try{for(var r=$t(this._registry.entries()),n=r.next();!n.done;n=r.next()){var i=zt(n.value,2),o=i[0],s=i[1];this._registry.setAll(o,s.filter((function(e){return!Xt(e.provider)})).map((function(e){return e.instance=void 0,e})))}}catch(t){e={error:t}}finally{try{n&&!n.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}},e.prototype.createChildContainer=function(){var t,r,n=new e(this);try{for(var i=$t(this._registry.entries()),o=i.next();!o.done;o=i.next()){var s=zt(o.value,2),a=s[0],c=s[1];c.some((function(e){return e.options.lifecycle===_t.ContainerScoped}))&&n._registry.setAll(a,c.map((function(e){return e.options.lifecycle===_t.ContainerScoped?{provider:e.provider,options:e.options}:e})))}}catch(e){t={error:e}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}return n},e.prototype.beforeResolution=function(e,t,r){void 0===r&&(r={frequency:"Always"}),this.interceptors.preResolution.set(e,{callback:t,options:r})},e.prototype.afterResolution=function(e,t,r){void 0===r&&(r={frequency:"Always"}),this.interceptors.postResolution.set(e,{callback:t,options:r})},e.prototype.getRegistration=function(e){return this.isRegistered(e)?this._registry.get(e):this.parent?this.parent.getRegistration(e):null},e.prototype.getAllRegistrations=function(e){return this.isRegistered(e)?this._registry.getAll(e):this.parent?this.parent.getAllRegistrations(e):null},e.prototype.construct=function(e,t){var r=this;if(e instanceof Jt)return e.createProxy((function(e){return r.resolve(e,t)}));var n=or.get(e);if(!n||0===n.length){if(0===e.length)return new e;throw new Error('TypeInfo not known for "'+e.name+'"')}var i=n.map(this.resolveParams(t,e));return new(e.bind.apply(e,Mt([void 0],i)))},e.prototype.resolveParams=function(e,t){var r=this;return function(n,i){var o,s,a,c;try{return"object"==typeof(c=n)&&"token"in c&&"multiple"in c?Gt(n)?n.multiple?(o=r.resolve(n.transform)).transform.apply(o,Mt([r.resolveAll(n.token)],n.transformArgs)):(s=r.resolve(n.transform)).transform.apply(s,Mt([r.resolve(n.token,e)],n.transformArgs)):n.multiple?r.resolveAll(n.token):r.resolve(n.token,e):Gt(n)?(a=r.resolve(n.transform,e)).transform.apply(a,Mt([r.resolve(n.token,e)],n.transformArgs)):r.resolve(n,e)}catch(e){throw new Error(tr(t,i,e))}}},e}());function ar(){return function(e){or.set(e,function(e){var t=Reflect.getMetadata("design:paramtypes",e)||[],r=Reflect.getOwnMetadata("injectionTokens",e)||{};return Object.keys(r).forEach((function(e){t[+e]=r[e]})),t}(e))}}if("undefined"==typeof Reflect||!Reflect.getMetadata)throw new Error("tsyringe requires a reflect polyfill. Please add 'import \"reflect-metadata\"' to the top of your entry point.");class cr{constructor(){this.items={}}get(e){return this.items[e]||null}register(e,t){this.items[e]=t,this.items[t]=e}}const lr=new cr;function ur(e,t){return`\\${M.ToHex(M.FromUtf8String(t)).toUpperCase()}`}lr.register("CN","2.5.4.3"),lr.register("L","2.5.4.7"),lr.register("ST","2.5.4.8"),lr.register("O","2.5.4.10"),lr.register("OU","2.5.4.11"),lr.register("C","2.5.4.6"),lr.register("DC","0.9.2342.19200300.100.1.25"),lr.register("E","1.2.840.113549.1.9.1"),lr.register("G","2.5.4.42"),lr.register("I","2.5.4.43"),lr.register("SN","2.5.4.4"),lr.register("T","2.5.4.12");class hr{constructor(e,t={}){this.extraNames=new cr,this.asn=new de;for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e)){const r=t[e];this.extraNames.register(e,r)}"string"==typeof e?this.asn=this.fromString(e):e instanceof de?this.asn=e:$.isBufferSource(e)?this.asn=ne.parse(e,de):this.asn=this.fromJSON(e)}getName(e){return this.extraNames.get(e)||lr.get(e)}toString(){return this.asn.map((e=>e.map((e=>`${this.getName(e.type)||e.type}=${e.value.anyValue?`#${M.ToHex(e.value.anyValue)}`:e.value.toString().replace(/([,+"\\<>;])/g,"\\$1").replace(/^([ #])/,"\\$1").replace(/([ ]$)/,"\\$1").replace(/([\r\n\t])/,ur)}`)).join("+"))).join(", ")}toJSON(){var e;const t=[];for(const r of this.asn){const n={};for(const t of r){const r=this.getName(t.type)||t.type;null!==(e=n[r])&&void 0!==e||(n[r]=[]),n[r].push(t.value.anyValue?`#${M.ToHex(t.value.anyValue)}`:t.value.toString())}t.push(n)}return t}fromString(e){const t=new de,r=/(\d\.[\d.]*\d|[A-Za-z]+)=((?:"")|(?:".*?[^\\]")|(?:[^,+].*?(?:[^\\][,+]))|(?:))([,+])?/g;let n=null,i=",";for(;n=r.exec(`${e},`);){let[,e,r]=n;const o=r[r.length-1];","!==o&&"+"!==o||(r=r.slice(0,r.length-1),n[3]=o);const s=n[3];if(/[\d.]+/.test(e)||(e=this.getName(e)||""),!e)throw new Error(`Cannot get OID for name type '${e}'`);const a=new pe({type:e});if("#"===r.charAt(0))a.value.anyValue=M.FromHex(r.slice(1));else{const t=/"(.*?[^\\])?"/.exec(r);t&&(r=t[1]),r=r.replace(/\\0a/gi,"\n").replace(/\\0d/gi,"\r").replace(/\\0g/gi,"\t").replace(/\\(.)/g,"$1"),e===this.getName("E")||e===this.getName("DC")?a.value.ia5String=r:a.value.printableString=r}"+"===i?t[t.length-1].push(a):t.push(new fe([a])),i=s}return t}fromJSON(e){const t=new de;for(const r of e){const e=new fe;for(const t in r){let n=t;if(/[\d.]+/.test(t)||(n=this.getName(t)||""),!n)throw new Error(`Cannot get OID for name type '${t}'`);const i=r[t];for(const t of i){const r=new pe({type:n});"#"===t[0]?r.value.anyValue=M.FromHex(t.slice(1)):n===this.getName("E")||n===this.getName("DC")?r.value.ia5String=t:r.value.printableString=t,e.push(r)}}t.push(e)}return t}toArrayBuffer(){return ne.serialize(this.asn)}}class pr{static register(e,t){this.items.set(e,t)}static create(e){const t=new Ut(e),r=this.items.get(t.type);return r?new r(e):t}}pr.items=new Map;const fr="1.2.840.113549.1.1",yr=`${fr}.1`,dr=`${fr}.7`,gr=`${fr}.9`,vr=`${fr}.10`,mr=`${fr}.2`,br=`${fr}.4`,wr=`${fr}.5`,Br=`${fr}.11`,kr=`${fr}.12`,Ar=`${fr}.13`,Sr=`${fr}.15`,xr=`${fr}.16`,Cr=`${fr}.8`;function Ir(e){return new Bt({algorithm:e,parameters:null})}Ir("1.2.840.113549.2.2"),Ir("1.2.840.113549.2.5");const Or=Ir("1.3.14.3.2.26");Ir("2.16.840.1.101.3.4.2.4"),Ir("2.16.840.1.101.3.4.2.1"),Ir("2.16.840.1.101.3.4.2.2"),Ir("2.16.840.1.101.3.4.2.3"),Ir("2.16.840.1.101.3.4.2.5"),Ir("2.16.840.1.101.3.4.2.6");const Nr=new Bt({algorithm:Cr,parameters:ne.serialize(Or)}),Er=new Bt({algorithm:gr,parameters:ne.serialize(S.toASN(new Uint8Array([218,57,163,238,94,107,75,13,50,85,191,239,149,96,24,144,175,216,7,9]).buffer))});Ir(yr),Ir(mr),Ir(br),Ir(wr),Ir(Sr),Ir(xr),Ir(kr),Ir(Ar),Ir(Sr),Ir(xr);class Tr{constructor(e={}){this.hashAlgorithm=new Bt(Or),this.maskGenAlgorithm=new Bt({algorithm:Cr,parameters:ne.serialize(Or)}),this.pSourceAlgorithm=new Bt(Er),Object.assign(this,e)}}ie([Q({type:Bt,context:0,defaultValue:Or})],Tr.prototype,"hashAlgorithm",void 0),ie([Q({type:Bt,context:1,defaultValue:Nr})],Tr.prototype,"maskGenAlgorithm",void 0),ie([Q({type:Bt,context:2,defaultValue:Er})],Tr.prototype,"pSourceAlgorithm",void 0),new Bt({algorithm:dr,parameters:ne.serialize(new Tr)});class Pr{constructor(e={}){this.hashAlgorithm=new Bt(Or),this.maskGenAlgorithm=new Bt({algorithm:Cr,parameters:ne.serialize(Or)}),this.saltLength=20,this.trailerField=1,Object.assign(this,e)}}ie([Q({type:Bt,context:0,defaultValue:Or})],Pr.prototype,"hashAlgorithm",void 0),ie([Q({type:Bt,context:1,defaultValue:Nr})],Pr.prototype,"maskGenAlgorithm",void 0),ie([Q({type:p.Integer,context:2,defaultValue:20})],Pr.prototype,"saltLength",void 0),ie([Q({type:p.Integer,context:3,defaultValue:1})],Pr.prototype,"trailerField",void 0),new Bt({algorithm:vr,parameters:ne.serialize(new Pr)});class jr{constructor(e={}){this.digestAlgorithm=new Bt,this.digest=new J,Object.assign(this,e)}}var Hr;ie([Q({type:Bt})],jr.prototype,"digestAlgorithm",void 0),ie([Q({type:J})],jr.prototype,"digest",void 0);class Ur{constructor(e={}){this.prime=new ArrayBuffer(0),this.exponent=new ArrayBuffer(0),this.coefficient=new ArrayBuffer(0),Object.assign(this,e)}}ie([Q({type:p.Integer,converter:w})],Ur.prototype,"prime",void 0),ie([Q({type:p.Integer,converter:w})],Ur.prototype,"exponent",void 0),ie([Q({type:p.Integer,converter:w})],Ur.prototype,"coefficient",void 0);let Rr=Hr=class extends re{constructor(e){super(e),Object.setPrototypeOf(this,Hr.prototype)}};Rr=Hr=ie([Y({type:h.Sequence,itemType:Ur})],Rr);class Lr{constructor(e={}){this.version=0,this.modulus=new ArrayBuffer(0),this.publicExponent=new ArrayBuffer(0),this.privateExponent=new ArrayBuffer(0),this.prime1=new ArrayBuffer(0),this.prime2=new ArrayBuffer(0),this.exponent1=new ArrayBuffer(0),this.exponent2=new ArrayBuffer(0),this.coefficient=new ArrayBuffer(0),Object.assign(this,e)}}ie([Q({type:p.Integer})],Lr.prototype,"version",void 0),ie([Q({type:p.Integer,converter:w})],Lr.prototype,"modulus",void 0),ie([Q({type:p.Integer,converter:w})],Lr.prototype,"publicExponent",void 0),ie([Q({type:p.Integer,converter:w})],Lr.prototype,"privateExponent",void 0),ie([Q({type:p.Integer,converter:w})],Lr.prototype,"prime1",void 0),ie([Q({type:p.Integer,converter:w})],Lr.prototype,"prime2",void 0),ie([Q({type:p.Integer,converter:w})],Lr.prototype,"exponent1",void 0),ie([Q({type:p.Integer,converter:w})],Lr.prototype,"exponent2",void 0),ie([Q({type:p.Integer,converter:w})],Lr.prototype,"coefficient",void 0),ie([Q({type:Rr,optional:!0})],Lr.prototype,"otherPrimeInfos",void 0);class Dr{constructor(e={}){this.modulus=new ArrayBuffer(0),this.publicExponent=new ArrayBuffer(0),Object.assign(this,e)}}ie([Q({type:p.Integer,converter:w})],Dr.prototype,"modulus",void 0),ie([Q({type:p.Integer,converter:w})],Dr.prototype,"publicExponent",void 0);const _r="crypto.algorithm";class Vr{getAlgorithms(){return sr.resolveAll(_r)}toAsnAlgorithm(e){for(const t of this.getAlgorithms()){const r=t.toAsnAlgorithm(e);if(r)return r}throw new Error("Cannot convert WebCrypto algorithm to ASN.1 algorithm")}toWebAlgorithm(e){for(const t of this.getAlgorithms()){const r=t.toWebAlgorithm(e);if(r)return r}throw new Error("Cannot convert ASN.1 algorithm to WebCrypto algorithm")}}const Fr="crypto.algorithmProvider";sr.registerSingleton(Fr,Vr);class $r{constructor(){this.CertificateTag="CERTIFICATE",this.CertificateRequestTag="CERTIFICATE REQUEST",this.PublicKeyTag="PUBLIC KEY",this.PrivateKeyTag="PRIVATE KEY"}static isPem(e){return"string"==typeof e&&/-{5}BEGIN [A-Z0-9 ]+-{5}([a-zA-Z0-9=+/\n\r]+)-{5}END [A-Z0-9 ]+-{5}/g.test(e)}static decode(e){const t=/-{5}BEGIN [A-Z0-9 ]+-{5}([a-zA-Z0-9=+/\n\r]+)-{5}END [A-Z0-9 ]+-{5}/g,r=[];let n=null;for(;n=t.exec(e);){const e=n[1].replace(/\r/g,"").replace(/\n/g,"");r.push(M.FromBase64(e))}return r}static encode(e,t){if(Array.isArray(e)){const r=new Array;return e.forEach((e=>{r.push(this.encodeBuffer(e,t))})),r.join("\n")}return this.encodeBuffer(e,t)}static encodeBuffer(e,t){const r=M.ToBase64(e);let n,i=0;const o=Array();for(;i<r.length&&(r.length-i<64?n=r.substring(i):(n=r.substring(i,i+64),i+=64),0!==n.length)&&(o.push(n),!(n.length<64)););const s=t.toLocaleUpperCase();return`-----BEGIN ${s}-----\n${o.join("\n")}\n-----END ${s}-----`}}class zr extends Ht{static isAsnEncoded(e){return $.isBufferSource(e)||"string"==typeof e}static toArrayBuffer(e){if("string"==typeof e){if($r.isPem(e))return $r.decode(e)[0];if(M.isHex(e))return M.FromHex(e);if(M.isBase64(e))return M.FromBase64(e);if(M.isBase64Url(e))return M.FromBase64Url(e);throw new TypeError("Unsupported format of 'raw' argument. Must be one of DER, PEM, HEX, Base64, or Base4Url")}return e}constructor(...e){zr.isAsnEncoded(e[0])?super(zr.toArrayBuffer(e[0]),e[1]):super(e[0])}toString(e="pem"){switch(e){case"pem":return $r.encode(this.rawData,this.tag);case"hex":return M.ToHex(this.rawData);case"base64":return M.ToBase64(this.rawData);case"base64url":return M.ToBase64Url(this.rawData);default:throw TypeError("Argument 'format' is unsupported value")}}}class Mr extends zr{constructor(e){zr.isAsnEncoded(e)?super(e,kt):super(e),this.tag="PUBLIC KEY"}async export(...e){let t,r=["verify"],n={hash:"SHA-256",...this.algorithm};return e.length>1?(n=e[0]||n,r=e[1]||r,t=e[2]||Lt.get()):t=e[0]||Lt.get(),t.subtle.importKey("spki",this.rawData,n,!0,r)}onInit(e){const t=sr.resolve(Fr),r=this.algorithm=t.toWebAlgorithm(e.algorithm);switch(e.algorithm.algorithm){case yr:{const t=ne.parse(e.subjectPublicKey,Dr),n=$.toUint8Array(t.modulus);r.publicExponent=$.toUint8Array(t.publicExponent),r.modulusLength=(n[0]?n:n.slice(1)).byteLength<<3;break}}}async getThumbprint(...e){var t;let r,n="SHA-1";return e.length>=1&&!(null===(t=e[0])||void 0===t?void 0:t.subtle)?(n=e[0]||n,r=e[1]||Lt.get()):r=e[0]||Lt.get(),await r.subtle.digest(n,this.rawData)}}const qr="crypto.signatureFormatter";class Kr{toAsnSignature(e,t){return $.toArrayBuffer(t)}toWebSignature(e,t){return $.toArrayBuffer(t)}}class Jr extends zr{constructor(e){zr.isAsnEncoded(e)?super(e,Et):super(e),this.tag="CERTIFICATE"}onInit(e){const t=e.tbsCertificate;this.tbs=ne.serialize(t),this.serialNumber=M.ToHex(t.serialNumber),this.subject=new hr(t.subject).toString(),this.issuer=new hr(t.issuer).toString();const r=sr.resolve(Fr);this.signatureAlgorithm=r.toWebAlgorithm(e.signatureAlgorithm),this.signature=e.signatureValue;const n=t.validity.notBefore.utcTime||t.validity.notBefore.generalTime;if(!n)throw new Error("Cannot get 'notBefore' value");this.notBefore=n;const i=t.validity.notAfter.utcTime||t.validity.notAfter.generalTime;if(!i)throw new Error("Cannot get 'notAfter' value");this.notAfter=i,this.extensions=[],t.extensions&&(this.extensions=t.extensions.map((e=>pr.create(ne.serialize(e))))),this.publicKey=new Mr(t.subjectPublicKeyInfo)}getExtension(e){for(const t of this.extensions)if("string"==typeof e){if(t.type===e)return t}else if(t instanceof e)return t;return null}getExtensions(e){return this.extensions.filter((t=>"string"==typeof e?t.type===e:t instanceof e))}async verify(e={},t=Lt.get()){let r,n;const i=e.publicKey;try{i?i instanceof Jr?(r={...i.publicKey.algorithm,...this.signatureAlgorithm},n=await i.publicKey.export(r,["verify"])):i instanceof Mr?(r={...i.algorithm,...this.signatureAlgorithm},n=await i.export(r,["verify"])):(r={...i.algorithm,...this.signatureAlgorithm},n=i):(r={...this.publicKey.algorithm,...this.signatureAlgorithm},n=await this.publicKey.export(r,["verify"],t))}catch(e){return!1}const o=sr.resolveAll(qr).reverse();let s=null;for(const e of o)if(s=e.toWebSignature(r,this.signature),s)break;if(!s)throw Error("Cannot convert ASN.1 signature value to WebCrypto format");const a=await t.subtle.verify(this.signatureAlgorithm,n,s,this.tbs);if(e.signatureOnly)return a;{const t=(e.date||new Date).getTime();return a&&this.notBefore.getTime()<t&&t<this.notAfter.getTime()}}async getThumbprint(...e){let t,r="SHA-1";return e[0]&&(e[0].subtle?t=e[0]:(r=e[0]||r,t=e[1])),null!=t||(t=Lt.get()),await t.subtle.digest(r,this.rawData)}async isSelfSigned(){return this.subject===this.issuer&&await this.verify({signatureOnly:!0})}}class Wr extends Ut{constructor(...e){if($.isBufferSource(e[0]))super(e[0]);else if("string"==typeof e[0]){const t=new xe({keyIdentifier:new J(M.FromHex(e[0]))});super(Ae,e[1],ne.serialize(t))}else{const t=e[0],r=new xe({authorityCertIssuer:t.name,authorityCertSerialNumber:M.FromHex(t.serialNumber)});super(Ae,e[1],ne.serialize(r))}}static async create(e,t=!1,r=Lt.get()){if(e instanceof Jr||Rt.isCryptoKey(e)){const n=e instanceof Jr?await e.publicKey.export(r):e,i=await r.subtle.exportKey("spki",n),o=await r.subtle.digest("SHA-1",i);return new Wr(M.ToHex(o),t)}return new Wr(e,t)}onInit(e){super.onInit(e);const t=ne.parse(e.extnValue,xe);t.keyIdentifier&&(this.keyId=M.ToHex(t.keyIdentifier)),t.authorityCertIssuer&&t.authorityCertSerialNumber&&(this.certId={name:t.authorityCertIssuer,serialNumber:M.ToHex(t.authorityCertSerialNumber)})}}class Gr extends Ut{constructor(...e){if($.isBufferSource(e[0])){super(e[0]);const t=ne.parse(this.value,Ie);this.ca=t.cA,this.pathLength=t.pathLenConstraint}else{const t=new Ie({cA:e[0],pathLenConstraint:e[1]});super(Ce,e[2],ne.serialize(t)),this.ca=e[0],this.pathLength=e[1]}}}class Zr extends Ut{constructor(...e){if($.isBufferSource(e[0])){super(e[0]);const t=ne.parse(this.value,Ge);this.usages=t.map((e=>e))}else{const t=new Ge(e[0]);super(We,e[1],ne.serialize(t)),this.usages=e[0]}}}e.KeyUsageFlags=void 0,function(e){e[e.digitalSignature=1]="digitalSignature",e[e.nonRepudiation=2]="nonRepudiation",e[e.keyEncipherment=4]="keyEncipherment",e[e.dataEncipherment=8]="dataEncipherment",e[e.keyAgreement=16]="keyAgreement",e[e.keyCertSign=32]="keyCertSign",e[e.cRLSign=64]="cRLSign",e[e.encipherOnly=128]="encipherOnly",e[e.decipherOnly=256]="decipherOnly"}(e.KeyUsageFlags||(e.KeyUsageFlags={}));class Xr extends Ut{constructor(...e){if($.isBufferSource(e[0])){super(e[0]);const t=ne.parse(this.value,nt);this.usages=t.toNumber()}else{const t=new nt(e[0]);super(et,e[1],ne.serialize(t)),this.usages=e[0]}}}class Yr extends Ut{constructor(...e){if($.isBufferSource(e[0])){super(e[0]);const t=ne.parse(this.value,gt);this.keyId=M.ToHex(t)}else{const t="string"==typeof e[0]?M.FromHex(e[0]):e[0],r=new gt(t);super(dt,e[1],ne.serialize(r)),this.keyId=M.ToHex(t)}}static async create(e,t=!1,r=Lt.get()){const n=await r.subtle.exportKey("spki",e),i=await r.subtle.digest("SHA-1",n);return new Yr(M.ToHex(i),t)}}class Qr extends Ht{constructor(...e){let t;if($.isBufferSource(e[0]))t=$.toArrayBuffer(e[0]);else{const r=e[0],n=$.toArrayBuffer(e[1]);t=ne.serialize(new ve({typeId:r,value:n}))}super(t,ve)}onInit(e){this.type=e.typeId,this.value=e.value}toJSON(){return{type:this.type,value:M.ToHex(this.value)}}}class en extends Ut{constructor(...e){if($.isBufferSource(e[0]))super(e[0]);else{const t=e[0]||{},r=new ht;for(const e of t.dns||[])r.push(new be({dNSName:e}));for(const e of t.email||[])r.push(new be({rfc822Name:e}));for(const e of t.guid||[]){const t=/([0-9a-f]{8})-?([0-9a-f]{4})-?([0-9a-f]{4})-?([0-9a-f]{4})-?([0-9a-f]{12})/i.exec(e);if(!t)throw new Error("Cannot parse GUID value. Value doesn't match to regular expression");const n=t.slice(1).map(((e,t)=>t<3?M.ToHex(new Uint8Array(M.FromHex(e)).reverse()):e)).join("");r.push(new be({otherName:new ve({typeId:en.GUID,value:ne.serialize(new J(M.FromHex(n)))})}))}for(const e of t.ip||[])r.push(new be({iPAddress:e}));for(const e of t.url||[])r.push(new be({uniformResourceIdentifier:e}));for(const e of t.upn||[])r.push(new be({otherName:new ve({typeId:en.UPN,value:ne.serialize(C.toASN(e))})}));for(const e of t.registeredId||[])r.push(new be({registeredID:e}));for(const e of t.otherName||[])r.push(new be({otherName:new ve({typeId:e.type,value:M.FromHex(e.value)})}));super(ut,e[1],ne.serialize(r))}}onInit(e){super.onInit(e);const t=ne.parse(e.extnValue,ht);this.dns=t.filter((e=>e.dNSName)).map((e=>e.dNSName||"")),this.email=t.filter((e=>e.rfc822Name)).map((e=>e.rfc822Name||"")),this.ip=t.filter((e=>e.iPAddress)).map((e=>e.iPAddress||"")),this.url=t.filter((e=>e.uniformResourceIdentifier)).map((e=>e.uniformResourceIdentifier||"")),this.upn=t.filter((e=>{var t;return(null===(t=e.otherName)||void 0===t?void 0:t.typeId)===en.UPN})).map((e=>e.otherName?ne.parse(e.otherName.value,ue).toString():"")),this.guid=t.filter((e=>{var t;return(null===(t=e.otherName)||void 0===t?void 0:t.typeId)===en.GUID})).map((e=>e.otherName?ne.parse(e.otherName.value,J):new J)).map((e=>{const t=/([0-9a-f]{8})-?([0-9a-f]{4})-?([0-9a-f]{4})-?([0-9a-f]{4})-?([0-9a-f]{12})/i.exec(M.ToHex(e));if(!t)throw new Error("Cannot parse GUID value. Value doesn't match to regular expression");return`{${t.slice(1).map(((e,t)=>t<3?M.ToHex(new Uint8Array(M.FromHex(e)).reverse()):e)).join("-")}}`})),this.registeredId=t.filter((e=>e.registeredID)).map((e=>e.registeredID||"")),this.otherNames=t.filter((e=>e.otherName&&![en.GUID,en.UPN].includes(e.otherName.typeId))).map((e=>new Qr(e.otherName.typeId,e.otherName.value)))}toJSON(){const e={};return this.dns.length&&(e.dns=[...this.dns]),this.email.length&&(e.email=[...this.email]),this.ip.length&&(e.ip=[...this.ip]),this.guid.length&&(e.guid=[...this.guid]),this.upn.length&&(e.upn=[...this.upn]),this.url.length&&(e.url=[...this.url]),this.registeredId.length&&(e.registeredId=[...this.registeredId]),this.otherNames.length&&(e.otherName=this.otherNames.map((e=>e.toJSON()))),e}}en.GUID="1.3.6.1.4.1.311.25.1",en.UPN="1.3.6.1.4.1.311.20.2.3";class tn{constructor(e={}){this.attrType="",this.attrValues=[],Object.assign(this,e)}}ie([Q({type:p.ObjectIdentifier})],tn.prototype,"attrType",void 0),ie([Q({type:p.Any,repeated:"set"})],tn.prototype,"attrValues",void 0);class rn{constructor(e={}){this.acIssuer=new be,this.acSerial=0,this.attrs=[],Object.assign(this,e)}}var nn;ie([Q({type:be})],rn.prototype,"acIssuer",void 0),ie([Q({type:p.Integer})],rn.prototype,"acSerial",void 0),ie([Q({type:pt,repeated:"sequence"})],rn.prototype,"attrs",void 0);let on=nn=class extends re{constructor(e){super(e),Object.setPrototypeOf(this,nn.prototype)}};on=nn=ie([Y({type:h.Sequence,itemType:p.ObjectIdentifier})],on);class sn{constructor(e={}){this.permitUnSpecified=!0,Object.assign(this,e)}}ie([Q({type:p.Integer,optional:!0})],sn.prototype,"pathLenConstraint",void 0),ie([Q({type:on,implicit:!0,context:0,optional:!0})],sn.prototype,"permittedAttrs",void 0),ie([Q({type:on,implicit:!0,context:1,optional:!0})],sn.prototype,"excludedAttrs",void 0),ie([Q({type:p.Boolean,defaultValue:!0})],sn.prototype,"permitUnSpecified",void 0);class an{constructor(e={}){this.issuer=new Ne,this.serial=new ArrayBuffer(0),this.issuerUID=new ArrayBuffer(0),Object.assign(this,e)}}var cn;ie([Q({type:Ne})],an.prototype,"issuer",void 0),ie([Q({type:p.Integer,converter:w})],an.prototype,"serial",void 0),ie([Q({type:p.BitString,optional:!0})],an.prototype,"issuerUID",void 0),function(e){e[e.publicKey=0]="publicKey",e[e.publicKeyCert=1]="publicKeyCert",e[e.otherObjectTypes=2]="otherObjectTypes"}(cn||(cn={}));class ln{constructor(e={}){this.digestedObjectType=cn.publicKey,this.digestAlgorithm=new Bt,this.objectDigest=new ArrayBuffer(0),Object.assign(this,e)}}ie([Q({type:p.Enumerated})],ln.prototype,"digestedObjectType",void 0),ie([Q({type:p.ObjectIdentifier,optional:!0})],ln.prototype,"otherObjectTypeID",void 0),ie([Q({type:Bt})],ln.prototype,"digestAlgorithm",void 0),ie([Q({type:p.BitString})],ln.prototype,"objectDigest",void 0);class un{constructor(e={}){Object.assign(this,e)}}ie([Q({type:Ne,optional:!0})],un.prototype,"issuerName",void 0),ie([Q({type:an,context:0,implicit:!0,optional:!0})],un.prototype,"baseCertificateID",void 0),ie([Q({type:ln,context:1,implicit:!0,optional:!0})],un.prototype,"objectDigestInfo",void 0);let hn=class{constructor(e={}){Object.assign(this,e)}};ie([Q({type:be,repeated:"sequence"})],hn.prototype,"v1Form",void 0),ie([Q({type:un,context:0,implicit:!0})],hn.prototype,"v2Form",void 0),hn=ie([Y({type:h.Choice})],hn);class pn{constructor(e={}){this.notBeforeTime=new Date,this.notAfterTime=new Date,Object.assign(this,e)}}ie([Q({type:p.GeneralizedTime})],pn.prototype,"notBeforeTime",void 0),ie([Q({type:p.GeneralizedTime})],pn.prototype,"notAfterTime",void 0);class fn{constructor(e={}){Object.assign(this,e)}}var yn,dn,gn;ie([Q({type:an,implicit:!0,context:0,optional:!0})],fn.prototype,"baseCertificateID",void 0),ie([Q({type:Ne,implicit:!0,context:1,optional:!0})],fn.prototype,"entityName",void 0),ie([Q({type:ln,implicit:!0,context:2,optional:!0})],fn.prototype,"objectDigestInfo",void 0),function(e){e[e.v2=1]="v2"}(yn||(yn={}));class vn{constructor(e={}){this.version=yn.v2,this.holder=new fn,this.issuer=new hn,this.signature=new Bt,this.serialNumber=new ArrayBuffer(0),this.attrCertValidityPeriod=new pn,this.attributes=[],Object.assign(this,e)}}ie([Q({type:p.Integer})],vn.prototype,"version",void 0),ie([Q({type:fn})],vn.prototype,"holder",void 0),ie([Q({type:hn})],vn.prototype,"issuer",void 0),ie([Q({type:Bt})],vn.prototype,"signature",void 0),ie([Q({type:p.Integer,converter:w})],vn.prototype,"serialNumber",void 0),ie([Q({type:pn})],vn.prototype,"attrCertValidityPeriod",void 0),ie([Q({type:pt,repeated:"sequence"})],vn.prototype,"attributes",void 0),ie([Q({type:p.BitString,optional:!0})],vn.prototype,"issuerUniqueID",void 0),ie([Q({type:It,optional:!0})],vn.prototype,"extensions",void 0);class mn{constructor(e={}){this.acinfo=new vn,this.signatureAlgorithm=new Bt,this.signatureValue=new ArrayBuffer(0),Object.assign(this,e)}}ie([Q({type:vn})],mn.prototype,"acinfo",void 0),ie([Q({type:Bt})],mn.prototype,"signatureAlgorithm",void 0),ie([Q({type:p.BitString})],mn.prototype,"signatureValue",void 0),function(e){e[e.unmarked=1]="unmarked",e[e.unclassified=2]="unclassified",e[e.restricted=4]="restricted",e[e.confidential=8]="confidential",e[e.secret=16]="secret",e[e.topSecret=32]="topSecret"}(dn||(dn={}));class bn extends K{}class wn{constructor(e={}){this.type="",this.value=new ArrayBuffer(0),Object.assign(this,e)}}ie([Q({type:p.ObjectIdentifier,implicit:!0,context:0})],wn.prototype,"type",void 0),ie([Q({type:p.Any,implicit:!0,context:1})],wn.prototype,"value",void 0);class Bn{constructor(e={}){this.policyId="",this.classList=new bn(dn.unclassified),Object.assign(this,e)}}ie([Q({type:p.ObjectIdentifier})],Bn.prototype,"policyId",void 0),ie([Q({type:bn,defaultValue:new bn(dn.unclassified)})],Bn.prototype,"classList",void 0),ie([Q({type:wn,repeated:"set"})],Bn.prototype,"securityCategories",void 0);class kn{constructor(e={}){Object.assign(this,e)}}ie([Q({type:J})],kn.prototype,"cotets",void 0),ie([Q({type:p.ObjectIdentifier})],kn.prototype,"oid",void 0),ie([Q({type:p.Utf8String})],kn.prototype,"string",void 0);class An{constructor(e={}){this.values=[],Object.assign(this,e)}}ie([Q({type:Ne,implicit:!0,context:0,optional:!0})],An.prototype,"policyAuthority",void 0),ie([Q({type:kn,repeated:"sequence"})],An.prototype,"values",void 0);class Sn{constructor(e={}){this.targetCertificate=new an,Object.assign(this,e)}}ie([Q({type:an})],Sn.prototype,"targetCertificate",void 0),ie([Q({type:be,optional:!0})],Sn.prototype,"targetName",void 0),ie([Q({type:ln,optional:!0})],Sn.prototype,"certDigestInfo",void 0);let xn=class{constructor(e={}){Object.assign(this,e)}};ie([Q({type:be,context:0,implicit:!0})],xn.prototype,"targetName",void 0),ie([Q({type:be,context:1,implicit:!0})],xn.prototype,"targetGroup",void 0),ie([Q({type:Sn,context:2,implicit:!0})],xn.prototype,"targetCert",void 0),xn=ie([Y({type:h.Choice})],xn);let Cn=gn=class extends re{constructor(e){super(e),Object.setPrototypeOf(this,gn.prototype)}};var In;Cn=gn=ie([Y({type:h.Sequence,itemType:xn})],Cn);let On=In=class extends re{constructor(e){super(e),Object.setPrototypeOf(this,In.prototype)}};On=In=ie([Y({type:h.Sequence,itemType:Cn})],On);class Nn{constructor(e={}){Object.assign(this,e)}}ie([Q({type:Ne,implicit:!0,context:0,optional:!0})],Nn.prototype,"roleAuthority",void 0),ie([Q({type:be,implicit:!0,context:1})],Nn.prototype,"roleName",void 0);class En{constructor(e={}){this.service=new be,this.ident=new be,Object.assign(this,e)}}var Tn;ie([Q({type:be})],En.prototype,"service",void 0),ie([Q({type:be})],En.prototype,"ident",void 0),ie([Q({type:J,optional:!0})],En.prototype,"authInfo",void 0);class Pn{constructor(e={}){this.otherCertFormat="",this.otherCert=new ArrayBuffer(0),Object.assign(this,e)}}ie([Q({type:p.ObjectIdentifier})],Pn.prototype,"otherCertFormat",void 0),ie([Q({type:p.Any})],Pn.prototype,"otherCert",void 0);let jn=class{constructor(e={}){Object.assign(this,e)}};ie([Q({type:Et})],jn.prototype,"certificate",void 0),ie([Q({type:mn,context:2,implicit:!0})],jn.prototype,"v2AttrCert",void 0),ie([Q({type:Pn,context:3,implicit:!0})],jn.prototype,"other",void 0),jn=ie([Y({type:h.Choice})],jn);let Hn=Tn=class extends re{constructor(e){super(e),Object.setPrototypeOf(this,Tn.prototype)}};Hn=Tn=ie([Y({type:h.Set,itemType:jn})],Hn);class Un{constructor(e={}){this.contentType="",this.content=new ArrayBuffer(0),Object.assign(this,e)}}ie([Q({type:p.ObjectIdentifier})],Un.prototype,"contentType",void 0),ie([Q({type:p.Any,context:0})],Un.prototype,"content",void 0);let Rn=class{constructor(e={}){Object.assign(this,e)}};ie([Q({type:J})],Rn.prototype,"single",void 0),ie([Q({type:p.Any})],Rn.prototype,"any",void 0),Rn=ie([Y({type:h.Choice})],Rn);class Ln{constructor(e={}){this.eContentType="",Object.assign(this,e)}}ie([Q({type:p.ObjectIdentifier})],Ln.prototype,"eContentType",void 0),ie([Q({type:Rn,context:0,optional:!0})],Ln.prototype,"eContent",void 0);class Dn{constructor(e={}){this.issuer=new de,this.serialNumber=new ArrayBuffer(0),Object.assign(this,e)}}ie([Q({type:de})],Dn.prototype,"issuer",void 0),ie([Q({type:p.Integer,converter:w})],Dn.prototype,"serialNumber",void 0);const _n="1.2.840.113549.1.7.2";var Vn;class Fn{constructor(e={}){this.otherRevInfoFormat="",this.otherRevInfo=new ArrayBuffer(0),Object.assign(this,e)}}ie([Q({type:p.ObjectIdentifier})],Fn.prototype,"otherRevInfoFormat",void 0),ie([Q({type:p.Any})],Fn.prototype,"otherRevInfo",void 0);let $n=class{constructor(e={}){this.other=new Fn,Object.assign(this,e)}};ie([Q({type:Fn,context:1,implicit:!0})],$n.prototype,"other",void 0),$n=ie([Y({type:h.Choice})],$n);let zn=Vn=class extends re{constructor(e){super(e),Object.setPrototypeOf(this,Vn.prototype)}};var Mn;zn=Vn=ie([Y({type:h.Set,itemType:$n})],zn),function(e){e[e.v0=0]="v0",e[e.v1=1]="v1",e[e.v2=2]="v2",e[e.v3=3]="v3",e[e.v4=4]="v4",e[e.v5=5]="v5"}(Mn||(Mn={}));let qn=class extends Bt{};qn=ie([Y({type:h.Sequence})],qn);let Kn=class extends Bt{};Kn=ie([Y({type:h.Sequence})],Kn);let Jn=class{constructor(e={}){this.issuerAndSerialNumber=new Dn,this.subjectKeyIdentifier=new gt,Object.assign(this,e)}};var Wn;ie([Q({type:Dn})],Jn.prototype,"issuerAndSerialNumber",void 0),ie([Q({type:gt,context:0,implicit:!0})],Jn.prototype,"subjectKeyIdentifier",void 0),Jn=ie([Y({type:h.Choice})],Jn);class Gn{constructor(e={}){this.version=Mn.v0,this.sid=new Jn,this.digestAlgorithm=new qn,this.signatureAlgorithm=new Kn,this.signature=new J,Object.assign(this,e)}}ie([Q({type:p.Integer})],Gn.prototype,"version",void 0),ie([Q({type:Jn})],Gn.prototype,"sid",void 0),ie([Q({type:qn})],Gn.prototype,"digestAlgorithm",void 0),ie([Q({type:tn,repeated:"set",context:0,implicit:!0,optional:!0})],Gn.prototype,"signedAttrs",void 0),ie([Q({type:Kn})],Gn.prototype,"signatureAlgorithm",void 0),ie([Q({type:J})],Gn.prototype,"signature",void 0),ie([Q({type:tn,repeated:"set",context:1,implicit:!0,optional:!0})],Gn.prototype,"unsignedAttrs",void 0);let Zn=Wn=class extends re{constructor(e){super(e),Object.setPrototypeOf(this,Wn.prototype)}};var Xn;Zn=Wn=ie([Y({type:h.Set,itemType:Gn})],Zn);let Yn=Xn=class extends re{constructor(e){super(e),Object.setPrototypeOf(this,Xn.prototype)}};Yn=Xn=ie([Y({type:h.Set,itemType:qn})],Yn);class Qn{constructor(e={}){this.version=Mn.v0,this.digestAlgorithms=new Yn,this.encapContentInfo=new Ln,this.signerInfos=new Zn,Object.assign(this,e)}}var ei;ie([Q({type:p.Integer})],Qn.prototype,"version",void 0),ie([Q({type:Yn})],Qn.prototype,"digestAlgorithms",void 0),ie([Q({type:Ln})],Qn.prototype,"encapContentInfo",void 0),ie([Q({type:Hn,context:0,implicit:!0,optional:!0})],Qn.prototype,"certificates",void 0),ie([Q({type:$n,context:1,implicit:!0,optional:!0})],Qn.prototype,"crls",void 0),ie([Q({type:Zn})],Qn.prototype,"signerInfos",void 0);class ti{constructor(e={}){this.attrId="",this.attrValues=[],Object.assign(e)}}ie([Q({type:p.ObjectIdentifier})],ti.prototype,"attrId",void 0),ie([Q({type:p.Any,repeated:"set"})],ti.prototype,"attrValues",void 0);let ri=ei=class extends re{constructor(e){super(e),Object.setPrototypeOf(this,ei.prototype)}};var ni;ri=ei=ie([Y({type:h.Sequence,itemType:ti})],ri);let ii=ni=class extends re{constructor(e){super(e),Object.setPrototypeOf(this,ni.prototype)}};ii=ni=ie([Y({type:h.Sequence,itemType:Un})],ii);class oi{constructor(e={}){this.certId="",this.certValue=new ArrayBuffer(0),Object.assign(this,e)}}ie([Q({type:p.ObjectIdentifier})],oi.prototype,"certId",void 0),ie([Q({type:p.Any,context:0})],oi.prototype,"certValue",void 0);class si{constructor(e={}){this.crlId="",this.crltValue=new ArrayBuffer(0),Object.assign(this,e)}}ie([Q({type:p.ObjectIdentifier})],si.prototype,"crlId",void 0),ie([Q({type:p.Any,context:0})],si.prototype,"crltValue",void 0);class ai extends J{}class ci{constructor(e={}){this.encryptionAlgorithm=new Bt,this.encryptedData=new ai,Object.assign(this,e)}}var li,ui;ie([Q({type:Bt})],ci.prototype,"encryptionAlgorithm",void 0),ie([Q({type:ai})],ci.prototype,"encryptedData",void 0),function(e){e[e.v1=0]="v1"}(ui||(ui={}));class hi extends J{}let pi=li=class extends re{constructor(e){super(e),Object.setPrototypeOf(this,li.prototype)}};pi=li=ie([Y({type:h.Sequence,itemType:pt})],pi);class fi{constructor(e={}){this.version=ui.v1,this.privateKeyAlgorithm=new Bt,this.privateKey=new hi,Object.assign(this,e)}}ie([Q({type:p.Integer})],fi.prototype,"version",void 0),ie([Q({type:Bt})],fi.prototype,"privateKeyAlgorithm",void 0),ie([Q({type:hi})],fi.prototype,"privateKey",void 0),ie([Q({type:pi,implicit:!0,context:0,optional:!0})],fi.prototype,"attributes",void 0);let yi=class extends fi{};yi=ie([Y({type:h.Sequence})],yi);let di=class extends ci{};di=ie([Y({type:h.Sequence})],di);class gi{constructor(e={}){this.secretTypeId="",this.secretValue=new ArrayBuffer(0),Object.assign(this,e)}}ie([Q({type:p.ObjectIdentifier})],gi.prototype,"secretTypeId",void 0),ie([Q({type:p.Any,context:0})],gi.prototype,"secretValue",void 0);class vi{constructor(e={}){this.mac=new jr,this.macSalt=new J,this.iterations=1,Object.assign(this,e)}}ie([Q({type:jr})],vi.prototype,"mac",void 0),ie([Q({type:J})],vi.prototype,"macSalt",void 0),ie([Q({type:p.Integer,defaultValue:1})],vi.prototype,"iterations",void 0);class mi{constructor(e={}){this.version=3,this.authSafe=new Un,this.macData=new vi,Object.assign(this,e)}}var bi;ie([Q({type:p.Integer})],mi.prototype,"version",void 0),ie([Q({type:Un})],mi.prototype,"authSafe",void 0),ie([Q({type:vi,optional:!0})],mi.prototype,"macData",void 0);class wi{constructor(e={}){this.bagId="",this.bagValue=new ArrayBuffer(0),Object.assign(this,e)}}ie([Q({type:p.ObjectIdentifier})],wi.prototype,"bagId",void 0),ie([Q({type:p.Any,context:0})],wi.prototype,"bagValue",void 0),ie([Q({type:ti,repeated:"set",optional:!0})],wi.prototype,"bagAttributes",void 0);let Bi=bi=class extends re{constructor(e){super(e),Object.setPrototypeOf(this,bi.prototype)}};var ki,Ai,Si;Bi=bi=ie([Y({type:h.Sequence,itemType:wi})],Bi);const xi="1.2.840.113549.1.9",Ci=`${xi}.7`,Ii=`${xi}.14`;let Oi=class extends ue{constructor(e={}){super(e)}toString(){return{}.toString(),this.ia5String||super.toString()}};ie([Q({type:p.IA5String})],Oi.prototype,"ia5String",void 0),Oi=ie([Y({type:h.Choice})],Oi);let Ni=class extends Un{};Ni=ie([Y({type:h.Sequence})],Ni);let Ei=class extends mi{};Ei=ie([Y({type:h.Sequence})],Ei);let Ti=class extends ci{};Ti=ie([Y({type:h.Sequence})],Ti);let Pi=class{constructor(e=""){this.value=e}toString(){return this.value}};ie([Q({type:p.IA5String})],Pi.prototype,"value",void 0),Pi=ie([Y({type:h.Choice})],Pi);let ji=class extends Oi{};ji=ie([Y({type:h.Choice})],ji);let Hi=class extends ue{};Hi=ie([Y({type:h.Choice})],Hi);let Ui=class{constructor(e=new Date){this.value=e}};ie([Q({type:p.GeneralizedTime})],Ui.prototype,"value",void 0),Ui=ie([Y({type:h.Choice})],Ui);let Ri=class extends ue{};Ri=ie([Y({type:h.Choice})],Ri);let Li=class{constructor(e="M"){this.value=e}toString(){return this.value}};ie([Q({type:p.PrintableString})],Li.prototype,"value",void 0),Li=ie([Y({type:h.Choice})],Li);let Di=class{constructor(e=""){this.value=e}toString(){return this.value}};ie([Q({type:p.PrintableString})],Di.prototype,"value",void 0),Di=ie([Y({type:h.Choice})],Di);let _i=class extends Di{};_i=ie([Y({type:h.Choice})],_i);let Vi=class extends ue{};Vi=ie([Y({type:h.Choice})],Vi);let Fi=class{constructor(e=""){this.value=e}toString(){return this.value}};ie([Q({type:p.ObjectIdentifier})],Fi.prototype,"value",void 0),Fi=ie([Y({type:h.Choice})],Fi);let $i=class extends At{};$i=ie([Y({type:h.Choice})],$i);let zi=class{constructor(e=0){this.value=e}toString(){return this.value.toString()}};ie([Q({type:p.Integer})],zi.prototype,"value",void 0),zi=ie([Y({type:h.Choice})],zi);let Mi=class extends Gn{};Mi=ie([Y({type:h.Sequence})],Mi);let qi=class extends ue{};qi=ie([Y({type:h.Choice})],qi);let Ki=ki=class extends It{constructor(e){super(e),Object.setPrototypeOf(this,ki.prototype)}};Ki=ki=ie([Y({type:h.Sequence})],Ki);let Ji=Ai=class extends re{constructor(e){super(e),Object.setPrototypeOf(this,Ai.prototype)}};Ji=Ai=ie([Y({type:h.Set,itemType:tn})],Ji);let Wi=class{constructor(e=""){this.value=e}toString(){return this.value}};ie([Q({type:p.BmpString})],Wi.prototype,"value",void 0),Wi=ie([Y({type:h.Choice})],Wi);let Gi=class extends Bt{};Gi=ie([Y({type:h.Sequence})],Gi);let Zi=Si=class extends re{constructor(e){super(e),Object.setPrototypeOf(this,Si.prototype)}};Zi=Si=ie([Y({type:h.Sequence,itemType:Gi})],Zi);class Xi extends Ht{constructor(...e){let t;if($.isBufferSource(e[0]))t=$.toArrayBuffer(e[0]);else{const r=e[0],n=Array.isArray(e[1])?e[1].map((e=>$.toArrayBuffer(e))):[];t=ne.serialize(new pt({type:r,values:n}))}super(t,pt)}onInit(e){this.type=e.type,this.values=e.values}}class Yi extends Xi{constructor(...e){var t;if($.isBufferSource(e[0]))super(e[0]);else{const t=new qi({printableString:e[0]});super(Ci,[ne.serialize(t)])}null!==(t=this.password)&&void 0!==t||(this.password="")}onInit(e){if(super.onInit(e),this.values[0]){const e=ne.parse(this.values[0],qi);this.password=e.toString()}}}class Qi extends Xi{constructor(...e){var t;if($.isBufferSource(e[0]))super(e[0]);else{const t=new It(e[0]);super(Ii,[ne.serialize(t)])}null!==(t=this.items)&&void 0!==t||(this.items=[])}onInit(e){if(super.onInit(e),this.values[0]){const e=ne.parse(this.values[0],It);this.items=e.map((e=>pr.create(ne.serialize(e))))}}}class eo{static register(e,t){this.items.set(e,t)}static create(e){const t=new Xi(e),r=this.items.get(t.type);return r?new r(e):t}}eo.items=new Map,e.RsaAlgorithm=class{toAsnAlgorithm(e){switch(e.name.toLowerCase()){case"rsassa-pkcs1-v1_5":if(!e.hash)return new Bt({algorithm:yr,parameters:null});switch(e.hash.name.toLowerCase()){case"sha-1":return new Bt({algorithm:wr,parameters:null});case"sha-256":return new Bt({algorithm:Br,parameters:null});case"sha-384":return new Bt({algorithm:kr,parameters:null});case"sha-512":return new Bt({algorithm:Ar,parameters:null})}}return null}toWebAlgorithm(e){switch(e.algorithm){case yr:return{name:"RSASSA-PKCS1-v1_5"};case wr:return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-1"}};case Br:return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case kr:return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-384"}};case Ar:return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-512"}}}return null}},e.RsaAlgorithm=ie([ar()],e.RsaAlgorithm),sr.registerSingleton(_r,e.RsaAlgorithm);let to=class{constructor(e={}){Object.assign(this,e)}};ie([Q({type:p.ObjectIdentifier})],to.prototype,"namedCurve",void 0),to=ie([Y({type:h.Choice})],to);class ro{constructor(e={}){this.version=1,this.privateKey=new J,Object.assign(this,e)}}ie([Q({type:p.Integer})],ro.prototype,"version",void 0),ie([Q({type:J})],ro.prototype,"privateKey",void 0),ie([Q({type:to,context:0,optional:!0})],ro.prototype,"parameters",void 0),ie([Q({type:p.BitString,context:1,optional:!0})],ro.prototype,"publicKey",void 0);class no{constructor(e={}){this.r=new ArrayBuffer(0),this.s=new ArrayBuffer(0),Object.assign(this,e)}}ie([Q({type:p.Integer,converter:w})],no.prototype,"r",void 0),ie([Q({type:p.Integer,converter:w})],no.prototype,"s",void 0);const io="1.2.840.10045.2.1",oo="1.2.840.10045.4.1",so="1.2.840.10045.4.3.2",ao="1.2.840.10045.4.3.3",co="1.2.840.10045.4.3.4",lo="1.2.840.10045.3.1.7",uo="1.3.132.0.34",ho="1.3.132.0.35";var po;e.EcAlgorithm=po=class{toAsnAlgorithm(e){switch(e.name.toLowerCase()){case"ecdsa":if("hash"in e){switch(("string"==typeof e.hash?e.hash:e.hash.name).toLowerCase()){case"sha-1":return new Bt({algorithm:oo,parameters:null});case"sha-256":return new Bt({algorithm:so,parameters:null});case"sha-384":return new Bt({algorithm:ao,parameters:null});case"sha-512":return new Bt({algorithm:co,parameters:null})}}else if("namedCurve"in e){let t="";switch(e.namedCurve){case"P-256":t=lo;break;case"K-256":t=po.SECP256K1;break;case"P-384":t=uo;break;case"P-521":t=ho}if(t)return new Bt({algorithm:io,parameters:ne.serialize(new to({namedCurve:t}))})}}return null}toWebAlgorithm(e){switch(e.algorithm){case oo:return{name:"ECDSA",hash:{name:"SHA-1"}};case so:return{name:"ECDSA",hash:{name:"SHA-256"}};case ao:return{name:"ECDSA",hash:{name:"SHA-384"}};case co:return{name:"ECDSA",hash:{name:"SHA-512"}};case io:if(!e.parameters)throw new TypeError("Cannot get required parameters from EC algorithm");switch(ne.parse(e.parameters,to).namedCurve){case lo:return{name:"ECDSA",namedCurve:"P-256"};case po.SECP256K1:return{name:"ECDSA",namedCurve:"K-256"};case uo:return{name:"ECDSA",namedCurve:"P-384"};case ho:return{name:"ECDSA",namedCurve:"P-521"}}}return null}},e.EcAlgorithm.SECP256K1="1.3.132.0.10",e.EcAlgorithm=po=ie([ar()],e.EcAlgorithm),sr.registerSingleton(_r,e.EcAlgorithm);class fo{addPadding(e,t){const r=$.toUint8Array(t),n=new Uint8Array(e);return n.set(r,e-r.length),n}removePadding(e){const t=$.toUint8Array(e);for(let e=0;e<t.length;e++)if(t[e])return t.slice(e).buffer;return new ArrayBuffer(0)}toAsnSignature(e,t){if("ECDSA"===e.name){const r=e.namedCurve,n=fo.namedCurveSize.get(r)||fo.defaultNamedCurveSize,i=new no,o=$.toUint8Array(t);return i.r=this.removePadding(o.slice(0,n)),i.s=this.removePadding(o.slice(n,n+n)),ne.serialize(i)}return null}toWebSignature(e,t){if("ECDSA"===e.name){const r=ne.parse(t,no),n=e.namedCurve,i=fo.namedCurveSize.get(n)||fo.defaultNamedCurveSize;return function(...e){const t=e.map((e=>e.byteLength)).reduce(((e,t)=>e+t)),r=new Uint8Array(t);let n=0;return e.map((e=>new Uint8Array(e))).forEach((e=>{for(const t of e)r[n++]=t})),r.buffer}(this.addPadding(i,this.removePadding(r.r)),this.addPadding(i,this.removePadding(r.s)))}return null}}fo.namedCurveSize=new Map,fo.defaultNamedCurveSize=32;const yo="1.3.101.110",go="1.3.101.111",vo="1.3.101.112",mo="1.3.101.113";var bo;e.EdAlgorithm=class{toAsnAlgorithm(e){let t=null;switch(e.name.toLowerCase()){case"eddsa":switch(e.namedCurve.toLowerCase()){case"ed25519":t=vo;break;case"ed448":t=mo}break;case"ecdh-es":switch(e.namedCurve.toLowerCase()){case"x25519":t=yo;break;case"x448":t=go}}return t?new Bt({algorithm:t}):null}toWebAlgorithm(e){switch(e.algorithm){case vo:return{name:"EdDSA",namedCurve:"Ed25519"};case mo:return{name:"EdDSA",namedCurve:"Ed448"};case yo:return{name:"ECDH-ES",namedCurve:"X25519"};case go:return{name:"ECDH-ES",namedCurve:"X448"}}return null}},e.EdAlgorithm=ie([ar()],e.EdAlgorithm),sr.registerSingleton(_r,e.EdAlgorithm);let wo=bo=class extends re{constructor(e){super(e),Object.setPrototypeOf(this,bo.prototype)}};wo=bo=ie([Y({type:h.Sequence,itemType:pt})],wo);class Bo{constructor(e={}){this.version=0,this.subject=new de,this.subjectPKInfo=new kt,this.attributes=new wo,Object.assign(this,e)}}ie([Q({type:p.Integer})],Bo.prototype,"version",void 0),ie([Q({type:de})],Bo.prototype,"subject",void 0),ie([Q({type:kt})],Bo.prototype,"subjectPKInfo",void 0),ie([Q({type:wo,implicit:!0,context:0})],Bo.prototype,"attributes",void 0);class ko{constructor(e={}){this.certificationRequestInfo=new Bo,this.signatureAlgorithm=new Bt,this.signature=new ArrayBuffer(0),Object.assign(this,e)}}ie([Q({type:Bo})],ko.prototype,"certificationRequestInfo",void 0),ie([Q({type:Bt})],ko.prototype,"signatureAlgorithm",void 0),ie([Q({type:p.BitString})],ko.prototype,"signature",void 0);class Ao extends zr{constructor(e){zr.isAsnEncoded(e)?super(e,ko):super(e),this.tag="CERTIFICATE REQUEST"}onInit(e){this.tbs=ne.serialize(e.certificationRequestInfo),this.publicKey=new Mr(e.certificationRequestInfo.subjectPKInfo);const t=sr.resolve(Fr);this.signatureAlgorithm=t.toWebAlgorithm(e.signatureAlgorithm),this.signature=e.signature,this.attributes=e.certificationRequestInfo.attributes.map((e=>eo.create(ne.serialize(e))));const r=this.getAttribute(Ii);this.extensions=[],r instanceof Qi&&(this.extensions=r.items),this.subject=new hr(e.certificationRequestInfo.subject).toString()}getAttribute(e){for(const t of this.attributes)if(t.type===e)return t;return null}getAttributes(e){return this.attributes.filter((t=>t.type===e))}getExtension(e){for(const t of this.extensions)if(t.type===e)return t;return null}getExtensions(e){return this.extensions.filter((t=>t.type===e))}async verify(e=Lt.get()){const t={...this.publicKey.algorithm,...this.signatureAlgorithm},r=await this.publicKey.export(t,["verify"],e),n=sr.resolveAll(qr).reverse();let i=null;for(const e of n)if(i=e.toWebSignature(t,this.signature),i)break;if(!i)throw Error("Cannot convert WebCrypto signature value to ASN.1 format");return await e.subtle.verify(this.signatureAlgorithm,r,i,this.tbs)}}class So extends Array{constructor(e){if(super(),zr.isAsnEncoded(e))this.import(e);else if(e instanceof Jr)this.push(e);else if(Array.isArray(e))for(const t of e)this.push(t)}export(e){const t=new Qn;t.certificates=new Hn(this.map((e=>new jn({certificate:ne.parse(e.rawData,Et)}))));const r=new Un({contentType:_n,content:ne.serialize(t)}),n=ne.serialize(r);return"raw"===e?n:this.toString(e)}import(e){const t=zr.toArrayBuffer(e),r=ne.parse(t,Un);if(r.contentType!==_n)throw new TypeError("Cannot parse CMS package. Incoming data is not a SignedData object.");const n=ne.parse(r.content,Qn);this.clear();for(const e of n.certificates||[])e.certificate&&this.push(new Jr(e.certificate))}clear(){for(;this.pop(););}toString(e="pem"){const t=this.export("raw");switch(e){case"pem":return $r.encode(t,"CMS");case"hex":return M.ToHex(t);case"base64":return M.ToBase64(t);case"base64url":return M.ToBase64Url(t);default:throw TypeError("Argument 'format' is unsupported value")}}}return pr.register(Ce,Gr),pr.register(We,Zr),pr.register(et,Xr),pr.register(dt,Yr),pr.register(Ae,Wr),pr.register(ut,en),eo.register(Ci,Yi),eo.register(Ii,Qi),sr.registerSingleton(qr,Kr),sr.registerSingleton(qr,fo),fo.namedCurveSize.set("P-256",32),fo.namedCurveSize.set("K-256",32),fo.namedCurveSize.set("P-384",48),fo.namedCurveSize.set("P-521",66),e.AlgorithmProvider=Vr,e.AsnData=Ht,e.AsnDefaultSignatureFormatter=Kr,e.AsnEcSignatureFormatter=fo,e.Attribute=Xi,e.AttributeFactory=eo,e.AuthorityKeyIdentifierExtension=Wr,e.BasicConstraintsExtension=Gr,e.ChallengePasswordAttribute=Yi,e.CryptoProvider=Rt,e.ExtendedKeyUsageExtension=Zr,e.Extension=Ut,e.ExtensionFactory=pr,e.ExtensionsAttribute=Qi,e.KeyUsagesExtension=Xr,e.Name=hr,e.NameIdentifier=cr,e.OtherName=Qr,e.PemConverter=$r,e.Pkcs10CertificateRequest=Ao,e.Pkcs10CertificateRequestGenerator=class{static async create(e,t=Lt.get()){const r=await t.subtle.exportKey("spki",e.keys.publicKey),n=new ko({certificationRequestInfo:new Bo({subjectPKInfo:ne.parse(r,kt)})});if(e.name&&(n.certificationRequestInfo.subject=ne.parse(new hr(e.name).toArrayBuffer(),de)),e.attributes)for(const t of e.attributes)n.certificationRequestInfo.attributes.push(ne.parse(t.rawData,pt));if(e.extensions&&e.extensions.length){const t=new pt({type:Ii}),r=new It;for(const t of e.extensions)r.push(ne.parse(t.rawData,Ct));t.values.push(ne.serialize(r)),n.certificationRequestInfo.attributes.push(t)}const i={...e.signingAlgorithm,...e.keys.privateKey.algorithm},o=sr.resolve(Fr);n.signatureAlgorithm=o.toAsnAlgorithm(i);const s=ne.serialize(n.certificationRequestInfo),a=await t.subtle.sign(i,e.keys.privateKey,s),c=sr.resolveAll(qr).reverse();let l=null;for(const e of c)if(l=e.toAsnSignature(i,a),l)break;if(!l)throw Error("Cannot convert WebCrypto signature value to ASN.1 format");return n.signature=l,new Ao(ne.serialize(n))}},e.PublicKey=Mr,e.SubjectAlternativeNameExtension=en,e.SubjectKeyIdentifierExtension=Yr,e.X509Certificate=Jr,e.X509CertificateGenerator=class{static async createSelfSigned(e,t=Lt.get()){return this.create({serialNumber:e.serialNumber,subject:e.name,issuer:e.name,notBefore:e.notBefore,notAfter:e.notAfter,publicKey:e.keys.publicKey,signingKey:e.keys.privateKey,signingAlgorithm:e.signingAlgorithm,extensions:e.extensions},t)}static async create(e,t=Lt.get()){var r;const n=await t.subtle.exportKey("spki",e.publicKey),i=new Et({tbsCertificate:new Nt({version:Ot.v3,serialNumber:M.FromHex(e.serialNumber),validity:new St({notBefore:e.notBefore,notAfter:e.notAfter}),extensions:new It((null===(r=e.extensions)||void 0===r?void 0:r.map((e=>ne.parse(e.rawData,Ct))))||[]),subjectPublicKeyInfo:ne.parse(n,kt)})});e.subject&&(i.tbsCertificate.subject=ne.parse(new hr(e.subject).toArrayBuffer(),de)),e.issuer&&(i.tbsCertificate.issuer=ne.parse(new hr(e.issuer).toArrayBuffer(),de));const o={...e.signingAlgorithm,...e.signingKey.algorithm},s=sr.resolve(Fr);i.tbsCertificate.signature=i.signatureAlgorithm=s.toAsnAlgorithm(o);const a=ne.serialize(i.tbsCertificate),c=await t.subtle.sign(o,e.signingKey,a),l=sr.resolveAll(qr).reverse();let u=null;for(const e of l)if(u=e.toAsnSignature(o,c),u)break;if(!u)throw Error("Cannot convert ASN.1 signature value to WebCrypto format");return i.signatureValue=u,new Jr(ne.serialize(i))}},e.X509Certificates=So,e.X509ChainBuilder=class{constructor(e={}){this.certificates=[],e.certificates&&(this.certificates=e.certificates)}async build(e){const t=new So(e);let r=e;for(;r=await this.findIssuer(r);){const e=await r.getThumbprint();for(const r of t){if(q(e,await r.getThumbprint()))throw new Error("Cannot build a certificate chain. Circular dependency.")}t.push(r)}return t}async findIssuer(e){if(!await e.isSelfSigned()){const t=e.getExtension(Ae);for(const r of this.certificates)if(r.subject===e.issuer){if(t)if(t.keyId){const e=r.getExtension(dt);if(e&&e.keyId!==t.keyId)continue}else if(t.certId){const e=r.getExtension(ut);if(e&&(t.certId.serialNumber!==r.serialNumber||!q(ne.serialize(t.certId.name),ne.serialize(e))))continue}if(await e.verify({publicKey:await r.publicKey.export(),signatureOnly:!0}))return r}}return null}},e.cryptoProvider=Lt,e.diAlgorithm=_r,e.diAlgorithmProvider=Fr,e.diAsnSignatureFormatter=qr,e.idEd25519=vo,e.idEd448=mo,e.idX25519=yo,e.idX448=go,Object.defineProperty(e,"__esModule",{value:!0}),e}({});
